//$('#paymentPluginsStudentFeeDueHostel').bcpymt({sPC:'HOSTF',bWFH:false,iFBIDs:bankId});
var instituteId=0;
function configureStudentRegister(divId)
{
	var studentId = $('#studentId').val();
	getStudentRegister(studentId,function(replay){
		var instituteName = $('#instituteName').val();
		$('#div-Process').removeClass("preview-loading");
		var heads = '';

		var count = 0;
		for(var i=0;i<replay.accountDetail.length;i++)
		{
			if(replay.accountDetail[i].isBank==false && replay.accountDetail[i].isCash==false)
			{
				count ++;
				heads += '<th width="4%">'+replay.accountDetail[i].name+'</th>';
			}
		}
		var count1 = count+4;
		var boiler = 

			'<div id="divPrint" class="">'+
			'<div class="divBackgroundAndBorder"  style="width:100%"><div style="width:100%;font-family: COURIER;">'+
			'<div style="width:20%;display:inline-block;text-align:center;vertical-align:middle;">'+
			'<img height="46px" src="getInstituteLogo.json">'+
			'</div>'+
			'<div style="width:60%;display:inline-block;text-align:center;vertical-align:middle;font-size: 13px;">'+
			'<b>'+instituteName+'</b>'+
			'</div>'+

			'<div style="width:20%;display:inline-block;text-align:center;vertical-align:middle;">'+
			'<img height="46px" src="getInstituteLogo.json">'+
			'</div>'+
			'</div><hr>'+


			'<table class="table table-bordered tablePrint" cellspacing="0" cellpadding="0">'+
			'<tr><th colspan="4"><h4  align="left"><b><i class="icon icon-hand-right"></i>&nbsp;&nbsp;STUDENT DETAILS</b></h4></th></tr>'+
			'<tr>'+
			'<th style="font-weight: bold;text-align:left;">Name</th>'+//style="width:10%;
			'<td style="font-weight: bold;text-align:left;">'+replay.name+'</td>'+// style="width:30%;
			'<th style="font-weight: bold;text-align:left;">Programme</th>'+// style="width:10%;
			'<td style="font-weight: bold;text-align:left;">'+replay.dept+'</td>'+
			'</tr>'+
			'<tr>'+
			'<th style="font-weight: bold;text-align:left;">Email</th>'+
			'<td style="font-weight: bold;text-align:left;">'+replay.email+'</td>'+
			'<th  style="font-weight: bold;text-align:left;">Division</th>'+
			'<td style="font-weight: bold;text-align:left;">'+replay.div+'</td>'+
			'</tr>'+
			'<tr>'+
			'<th style="font-weight: bold;text-align:left;">Contact</th>'+
			'<td style="font-weight: bold;text-align:left;">'+replay.contact+'</td>'+
			'<th style="font-weight: bold;text-align:left;">Academic year</th>'+
			'<td style="font-weight: bold;text-align:left;">'+replay.academicYear+'</td>'+
			'</tr>'+
			/*	'<tr>'+
						'<th style="width:10%;font-weight: bold;text-align:left;">Name</th>'+
						'<td style="width:30%;font-weight: bold;text-align:left;">'+replay.name+'</td>'+
						'<th style="width:10%;font-weight: bold;text-align:left;">Programme</th>'+
						'<td style="width:50%;font-weight: bold;text-align:left;">'+replay.dept+'</td>'+
					'</tr>'+
					'<tr>'+
						'<th style="font-weight: bold;text-align:left;">Email</th>'+
						'<td style="font-weight: bold;text-align:left;">'+replay.email+'</td>'+
						'<th style="font-weight: bold;text-align:left;">Division</th>'+
						'<td style="font-weight: bold;text-align:left;">'+replay.div+'</td>'+
					'</tr>'+
					'<tr>'+
						'<th style="font-weight: bold;text-align:left;">Contact</th>'+
						'<td style="font-weight: bold;text-align:left;">'+replay.contact+'</td>'+
						'<th style="font-weight: bold;text-align:left;">Academic year</th>'+
						'<td style="font-weight: bold;text-align:left;">'+replay.academicYear+'</td>'+
					'</tr>'+*/
			'</table><br>'+
			'<div style="width:100%;overflow:auto"><table class="table table-bordered std-Register tablePrint" id="tbl-Student-Register" cellspacing="0" cellpadding="0">'+
			'<thead>'+
			'<tr><td colspan="'+eval(count+7)+'"><h4><b><i class="icon icon-hand-right"></i>&nbsp;&nbsp;TRANSACTION DETAILS</b></h4></td></tr>'+
			'<tr>'+
			'<th  width="3%">Receipt no</th>'+
			'<th  width="4%">Date</th>'+
			'<th  width="3%">Time</th>'+
			'<th  width="9%">Created by</th>'+
			'<th  width="4%">Cash</th>'+
			'<th  width="5%">Cheque/DD</th>'+
			'<th  width="5%">Total<br>Amount</th>'+
			heads+
			'</tr>'+
			'</thead>'+
			'<tbody id="'+divId+'_tbodyStdRegister">'+
			'</tbody>'+
			'</table></div><br></div>'+
			'</div><br>'+
			'<div style="text-align:center">'+
			'<a href="javascript:void(0);" id="export-Excel-Register" onclick="exportStudentTransactionDetailstoExcel(\''+studentId+'\')" class="btn btn-mini"><i class="icon-print"></i>&nbsp;Excel</a>'+//tableToExcel(\'tbl-Student-Register\',\'test\')
			'</div>';
		$('#'+divId).html(boiler);

		for(var i=0;i<replay.receiptsDetail.length;i++)
		{
			var receipt = replay.receiptsDetail[i].receipt;
			var tot = 0;

			boiler ='<tr>'+
			'<td style="font-weight: bold;">'+replay.receiptsDetail[i].receiptNo+'</td>'+
			'<td style="font-weight: bold;">'+replay.receiptsDetail[i].receiptDate+'</td>'+
			'<td style="font-weight: bold;">'+replay.receiptsDetail[i].receiptTime+'</td>'+
			'<td class="tdName" style="font-weight: bold;">'+replay.receiptsDetail[i].createdBy+'</td>'+
			'<td style="text-align:right;font-weight: bold;" id="headCash-'+receipt+'">0</td>'+
			'<td style="text-align:right;font-weight: bold;" id="headBank-'+receipt+'">0</td>'+
			'<td style="text-align:right;font-weight: bold;" id="headTot-'+receipt+'">0</td>'+
			'</tr>';

			$('#'+divId+'_tbodyStdRegister').append(boiler);

			for(var j=0;j<replay.accountDetail.length;j++)
			{

				var value = replay.receiptsDetail[i].detail['accountDetail-'+receipt+'-'+replay.accountDetail[j].account];

				if(value==undefined)
					value = 0;

				if(replay.accountDetail[j].isBank==true)
				{
					$('#headBank-'+receipt).html(formatAmount(value));
					tot += eval(value);

				}
				else if(replay.accountDetail[j].isCash==true)
				{
					$('#headCash-'+receipt).html(formatAmount(value));
					tot += eval(value);
				}
				else
				{
					//alert("In else");
					boiler = '<td style="text-align:right;font-weight: bold;" class="size1">'+formatAmount(value)+'</td>';
					$('#'+divId+'_tbodyStdRegister tr:last').append(boiler);
				}
			}
			$('#headTot-'+receipt).html(formatAmount(tot));

		}


		paintWidth(count);
		var boiler = $('#divPrint').html();
		$('#print-Std-Register').click(function(){

			//$('#tbl-Student-Register').dataTable().fnDestroy();
			///paintWidth(count);
			printDetail(boiler);
			//$('#tbl-Student-Register').dataTable().fnDraw();
			// paintWidth(count);


		});

		/*$('#tbl-Student-Register').dataTable( {
			"sDom": "<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span6'i><'span6'p>>",
		    "sPaginationType": "bootstrap",
		    "oLanguage": {
				"sLengthMenu": "_MENU_ records per page"
			},

			"aLengthMenu": [
			                [5,10,20,50,-1],
			                ['5','10','20','50','All']],
			"iDisplayLength" : -1,

		});*/

		paintWidth(count);

	});
}

function getStudentRegister(studentId,callback)
{
	$.ajax({
		url:'StudentRegisterEntryDetailForStudentView.json',
		dataType:'json',
		type:'POST',
		data:{studentId:studentId},
		async:false,
		beforeSend:function() {
			//startCommonAjaxSpinner();
		},
		complete: function() {
			//stopCommonAjaxSpinner();

		},
		success:function(replay){
			callback(replay);
		},
		error:function(){
			jAlert("Something went wrong, Please try after some time");
		}
	});
}

function getStudentPaymentDetailsonlinereceipt(src){
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	var hdAuth = $('#hdAuth').val();
	var url = 'getStudentPaymentDetailsonlinereceipt.json';
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_getStudentPaymentDetailsonlinereceipt.json';
	}
	$.ajax({
		url:url,
		dataType:'json',
		type:'POST',
		async:false,
		beforeSend:function() {
			//startCommonAjaxSpinner();
		},
		complete: function() {
			//stopCommonAjaxSpinner();

		},
		success:function(OnlineTranasationList){
			var boiler1='<div class="label label-info" style="text-align:center">Online Transactions Details</div><br><table class="table table-bordered table-condensed"  style="margin-top:-14px"><th>Transaction Number</th><th>Transaction Category</th><th>Transaction Amount</th><th>Transaction Date</th><th></th>';
			if(OnlineTranasationList.length>0){
				for(var i = 0 ; i < OnlineTranasationList.length ; i++){	
					boiler1+='<tr><td>'+OnlineTranasationList[i].TransactionNumber+'</td>';
					boiler1+='<td>'+OnlineTranasationList[i].TransactionCategory+'</td>';
					boiler1+='<td class="gems_currency">'+OnlineTranasationList[i].TransactionAmount+'</td>';
					boiler1+='<td>'+OnlineTranasationList[i].TransactionDate+'</td><td><input type="button" class="btn btn-mini btn-inverse" value="Print" onclick="printStudentOnlinePayment('+OnlineTranasationList[i].onlinePaymentTransactionId+','+OnlineTranasationList[i].feeItemId+');"></tr>';
				}
			}else{
				boiler1+='<tr><td colspan="4">Data Not Found !!!</td></tr>';
			}
			boiler1+='</table>';
			$('#studentonlinePaymentDetailseceipt').html(boiler1);
		},
		error:function(){
			jAlert("Something went wrong, Please try after some time");
		}
	});
}
function printStudentOnlinePayment(onlinePaymentTransactionId, feeItemId){
	$.ajax({
		url:'printStudentOnlinePaymentReceipt.json',
		dataType:'text',
		type:'POST',
		data:{
			onlinePaymentTransactionId:onlinePaymentTransactionId,
			feeItemId:feeItemId
		},
		async:false,
		beforeSend:function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();

		},
		success:function(replay){
			//$('#commonDialog').modal('show');
			
			$('#commonDialog').modal('show').css({
				width:'750px',
				'margin-left': function () {
					return -($(this).width() / 2);
				}
			});
			
			$('#commonDialogBody').html(replay);
		},
		error:function(){
			jAlert("Something went wrong, Please try after some time");
		}
	});
}


function printDetail(content)
{

	var boilerPrint = 
		'<div style="height:24.6cm;">'+
		content+
		'</div>';

	var myboiler='<html><meta charset="utf-8" /><head>'+
	'<style type="text/css">'+
	'@media print  and (width: 11.69in) and (height: 8.27in) {'+
	'@page {'+
	'     margin: 3cm;'+
	'		size : landscape'+
	'		size:11.69in 8.27in;'+
	'  }'+
	//'table { page : rotated }'+ 
	'body{ background-color:#FFFFFF; background-image:none; color:#000000; }'+
	'.ad{ display:none;}'+
	'.HeaderSection'+
	'{'+
	'display:none;'+
	'}'+
	'.FooterSection'+
	'{'+
	'display:none;'+
	'}'+
	'.leftbar{ display:none;}'+
	'.contentarea{ width:100%;}'+
	'}'+
	'</style>'+
	'<link rel="stylesheet" href="css/print.css" rel="stylesheet" media="print" />'+
	'</head><body>';
	myboiler+=boilerPrint;
	myboiler+='</body></html>';
	var printWin = window.open('','','left=0,top=0,width=1,height=1,toolbar=0,scrollbars=2,status=0');
	printWin.document.write(myboiler);
	printWin.document.close();
	printWin.focus();
	printWin.print();
	printWin.close();
}
function paintWidth(count)
{
	if(count>0)
	{
		var width = 980+(count*150);
		$('#tbl-Student-Register').css('width',width+'px');
	}
	else
		$('#tbl-Student-Register').css('width','980px');

	$('.tdName').css('width','200px');
	$('.size1').css('width','150px');
	$('.size2').css('width','100px');
	$('.size3').css('width','80px');
	$('.size1').css('word-wrap','break-word');
	$('.size2').css('word-wrap','break-word');
	$('.size3').css('word-wrap','break-word');
}

function formatAmount(x){
	var amount = x;
	try
	{
		if(x!=null && x!=undefined && (x+'')!=''){
			x=toFixed(x.toString());
			var afterPoint = '';
			if(x.indexOf('.') > 0)
				afterPoint = x.substring(x.indexOf('.'),x.length);
			x = Math.floor(x);
			x=toFixed(x.toString());
			var lastThree = x.substring(x.length-3);
			var otherNumbers = x.substring(0,x.length-3);
			if(otherNumbers != '')
				lastThree = ',' + lastThree;
			var res = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree + afterPoint;
			return res;
		}else{
			return "-";
		}
	}
	catch (e) {
		alert(e);
		return amount;
	}
}

function toFixed(x) {
	if (Math.abs(x) < 1.0) {
		var e = parseInt(x.toString().split('e-')[1]);
		if (e) {
			x *= Math.pow(10,e-1);
			x = '0.' + (new Array(e)).join('0') + x.toString().substring(2);
		}
	} else {
		var e = parseInt(x.toString().split('+')[1]);
		if (e > 20) {
			e -= 20;
			x /= Math.pow(10,e);
			x += (new Array(e+1)).join('0');
		}
	}
	return x;
}
function printStudentAcademicDetails(){
	var printStudentDetails = $('#divStudentInformation').html();
	var printStudentHostel = $('#divStudentFeeDueInformation').html();
	var temp='<html><meta charset="utf-8" /><head>'+
	'<style type="text/css">'+
	'@media print{'+
	'body{ background-color:#FFFFFF; background-image:none; color:#000000 }'+
	'.ad{ display:none;}'+
	'.HeaderSection'+
	'{'+
	'display:none;'+
	'}'+
	'.FooterSection'+
	'{'+
	'display:none;'+
	'}'+
	'.leftbar{ display:none;}'+
	'.contentarea{ width:100%;}'+
	'}'+
	'</style>'+
	'<link rel="stylesheet" href="css/print.css" rel="stylesheet" media="print" />'+
	'</head><body>';

	temp+= '<div style="height: 60px;" id="instituteHeader" align="center">'+
	'<div class="modal-header" style="height: 40px; background-image: url("img/common/grid-18px-masked.png");" align="center">'+
	'<table class="" style="width: 100%; margin-top: -10px;"><tr><td align="left" style="width: 10%;"><img src="getTrustLogo.json" width="60px;" height="50px;" /></td>'+
	'<td align="center" height="50px;">'+
	'<p style="font:9px/10px Lucida Grande, Lucida Sans, Arial, sans-serif; color: black;"></p>'+ //'+$("#lbltrustName").html()+'
	'<p style="font:13px/16px Lucida Grande, Lucida Sans, Arial, sans-serif; color:black; font-weight: bold;">'+$("#lblinstiName").html()+'</p>'+
	'<p style="font:9px/10px Lucida Grande, Lucida Sans, Arial, sans-serif; color: black;">'+$("#lblinstiAddr").html()+'</p>'+
	'</td>'+
	'<td align="right" style="width: 10%;"><img src="getInstituteLogo.json" width="60px;" height="50px;" /></td></tr>'+
	'</table>'+
	'</div>	'+
	'</div><hr><div align="right" style="font-size:11px">Date : '+$.datepicker.formatDate('dd M,yy',new Date())+'</div>'+
	'<br>';
	temp+=printStudentDetails+'<br>'+printStudentHostel; 

	var printWin = window.open('','','left=0,top=0,width=1,height=1,toolbar=0,scrollbars=2,status=0');
	printWin.document.write(temp);
	printWin.document.close();
	printWin.focus();
	printWin.print();
	printWin.close();
}
function printStudentHostelDetails(){
	var printStudentDetails = $('#divStudentInformationHostel').html();
	var printStudentHostel = $('#divStudentFeeDueInformationHostel').html();
	var temp='<html><meta charset="utf-8" /><head>'+
	'<style type="text/css">'+
	'@media print{'+
	'body{ background-color:#FFFFFF; background-image:none; color:#000000 }'+
	'.ad{ display:none;}'+
	'.HeaderSection'+
	'{'+
	'display:none;'+
	'}'+
	'.FooterSection'+
	'{'+
	'display:none;'+
	'}'+
	'.leftbar{ display:none;}'+
	'.contentarea{ width:100%;}'+
	'}'+
	'</style>'+
	'<link rel="stylesheet" href="css/print.css" rel="stylesheet" media="print" />'+
	'</head><body>';

	temp+= '<div style="height: 60px;" id="instituteHeader" align="center">'+
	'<div class="modal-header" style="height: 40px; background-image: url("img/common/grid-18px-masked.png");" align="center">'+
	'<table class="" style="width: 100%; margin-top: -10px;"><tr><td align="left" style="width: 10%;"><img src="getTrustLogo.json" width="60px;" height="50px;" /></td>'+
	'<td align="center" height="50px;">'+
	'<p style="font:9px/10px Lucida Grande, Lucida Sans, Arial, sans-serif; color: black;"></p>'+ //'+$("#lbltrustName").html()+'
	'<p style="font:13px/16px Lucida Grande, Lucida Sans, Arial, sans-serif; color:black; font-weight: bold;">'+$("#lblinstiName").html()+'</p>'+
	'<p style="font:9px/10px Lucida Grande, Lucida Sans, Arial, sans-serif; color: black;">'+$("#lblinstiAddr").html()+'</p>'+
	'</td>'+
	'<td align="right" style="width: 10%;"><img src="getInstituteLogo.json" width="60px;" height="50px;" /></td></tr>'+
	'</table>'+
	'</div>	'+
	'</div><hr><div align="right" style="font-size:11px">Date : '+$.datepicker.formatDate('dd M,yy',new Date())+'</div>'+
	'<br>';
	temp+=printStudentDetails+'<br>'+printStudentHostel; 

	var printWin = window.open('','','left=0,top=0,width=1,height=1,toolbar=0,scrollbars=2,status=0');
	printWin.document.write(temp);
	printWin.document.close();
	printWin.focus();
	printWin.print();
	printWin.close();
}
function printDetail(content)
{

	var boilerPrint = 
		'<div style="height:24.6cm;">'+
		content+
		'</div>';

	var myboiler='<html><meta charset="utf-8" /><head>'+
	'<style type="text/css">'+
	'@media print  and (width: 11.69in) and (height: 8.27in) {'+
	'@page {'+
	'     margin: 3cm;'+
	'		size : landscape'+
	'		size:11.69in 8.27in;'+
	'  }'+
	//'table { page : rotated }'+ 
	'body{ background-color:#FFFFFF; background-image:none; color:#000000; }'+
	'.ad{ display:none;}'+
	'.HeaderSection'+
	'{'+
	'display:none;'+
	'}'+
	'.FooterSection'+
	'{'+
	'display:none;'+
	'}'+
	'.leftbar{ display:none;}'+
	'.contentarea{ width:100%;}'+
	'}'+
	'</style>'+
	'<link rel="stylesheet" href="css/print.css" rel="stylesheet" media="print" />'+
	'</head><body>';
	myboiler+=boilerPrint;
	myboiler+='</body></html>';
	var printWin = window.open('','','left=0,top=0,width=1,height=1,toolbar=0,scrollbars=2,status=0');
	printWin.document.write(myboiler);
	printWin.document.close();
	printWin.focus();
	printWin.print();
	printWin.close();
}

function exportStudentTransactionDetailstoExcel(studentId){
	window.location.replace('exportStudentTransactionDetailstoExcelStudent.json?studentId='+studentId);
}

var globleLagacyAmount = 0;
function getStudentFeeDueReportOverallByStudentBatchId() {

	var studentId = $('#studentId').val();

	$.ajax({
		url:'getStudentFeeDueReportTotalFeeStructureWiseByStudentBatchIdStudentView.json', 
		data:'studentId='+studentId,
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
		
			if(jArray.length == 3){
				showStudentOverallFeeDueReportForInvoiceByStudentBatchId(studentId);
			}
		}
	});
}

var bankchallan='';
var onlinepayment='';
var parpayment='';
var paymentAmounts=0.0;
var g_showStudentInvoiceFeesDetails="No";

function showStudentOverallFeeDueReportForInvoiceByStudentBatchId(src){
	if(src!=undefined && src!='0'){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	var studentId =0;
	var studentReceivable=0.0;
	$('#newBankChallanPaymentSpan').html('');
	$('#chkAgreeTermsAcademic').attr('checked',false);
	$('#paymentDetails').html();
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	$('#divStudentFeeDueInformation').html(boiler);
	$('#divStudentCancellationInformation').html('');

	$('.studentFeeInviceListDetail').show();
	boiler='';
	var statusflag=true;
	var buttonAlias='Receipts';
	if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES")
		buttonAlias='Addmission Fee Receipts';
		
	var hdAuth = $('#hdAuth').val();
	var url = 'checkStudentFeeStructureStatus.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_checkStudentFeeStructureStatus.json';
	}
	$.ajax({
		url:url, 
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray.status=='Notrestructure'){
				
			$('#hostelFeesDetails').css("height", "0px");
			$('#hostelFeesDetails').removeClass('in collapse');
			$('#hostelFeesDetails').addClass('collapse');
			$('#HostelDetails').find('a').removeClass('collapsed');
					
			$('#divStudentInformationHostel').html('');
			$('#divStudentHostelFeeInformation').html('');
			$('#divStudentHostelFeeOnlineInformation').html('');
			$('#divStudentHostelFeeBankChallanInformation').html('');
			$('#divStudentHostelFeeInstallmentInformation').html('');
			$('#divStudentHostelFeePaymentInformation').html('');
				var url1 = 'getfeestructureDetailsbyStudentIdofstudentSide.json?StudentId='+studentId;
				if(hdAuth == "student" || hdAuth == "Student"){
					url1 = 'stu_getfeestructureDetailsbyStudentIdofstudentSide.json';
				}
				$.ajax({
					url:url1,
					dataType:'json',
					beforeSend: function() {
						startCommonAjaxSpinner();
					},
					complete: function() {
						stopCommonAjaxSpinner();
					},
					success:function(feeStructureJArray1){
						var studentdetails=feeStructureJArray1[0][0];
						instid=studentdetails.InstituteCourseId;
						var OnlineTranasationList=feeStructureJArray1[2];
						var BankTranasationList=feeStructureJArray1[3];
						var PaymentAmmount=0.0;
						globalSource=studentdetails["InstituteCourseStrengthId"];
						if($('#txtInstituteId')!=undefined && $('#txtInstituteId').val()!=undefined && $('#txtInstituteId').val()!='')
							instituteId = $('#txtInstituteId').val();
						else
							instituteId = studentdetails["instituteId"]!=null?studentdetails["instituteId"]:"";
						
						feeStructureJArray=feeStructureJArray1[1];


						g_showStudentInvoiceFeesDetails = studentdetails.showStudentInvoiceFeesDetails;
						advancePaidFlag=studentdetails.advancePaidFlag;

						if(feeStructureJArray.length > 0){
							boiler =  '';
							var exceptionalCase=false;
							if(studentdetails.showStudentInvoiceFeesDetails=="Yes")
								boiler+='<div style="text-align:right"><a href="#" style="float:left;display:none;" class="btn btn-mini btn-inverse" onclick="refreshFeestructureAllDetails('+studentId+')"><i class="fa fa-refresh"></i>&nbsp; Refresh</a>&nbsp;&nbsp;';
							
							boiler+='<a href="#"  class="btn btn-mini btn-inverse" onclick="viewOnlineBankChallanTransactionDetails('+studentId+')"><i class="fa fa-eye"></i>&nbsp; View Online / Bank Challan Transaction Details</a></div>'+
							'<br><div class="label label-info" style="padding:2px;text-align:center">Fee Structure Details</div><br><table class="table table-bordered table-condensed"  style="margin-top:-14px"><tr><th>'+
							'Fee Structure Name</th><th>Admission Type</th><th>Admission Category</th><th>Fee Structure Year</th><th class="gems_currency_label">Total   Fees  </th><th class="gems_currency_label">Paid   Amount  </th>';
							
								if($('#customerHelper').val()!="BLM_MUNJAL"){
					
									boiler+='<th class="gems_currency_label">Concession</th>';
									boiler+='<th class="gems_currency_label">Government Liability</th>';
									
									}else{
										boiler+='<th class="gems_currency_label">Concession/Scholarship/Government Liability</th>';
									}
								
							boiler+='<th class="gems_currency_label">'+juno.labelByCustomer('l.StudentReceivable')+'</th><th class="gems_currency_label">'+juno.labelByCustomer('l.StudentPayable')+'</th>';
							boiler+='<th class="gems_currency_label">'+juno.labelByCustomer('l.SponsorshipReceivable')+'</th><th class="gems_currency_label">Sponsorship Received</th>';
								if(advancePaidFlag==true){
										boiler+='<th class="gems_currency_label">Advance Paid Amount</th>';
										boiler+='<th class="gems_currency_label">Total Receivable Amount</th>';
									
									}
							boiler+='<th>Generate '+juno.labelByCustomer('l.isInvoceToFeesLabel')+'</th></tr>';
							boiler+='</tr><tbody id="invoicedetails"></tbody>';
							boiler+='<tr><th colspan="4">Total</th> <td id="StudentPayable" style="text-align:right;" class="gems_currency"></td><td id="StudentPaid" style="text-align:right;" class="gems_currency"></td>';
									
									if($('#customerHelper').val()!="BLM_MUNJAL"){
				
										boiler+='<td id="concessionAmt" style="text-align:right;" class="gems_currency"></td>';
										boiler+='<td id="govermentLablity" style="text-align:right;" class="gems_currency"></td>';
								
									}else{
										    boiler+='<td id="concessionAmount" style="text-align:right;" class="gems_currency"></td>';
									}
									
								//	'<td id="concessionAmount" style="text-align:right;" class="gems_currency"></td>'+
									
									boiler+='<td id="Remaining" style="text-align:right;" class="gems_currency"></td></td><td id="studentPayable123" style="text-align:right;" class="gems_currency"></td>';
											
									
									boiler+='<td id="sponsorshiprecevable" style="text-align:right;" class="gems_currency"></td><td id="sponsorshipreceived" style="text-align:right;" class="gems_currency"></td>';
											if(advancePaidFlag==true){
												boiler+='<td id="advancePaid" style="text-align:right;background-color: #d2ffde;" class="gems_currency"></td>';
												boiler+='<td id="billAdvanceReceivable" style="text-align:right;background-color: #d2ffde;" class="gems_currency"></td>';
											}
							boiler+='<td>';
										
							$('#divStudentInformation').html(boiler);

							//fee structure Details
							for(var i = 0 ; i < feeStructureJArray.length ; i++){
								boiler='';
								var column='';
								if(i==0 && $('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
									column=feeStructureJArray[0].regFlag;
									if(column=='Registration')
										column='<br><br><input type="button" value=" Admission '+column+'" class="btn btn-mini btn-inverse" onclick="setZeroBill('+feeStructureJArray[0].studentFeeInvoiceId+');registrationForm('+studentId+')">';
									else
										column='<br><br><span style="color:red;font-size:11px;">Admission '+column+'</span>';
								}else
									column='';
								var lockStatus=feeStructureJArray[i].lockstatus;
								var remains1=0;
								var remains=eval(eval(feeStructureJArray[i].StudentPayable)-eval(feeStructureJArray[i].StudentPaid));
								var advancedRemains=eval(eval(feeStructureJArray[i].StudentPayable)-eval(feeStructureJArray[i].advancePaid));
								remains=remains-eval(feeStructureJArray[i].concessionAmount);
								if(remains<0)
								{
									remains1=0;
									remains=eval(-remains)
								}
								else{
									remains1=remains;
									studentReceivable+=(lockStatus!="Lock"?remains1:eval("0"));
									remains=0;
								}
								var remainsspon=eval(feeStructureJArray[i].sponsorshiprecevable)-eval(feeStructureJArray[i].sponsorshipreceived);
								tempId = 'trFeeStructureId-'+feeStructureJArray[i].feeItemId+''+studentId+''+i;
								var a='invoicedate'+i;
								boiler+='<tr id="'+tempId+'"><td id="Feename">'+feeStructureJArray[i].feestructurename+'</td>';
								boiler+='<td>'+feeStructureJArray[i].Admissiontype+'</td>';
								boiler+='<td>'+feeStructureJArray[i].category+'</td>';
								boiler+='<td id="feeyear">'+feeStructureJArray[i].year+'</td>';
								boiler+='<td  style="text-align:right;" class="StudentPayable gems_currency">'+feeStructureJArray[i].StudentPayable.toFixed(2)+'</td>';
								boiler+='<td style="text-align:right;" class="StudentPaid gems_currency">'+feeStructureJArray[i].StudentPaid.toFixed(2)+'</td>';
								
								if($('#customerHelper').val()!="BLM_MUNJAL"){
									boiler+='<td style="text-align:right;" class="concessionAmt gems_currency">'+feeStructureJArray[i].concessionAmt.toFixed(2)+'</td>';
									boiler+='<td style="text-align:right;" class="govermentLablity gems_currency">'+feeStructureJArray[i].govermentLablity.toFixed(2)+'</td>';
								}else{
									boiler+='<td style="text-align:right;" class="concessionAmount gems_currency">'+feeStructureJArray[i].concessionAmount.toFixed(2)+'</td>';
								}
								
						//		boiler+='<td style="text-align:right;" class="concessionAmount gems_currency">'+feeStructureJArray[i].concessionAmount.toFixed(2)+'</td>';
								boiler+='<td style="text-align:right;" class="Remaining gems_currency">'+remains1.toFixed(2)+'</td>';
								boiler+='<td style="text-align:right;" class="studentPayable123 gems_currency">'+remains.toFixed(2)+'</td>';
								boiler+='<td style="text-align:right;" class="sponsorshiprecevable gems_currency">'+feeStructureJArray[i].sponsorshiprecevable.toFixed(2)+'</td>';
								boiler+='<td style="text-align:right;" class="sponsorshipreceived gems_currency">'+feeStructureJArray[i].sponsorshipreceived.toFixed(2)+'</td>';
								if(advancePaidFlag==true){
										boiler+='<td style="text-align:right;background-color: #d2ffde;" class="advancePaid gems_currency">'+feeStructureJArray[i].advancePaid.toFixed(2)+'</td>';
										if(remains1<=feeStructureJArray[i].advancePaid)							
											advancedRemains=0;
										boiler+='<td style="text-align:right;background-color: #d2ffde;" class="billAdvanceReceivable gems_currency">'+advancedRemains.toFixed(2)+'</td>';
									}
								boiler+='<td><input type="button" value="'+buttonAlias+'" class="btn btn-mini btn-inverse  btnColorBlack " onclick="studentBillingInfo(\''+feeStructureJArray[i].studentFeeInvoiceId+'\');">'+column+'</br>'+(lockStatus=='Lock'?('<span style="color:red;font-size:11px;">Payment status Locked</span>'):'')+'</td>';
								
								$('#invoicedetails').append(boiler);
								remains1=0.00;
								$('#trFeeStructureId-'+feeStructureJArray[i].feeItemId+''+studentId+''+i).data('feeStructureObject',feeStructureJArray[i]);
							}


							var jArray=feeStructureJArray1[4]["installmentDetalis"];
							var parpaymentjArray=feeStructureJArray1[5];
							var jArray1=feeStructureJArray1[4];
							bankchallan=jArray1["bankchallan"]!=undefined?jArray1["bankchallan"]:"";
							onlinepayment=jArray1["onlinepayment"]!=undefined?jArray1["onlinepayment"]:"";
							parpayment=jArray1["parpayment"]!=undefined?jArray1["parpayment"]:"";
							PaymentAmmount=jArray1["PaymentAmmount"]!=undefined?jArray1["PaymentAmmount"]:"";
							var textMsg = jArray1["textMsg"]!=undefined?jArray1["textMsg"]:false ;
							// Online Installment Details 
							var InstallmentIds='';
							var amounts=0.0;
							if(jArray1["installment"]=="YES"){
								$('#studentInstallMent').html('');
								var  boiler1='<div style="float:right"><a href="#"  class="btn btn-mini btn-inverse" onclick="refreshInstallmentDetails('+studentId+')"><i class="fa fa-refresh"></i>&nbsp; Refresh Installments</a></div>'+
								'<br><div class="label label-info" style="text-align:center">Installment Details</div><br><table class="table table-bordered table-condensed tablePrint"  style="margin-top:-14px">'+
								'<tr><th></th><th>Installment No</th><th>Installment Date</th><th>Installment Amount</th><th>Charges Type</th><th>Charges Amount</th>'+
								'<th>No of Late Days/Months</th><th>Your Charges amount</th><th>Payable amount</th>';
								if(jArray.length>0){
									for(var i = 0 ; i < jArray.length ; i++){
										boiler1+='<tr>';
										if($('#customerHelper').val()!="DYPATIL"){
											if(i == 0)
												boiler1+='<td><input type="checkbox" class="clsinstallment clsinstallmentind" installmentid="'+jArray[i]["installmentid"]+'" value="'+eval(eval(jArray[i]["installmentAmount"]))+'" onclick="selectamount();"></td>';//value="'+eval(eval(jArray[i]["installmentAmount"])+eval(jArray[i]["amountCharges"]))+'" 
											else{
												boiler1+='<td></td>';
											}
										}else{
												boiler1+='<td><input type="checkbox" class="clsinstallment clsinstallmentind" installmentid="'+jArray[i]["installmentid"]+'" value="'+eval(eval(jArray[i]["installmentAmount"]))+'" onclick="selectamount();"></td>';//value="'+eval(eval(jArray[i]["installmentAmount"])+eval(jArray[i]["amountCharges"]))+'"
											}
										InstallmentIds+=jArray[i]["installmentid"]+','
										//amounts+=eval(eval(jArray[i]["installmentAmount"])+eval(jArray[i]["amountCharges"]));
												amounts+=eval(eval(jArray[i]["installmentAmount"]));
										var amountaa=eval(eval(jArray[i]["installmentAmount"])+eval(jArray[i]["amountCharges"]));
										boiler1+='<td class="gems_integer">'+jArray[i]["installmentNo"]+'</td>'+
										'<td>'+jArray[i]["installmentDate"]+'</td>'+
										'<td class="gems_currency" >'+jArray[i]["installmentAmount"]+'</td>'+
										'<td>'+jArray[i]["ChargesType"]+'</td>'+
										'<td class="gems_currency">'+jArray[i]["ChargesAmount"]+'</td>'+
										'<td class="gems_integer">'+jArray[i]["monthormonth"]+'</td>'+
										'<td class="gems_currency">'+jArray[i]["amountCharges"]+'</td>'+
										'<td class="gems_currency">'+amountaa+'</td>'+
										'</tr>';
										$('#studentInstallMent').html(boiler1);
									}

								}
								else{
									boiler1+='<tr><td colspan="4">Data Not Found !!!</td></tr>';
									$('#studentInstallMent').html(boiler1);
								}

								if(jArray.length>0){
									InstallmentIds=InstallmentIds.substring(0, InstallmentIds.length-1);
									var boiler1='<br><b><div class="badge badge-success"><input type="checkbox" class="clsinstallment clsinstallmentAll" installmentid='+InstallmentIds+' value='+amounts+' id="makeallInstallmentPayment" onclick="selectamount();">&nbsp;To make full payment select this checkbox</b>';
									$('#studentInstallMent').append(boiler1);
								}

							}
							else{
								$('#studentInstallMent').hide();
							}
							//


							//// payment Process
							console.log(eval(studentReceivable));
							if(eval(studentReceivable)>0 && $('#customerHelper').val()!=undefined && $('#customerHelper').val()!="REVA_UNIVERSITY"){
								var varible='';
								if($('#customerHelper').val()=="RCOEM"){
									varible ='';
								}else{
									varible ='/Bank Challan';
								}
								var boiler ='<br><br><br><b><input type="checkbox" id="chkAgreeTermsAcademic" onclick="ProccedAcademicToPay()">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b><br> '+
								'<span><span id="paymentdiv"> You have chosen to pay an amount </span><b>Rs- <span id="amtForOnlinePaymentStudentFeeDue"></b></span><b><span id="amtForOnlinePaymentStudentLateFee"></b></span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
								(textMsg==true?'<span style="color:red;font-size:11px;" ><b>Note:</b> THE ADMISSION TO SUBJECTS OR COMBINATION OF SUBJECT PREFERENCE IS PROVISIONAL DEPENDING UPON THE NUMBER OF SEATS AND OR MERIT LIST WHICHEVER IS APPLICABLE.     </span>':'')+
								'<br><div style="text-align:center;" id="paymentPluginsDiv1"></div><div style="text-align:center;display:none;" id="paymentPluginsDiv"></div>'+
								'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDue"></span>'+
								'<br>'+
								'<div id="onlinePaymentSpan" style="text-align:center;display:none;">'+
								'<span id="onlinePaymentSpan2"></span>&nbsp;&nbsp;'+
								'<span id="onlinePaymentSpan3"></span>&nbsp;&nbsp;'+
								'<span id="onlinePaymentSpan4"></span>&nbsp;&nbsp;'+
								'</div>'+
								//'<br><span id="newBankChallanPaymentSpan"></span>'+
								'<br>';
								$('#paymentDetails').html(boiler);
							}

							//if fees facility given
							if(eval(PaymentAmmount)>0){
								setTimeout(function(){
									var vv='<b style="color:red;font-size:11px;" >You have been given the facility of Partial Payment Please Pay Amount      <b>';
									$('#paymentdiv').html(vv);
									$('#amtForOnlinePaymentStudentFeeDue').html(PaymentAmmount);
									paymentAmounts=PaymentAmmount;
								},100);
							}
							else{
								$('#amtForOnlinePaymentStudentFeeDue').html(studentReceivable);
								paymentAmounts=studentReceivable;
							}
							
							var StudentPayable=0;
							$('.StudentPayable').each(function() {
								StudentPayable+=eval($(this).html());
							});
							$('#StudentPayable').html(StudentPayable);

							var StudentPaid=0;
							$('.StudentPaid').each(function() {
								StudentPaid+=eval($(this).html());
							});
							$('#StudentPaid').html(StudentPaid);
							
							var concessionAmount=0;
							$('.concessionAmount').each(function() {
								concessionAmount+=eval($(this).html());
							});
							$('#concessionAmount').html(concessionAmount);
							
							var concessionAmt=0;
							$('.concessionAmt').each(function() {
								concessionAmt+=eval($(this).html());
							});
							$('#concessionAmt').html(concessionAmt);
							
							var govermentLablity=0;
							$('.govermentLablity').each(function() {
								govermentLablity+=eval($(this).html());
							});
							$('#govermentLablity').html(govermentLablity);
							

							var sponsorshiprecevable=0;
							$('.sponsorshiprecevable').each(function() {
								sponsorshiprecevable+=eval($(this).html());
							});
							$('#sponsorshiprecevable').html(sponsorshiprecevable);

							var sponsorshipreceived=0;
							$('.sponsorshipreceived').each(function() {
								sponsorshipreceived+=eval($(this).html());
							});
							$('#sponsorshipreceived').html(sponsorshipreceived);//

							var Remaining=0;
							$('.Remaining').each(function() {
								Remaining+=eval($(this).html());
							});
							$('#Remaining').html(Remaining);
							if(advancePaidFlag==true){
								
								var advancePaid=0;
								$('.advancePaid').each(function() {
									advancePaid+=eval($(this).html());
								});
								$('#advancePaid').html(advancePaid);
								var billAdvanceReceivable=0;
								$('.billAdvanceReceivable').each(function() {
									billAdvanceReceivable+=eval($(this).html());
								});
								$('#billAdvanceReceivable').html(billAdvanceReceivable);
							}


							var studentPayable123=0;
							$('.studentPayable123').each(function() {
								studentPayable123+=eval($(this).html());
							});
							$('#studentPayable123').html(studentPayable123);
							if(studentReceivable==0){
								$('#paymentDetails').html('');
							}

						} else {
							$('#feesDetails').html('<div class="alert alert-error"><strong>Sorry!! No Fee structure found</strong></div>');
						}


					}
				});
			}else{
				jAlert('Your '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' is under process please contact your finance Department');
				$('#acadfee').attr('class','accordion-toggle');
				$('#divSemsterIds').hide();
				$('#feeDemandDetails').hide();
			}
		}
	});
}

function selectamount(){
	var amount=0.0;
	var flag='true';
	var count=0;
	$('#newBankChallanPaymentSpan').html('');
	$('#paymentDetails').show();
	$('.clsinstallment:checked').each(function(){
		amount+=eval($(this).attr("value"));
		flag='false';
		count++;
    });
    
	if(count>1 && $('#customerHelper').val()!="DYPATIL"){
		jAlert('Please select one installment or all installment at a time for payment');
		$('.clsinstallment').attr('checked',false);
		$('#paymentDetails').hide();
		return false;
	}
	$('#chkAgreeTermsAcademic').attr('checked',false);
	ProccedAcademicToPay();
	$('#amtForOnlinePaymentStudentFeeDue').html(amount);
	if(flag=='true')
		$('#amtForOnlinePaymentStudentFeeDue').html(paymentAmounts);
}

function selectamounts(){
	var amount=0.0;
	var flag='true';
	var count=0;
	$('#newBankChallanPaymentSpan').html('');
	$('.clsinstallmentforHostel:checked').each(function(){
		amount+=eval($(this).attr("value"));
		flag='false';
		count++;
	});
	if(count>1){
		jAlert('Please select one installment or all installment at a time for payment');
		$('.clsinstallment').attr('checked',false);
		return false;
	}
	$('#chkAgreeTermsAcademic').attr('checked',false);
	//ProccedHstelFeeToPay(amount);
	if(flag=='false'){
		$('#amtForHostelPayment').html(amount);
	}
	else{
		var amt=$('#amtForHostelPayment').attr('orgvalue');
		$('#amtForHostelPayment').html(amt);

	}
}


function getMiscellaneousStudentFeeDueReportOverallByStudentBatchId(src) {
	
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}

//	var studentId = $('#studentId').val();
	var studentId =0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	var hdAuth = $('#hdAuth').val();
	var url = 'getMiscellaneousStudentDue.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_getMiscellaneousStudentDue.json';
	}
	//getMiscellaneousStudentFeeDueReportOverallByStudentBatchId.json
	$.ajax({
		url:url,
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			showStudentMiscellaneousFeeDueReportForInvoiceByStudentBatchId(jArray);
		}
	});
}
function showStudentMiscellaneousFeeDueReportForInvoiceByStudentBatchId(jArray){	
	tempId ='';
	globalSource = 0;
	var studentListJsonArray = jArray[0];
	//alert(studentListJsonArray);
	var feeStructureJArray = jArray[0][0]['fineList'];
	//alert(feeStructureJArray.length);
	var legacyObject = jArray[2];
	var boiler = '';
	var exceptionalCase = false;
	var admissionTypeName ='';
	/** Showing student information */
	//alert(studentListJsonArray.length);
	$('.studentFeeInviceListDetail').show();
	var studentId = '';
	if($('#customerHelper').val()!="BLM_MUNJAL"){
		if(studentListJsonArray.length > 0){
			studentId = studentListJsonArray[0].studentId;
			var stdName = studentListJsonArray[0].name;
			var studentName = '<STRONG>'+studentListJsonArray[0].name+'</STRONG>';
			var rollNo  = studentListJsonArray[0].rollNo;

			if(rollNo==undefined || rollNo=='undefined')
				rollNo = '';

			exceptionalCase = studentListJsonArray[0].exceptionalCase;
			var course = studentListJsonArray[0].coourseName;
			var admissionCategoryName = studentListJsonArray[0].admissionCategoryName;
			admissionTypeName = studentListJsonArray[0].admissionType;
			var semester = studentListJsonArray[0].semester!=undefined?studentListJsonArray[0].semester:"-";
			var division = studentListJsonArray[0].division!=undefined?studentListJsonArray[0].division:"-";
			var instituteCourseStrengthId = studentListJsonArray[0].instituteCourseStrengthId;

			var batchYear = studentListJsonArray[0].batchYear;
			var stdInstCourseSemBatch = studentListJsonArray[0].stdInstCourseSemBatch;
			globalSource = instituteCourseStrengthId;
			var status="";

			if(studentListJsonArray[0].status=="ADMISSION_CANCELLED")
				status = "ADMISSION CANCELLED";
			else if(studentListJsonArray[0].status=="PURSUING")
				status = "PURSUING";
			else if(studentListJsonArray[0].status=="YEARDOWN")
				status = "YEAR DOWN";

			exceptionalCase = exceptionalCase == undefined?false:exceptionalCase;


			boiler +=
				'<table class="table table-condensed table-bordered tablePrint studentPersonalInformation" style="display:none">'+
				'<tr>'+
				'<td rowspan="5" width="120px"><div class = "thumbnail studentProfileImage"></div></td>'+
				'<th style="text-align:left">Name</th><td>'+decodeURIComponent(studentName)+'</td>'+
				'<th style="text-align:left">Roll</th><td>'+rollNo+'</td>'+
				'<td style = "display:none;" class="studentId">'+studentId+'</td>'+
				'<td style = "display:none;" class="instituteCourseStrengthId">'+instituteCourseStrengthId+'</td>'+
				'</tr>'+
				'<tr>'+
				'<th style="text-align:left">Programme&nbsp;&nbsp;/&nbsp;&nbsp;Semester&nbsp;&nbsp;/&nbsp;&nbsp;Division</th><td colspan="3">'+course+'&nbsp;&nbsp;/&nbsp;&nbsp;'+semester+'&nbsp;&nbsp;/&nbsp;&nbsp;'+division+'</td>'+
				'<th style="text-align:left ;display :none">Admission type</th><td style="display :none">'+admissionTypeName+'</td>'+
				'</tr>'+
				'<tr style="display :none">'+
				'<th style = "text-align:left">Admission category name</th>'+
				'<td style = "text-align:left">'+admissionCategoryName+'</td>'+
				/*'<th style = "text-align:left">Exceptional Case</th>'+
	        '<td style = "text-align:left">'+exceptionalCase.toString().toUpperCase()+'</td>'+*/

				'<th style = "text-align:left">Admission Status</th>'+
				'<td style = "text-align:left">'+status+'</td>'+

				'</tr>'+
				// '<tr>'+
				//   '<th style = "text-align:left">Request for Admission Cancellation</th>'+
				//  '<td style = "text-align:left" colspan="3">'+
				//'&nbsp;&nbsp;<input type="button" class="btn btn-inverse btn-mini btn-admissionCancel" style="display:none;" value="Request Admission Cancellation">&nbsp;&nbsp;'+
				//'&nbsp;&nbsp;<input type="button" class="btn btn-inverse btn-mini btn-generateVoucher" style="display:none;" disabled="disabled" value="Cancel Request">'+
				//'&nbsp;&nbsp;<input type="button" class="btn btn-mini btn-inverse btn-cancelAdmission" value="Admission Cancellation">&nbsp;&nbsp;'+


				// '</td>'+
				//'</tr>'+
				/*'</table><hr style="padding:0px;margin-bottom:5px">'+
			'<span><b>Rules and Regulation</b></span>'+
			'<ul>'+
			'<li>The bill payment service will be unavailable from 11:40 pm to 3:15 am daily.</li>'+
			'<li>To avoid fradulent transaction, it is recommended not to reveal details of your card to anybody; make payment yourself without going through any channels/agents.</li>'+
			'<li>Do not open multiple payment windows simultaneously. For multiple consumer numbers, make payments one at a time.</li></ul>'+*/


				'<b>To proceed with payment please verify the details below before choosing payment option</b>';
			//	'<b>To Procced with payment please verify the details below chosing you payment option</b>';

			$('#divStudentInformationMiscellaneous').html(boiler);
			//$('.studentProfileImage').html('<img src="getStudentProfileImageById.json?id='+studentId+'&type=profile" class = "img-polaroid" height = "100px" width = "100px" alt = "No image">');
			//showAdmissionCancellationForm(studentListJsonArray[0].studentId,studentListJsonArray[0].instituteCourseStrengthId);

			$('.btn-cancelAdmission').click(function(){
				configureStudentCancelationDetail(studentId,stdInstCourseSemBatch,rollNo,stdName,batchYear,course,semester,division);
			});

		} else {
			$('#divStudentInformationMiscellaneous').html('<div class="alert alert-error"><strong>Sorry!! No Student found found</strong></div>');
		}
	}
	var totalAmountToPay = 0;
	if(feeStructureJArray.length > 0){
		var boiler='';
		//if(g_showStudentInvoiceFeesDetails=="Yes")
			boiler+='<div style="float:right"><a href="#" class="btn btn-mini btn-inverse" onclick="refreshStudentSideAcademic('+studentId+',\'Miscellaneous\')"><i class="fa fa-refresh"></i>&nbsp; Refresh</a></div>';
		
		boiler+='<table class="table table-condensed table-bordered tablePrint studentFineDetails">'+
		'<tr>'+
		'<th></th>'+
		'<th>Sr No</th>'+
		'<th>Account For</th>'+
		'<th>Description</th>'+
		'<th>Generated Date</th>'+
		'<th>Generated By</th>'+
		'<th class="gems_currency_label">Miscellaneous Amount</th>'+
		'<th class="gems_currency_label">Paid Amount</th>'+
		'<th class="gems_currency_label">Payable Amount</th>'+
		'<th>Receipt No</th>'+
		'</tr>';
		for(var i =0;i<feeStructureJArray.length;i++){
			var studentHostelFineId = feeStructureJArray[i]['studentHostelFineId'];
			var journalId = feeStructureJArray[i]['journalId']; 
			var paidAmount =feeStructureJArray[i]['paidAmount'];
			var amount = feeStructureJArray[i]['amount'];
			var paidAmount = feeStructureJArray[i]['paidAmount'];
			var rceiptNo = feeStructureJArray[i]['journalId'];
			var financepolicyId=feeStructureJArray[i]['financepolicyId'];
			var amountPayable = 0;
			amountPayable =eval(amount) - eval(paidAmount);
			if(amountPayable==0 || amountPayable==0.0 || eval(amountPayable)<0){
				boiler+='<td></td>';
			}
			else{
				boiler+='<td><input type="checkbox" class="chkMiscellneousAmtCls" miscHostelFineId="'+studentHostelFineId+'" value="'+amountPayable+'" onclick="checkOfficeDocAmountIndiviual1()"></td>';
			}	
			boiler+='<td style="text-align:right">'+eval(i+1)+'</td>'+
			'<td>'+feeStructureJArray[i]['accountName']+'</td>'+
			'<td>'+feeStructureJArray[i]['description']+'</td>'+
			'<td>'+feeStructureJArray[i]['generatedDate']+'</td>'+
			'<td style="text-align:right">'+feeStructureJArray[i]['generatedBy']+'</td>'+
			'<td class="gems_currency">'+amount+'</td><td class="gems_currency">'+paidAmount+'</td><td class="gems_currency">'+eval(amount-paidAmount)+'</td>'+
			'<td><a onclick="getIncomeReceiptByFinancePolicyIdStudentSide(\''+rceiptNo+'\',\''+financepolicyId+'\');">'+rceiptNo+'</a></td></tr>';
			totalAmountToPay = eval(totalAmountToPay) + eval(amountPayable);
		}
		boiler+='</table>';
		$('#divStudentFeeDueInformationMiscellaneous').html(boiler);
		
		if($('#customerHelper').val()!="BLM_MUNJAL"){
			var varible='';
			if($('#customerHelper').val()=="RCOEM"){
				varible ='';
			}else{
				varible ='/Bank Challan';
			}
			boiler ='<div id="miscTotalDiv" style="display:none;"><b><input type="checkbox" id="chkAgreeTermsMiscellaneous" onclick="ProccedAcademicToPay1('+totalAmountToPay+');">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b><br> '+
			'<span> You have chosen to pay an amount <b>Rs.</b> <label id="amtForOnlinePayment" class="amtForOnlinePaymentMisc" miscTotalAmt="'+totalAmountToPay+'">'+totalAmountToPay+'</label> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
			'<span style="font-weight:bold;color:red">*If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>'+

			'<br><div style="text-align:center" id="paymentPluginsDivForMS"></div>'+
			'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueForMS"></span>'+
			'<br><div id="onlinePaymentSpanForMS" style="display:none;" >';
			if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
				boiler +='<table style="align:center;" class="table"><tr>'+
				'<td style="text-align: center;" colspan="" id="onlinePaymentSpanForMS2"></td>'+
				'<td style="text-align: center;" colspan="" id="onlinePaymentSpanForMS5"></td>'+
				'<td style="text-align: center;" colspan="" id="onlinePaymentSpanForMS6"></td>'+
				'</tr>'+
				'</table>';
			}else{
			boiler +='<span style="text-align:center;" id="onlinePaymentSpanForMS2"></span><br>'+
			'<span style="text-align:center;" id="onlinePaymentSpanForMS5"></span>';
			}
			
			
			boiler +='<div></div>';
			$('#divStudentFeeDueInformationMiscellaneous').append(boiler);

		}
	} else {
		$('#divStudentFeeDueInformationMiscellaneous').html('<div class="alert alert-error"><strong>Sorry!! No Fee structure found</strong></div>');
	}


	var bankId = 2;
	$(document).ready( function() {

		$('#paymentPluginsStudentFeeDueMisc').bcpymt({sPC:'MISCF',bWFH:false,iFBIDs:bankId});

	});

}
function callonlinePayment(){
	$.ajax({
		url : 'fetchMiscStudentDetail.json',
		dataType : 'json',
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray1) {
			
		},
	});
	var boiler = ''+
	'<input type="radio" class="" name="paymentMode" id="" value="" onclick="checkShowHide();" /><b> Online Payment &nbsp;&nbsp;&nbsp;</b>';
	if($('#customerHelper').val()!="INDIRA_PUNE"){
		boiler+='<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpan\').hide();$(\'#paymentPluginsStudentFeeDue\').show();" /><b>Bank Challan&nbsp;&nbsp;&nbsp;</b>';
	}
	$('#paymentPluginsDiv').html(boiler).show();
	if($('#customerHelper').val()=="DES"){
		$('#paymentPluginsDiv').html('').hide();
	}
}

function checkShowHide(){
	
	
	$('#onlinePaymentSpan').show();
	$('#paymentPluginsStudentFeeDue').hide();
}

function ProccedMiscellaneousToPay(){
	if($('#chkAgreeTermsMiscellaneous').is(':checked')){
		$('#paymentPluginsStudentFeeDueMisc').show();
		
	}else{
		$('#paymentPluginsStudentFeeDueMisc').hide();
	}
}
function storefinalAmount(callback){
	var installmentIds = new Array();
    $('.clsinstallment:checked').each(function(){
    	installmentIds.push($(this).attr("installmentid"));
    });
	var PaymentAmmount=$('#amtForOnlinePaymentStudentFeeDue').html();
	if(eval(PaymentAmmount)>0 && PaymentAmmount!=undefined)
	$.ajax({
		url : 'setpableAmountinSessiontoPay.json?PaymentAmmount='+ PaymentAmmount,
		dataType : 'json',
		data:{installmentIds:installmentIds.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(replay) {
			callback(replay);
		},
	});

}

function ProccedAcademicToPay(){   
	if($('#chkAgreeTermsAcademic').is(':checked')){

		
		var installmentIds = new Array();
	    $('.clsinstallment:checked').each(function(){
	    	installmentIds.push($(this).attr("installmentid"));
	    });
		
		
		
		var boiler = '';
		if(onlinepayment=="YES"){
			boiler +='<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpan\').show();$(\'#paymentPluginsStudentFeeDue\').hide();" /><b> Online Payment &nbsp;&nbsp;&nbsp;</b>';
		}
		if(bankchallan=="YES"){
			boiler +='<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpan\').hide();$(\'#paymentPluginsStudentFeeDue\').show();showBankChallan();" /><b>Bank Challan&nbsp;&nbsp;&nbsp;</b><br></span>';
		}
//		if($('#customerHelper').val()!="DES"){
		$('#paymentPluginsDiv').html(boiler).show();
//		}		
//		}
//		to set amount in session
		$.ajax({
			url : 'fetchApplicantAdmissionFeeDetailforstudentsidepayment.json?instituteCourseStrengthId='+ globalSource,
			dataType : 'json',
			data:{installmentIds:installmentIds.toString()},
			async : false,
			beforeSend : function() {
				startCommonAjaxSpinner();
			},
			complete : function() {
				stopCommonAjaxSpinner();
			},
			success : function(jArray) {
				var BankId=jArray[0]["bankIds0"];
				var lateFeeForInstallment=jArray[0]["valueLate"];
				/*if($('.clsinstallment').is(':checked')){
					storefinalAmount(function(replay){
						BankId=replay;
					});
				}*/
				if(eval(lateFeeForInstallment)>0){
						$('#amtForOnlinePaymentStudentLateFee').html("&nbsp  + "+lateFeeForInstallment+" (Late Fee) ");	
				}
				if (jArray.length > 0) {
					$.ajax({
						url : 'fetchOnlineApplicantAdmissionFeeDetailStatus.json',
						dataType : 'json',
						async : false,
						beforeSend : function() {
							startCommonAjaxSpinner();
						},
						complete : function() {
							stopCommonAjaxSpinner();
						},
						success : function(jArray1) {

							if (jArray1.length > 0) {

								if(jArray1[0]["prePayment"]){
								/*	if (jArray1[1]["hasDetails"]) 
										$('#paymentPluginsDiv').html("Payment has been <b>received</b> with following details - ,<br><b>Reference Id : "+jArray1[1]["transactionReferenceId"]+" <br>Amount : "+jArray1[1]["amount"]+" <br>Date : "+jArray1[1]["date"]+" </b> ");
									else{*/
									$('#paymentPluginsDiv1').html("<br><br>Payment has been <b>received</b> with following details - ,<br><b>Reference Id : "+jArray1[1]["transactionReferenceId"]+" <br>Amount : "+jArray1[1]["amount"]+" <br>Date : "+jArray1[1]["date"]+" </b>  <br> Do you want to continue? <br><br>");
										if($('#customerHelper').val()=="RCOEM"){
											
											/*if(eval(jArray[0]["liveAtkt"])>0){
			                                    $('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
			                                }
											else{*/
												/*$('#onlinePaymentSpan1').ucoSPPymt({
													sPC : 'ACADF'
												});*/
												
												/*$('#onlinePaymentSpan2').pymt({
													sPC : 'ACADF'
												});*/
											if(eval(jArray[0]["liveAtkt"])>0){
			                                    $('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
			                                }
											else{
												 $('#onlinePaymentSpan2').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
												 $('#onlinePaymentSpan1').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
											}
											
										}else if($('#customerHelper').val()=="STJOHNS"){
											$('#onlinePaymentSpan2').ccAvenue10Pymt({
												sPC : 'ACADF',
												iFBIDs :jArray[0]["bankIds0"]
											});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
											$('#onlinePaymentSpan2').ccAvenue6Pymt({
												sPC : 'ACADF',
												iFBIDs :jArray[0]["bankIds0"]
											});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
											if (jArray1[1]["hasDetails"]) {
												$('#paymentPluginsDiv1').html('');
												$('#paymentPluginsDiv').html("Payment has been <b>received</b> with following details - ,<br><b>Reference Id : "+jArray1[1]["transactionReferenceId"]+" <br>Amount : "+jArray1[1]["amount"]+" <br>Date : "+jArray1[1]["date"]+" </b> ");
											}else{
												
												$('#onlinePaymentSpan2').ccAvenue7Pymt({
													sPC : 'ACADF',
													iFBIDs :jArray[0]["bankIds0"]
												});
												
												$('#onlinePaymentSpan3').bdpymtV4({
													sPC:'ACADF' , 
													sSrc:'INS'
												});
											}

										}else if($('#customerHelper').val()=="ICT_MUMBAI"){
											$('#onlinePaymentSpan2').ccAvenuePymt({
												sPC : 'ACADF',
												iFBIDs:jArray[0]["bankIds0"],
											});
										}
										else if($('#customerHelper').val()=="CHANAKYA"){
											$('#onlinePaymentSpan2').bdpymtV3({
												sPC : 'ACADF'
											});
										}else if($('#customerHelper').val()=="INDIRA_PUNE"){
											
											$('#onlinePaymentSpan2').junoPymt({
												sPC:'ACADF' , 
												iFBIDs:jArray[0]["bankIds0"],
												sSrc:'INS'
											});
										}
										else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
											$('#onlinePaymentSpan2').ccAvenue4Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
											$('#onlinePaymentSpan2').techProcessPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DYPATIL"){
											$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
											//$("#onlinePaymentSpan").show();
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="RAMAIAH_UNIVERSITY"){
											$('#onlinePaymentSpan2').razorPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES"){
											$('#onlinePaymentSpan2').razor2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
											$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
											$('#onlinePaymentSpan2').payTM2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
											$('#onlinePaymentSpan3').razor8Pymt({sPC:'ACADF'});
											$('#onlinePaymentSpan4').easyPayPymt({sPC:'ACADF'});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="VCET"){
											$('#onlinePaymentSpan2').razor7Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SPIT"){
											$('#onlinePaymentSpan2').razor6Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MANDSAUR"){
											$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="ATAL_MEDICAL" || $('#customerHelper').val()=="SRHU" || $('#customerHelper').val()=="GOKHALE_INSTITUTE" || $('#customerHelper').val()=="MAHINDRA_UNIVERSITY" || $('#customerHelper').val()=="OXFORD_EDUCATIONAL_INSTITUTIONS" 
										|| $('#customerHelper').val()=="HPNLU"  || $('#customerHelper').val()=="SINGHANIA_UNIVERSITY")) {
											$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}
									//}

								}else{
									if($('#customerHelper').val()=="RCOEM"){

										/*if(eval(jArray[0]["liveAtkt"])>0){
											$('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
										}
										else{*/
											/*$('#onlinePaymentSpan1').ucoSPPymt({
												sPC : 'ACADF'
											});*/

											/*$('#onlinePaymentSpan2').pymt({
												sPC : 'ACADF'
											});*/
										//if(eval(jArray[0]["liveAtkt"])>0){
											//$('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
										//}  Changes requsted by snehal mam #189896
										//else{
											$('#onlinePaymentSpan2').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										//}
											// $('#onlinePaymentSpan1').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										//}

									}else if($('#customerHelper').val()=="STJOHNS"){
										$('#onlinePaymentSpan2').ccAvenue10Pymt({
											sPC : 'ACADF',
											iFBIDs :jArray[0]["bankIds0"]
										});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
										$('#onlinePaymentSpan2').ccAvenue6Pymt({
											sPC : 'ACADF',
											iFBIDs :jArray[0]["bankIds0"]
										});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
										if (jArray1[1]["hasDetails"]) {
											$('#paymentPluginsDiv1').html('');
											$('#paymentPluginsDiv').html("Payment has been <b>received</b> with following details - ,<br><b>Reference Id : "+jArray1[1]["transactionReferenceId"]+" <br>Amount : "+jArray1[1]["amount"]+" <br>Date : "+jArray1[1]["date"]+" </b> ");
										}else{
											
											$('#onlinePaymentSpan2').ccAvenue7Pymt({
												sPC : 'ACADF',
												iFBIDs :jArray[0]["bankIds0"]
											});
											
											$('#onlinePaymentSpan3').bdpymtV4({
												sPC:'ACADF' , 
												sSrc:'INS'
											});
										}
										
										/*$('#onlinePaymentSpan2').ccAvenue7Pymt({
											sPC : 'ACADF',
											iFBIDs :jArray[0]["bankIds0"]
										});*/
									}else if($('#customerHelper').val()=="ICT_MUMBAI"){
										$('#onlinePaymentSpan2').ccAvenuePymt({
											sPC : 'ACADF',
											iFBIDs:jArray[0]["bankIds0"],
										});
									}
									else if($('#customerHelper').val()=="CHANAKYA"){
										$('#onlinePaymentSpan2').bdpymtV3({
											sPC : 'ACADF'
										});
									}else if($('#customerHelper').val()=="INDIRA_PUNE"){
										$('#onlinePaymentSpan2').junoPymt({
											sPC:'ACADF' , 
											iFBIDs:jArray[0]["bankIds0"],
											sSrc:'INS'
										});
									}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
										$('#onlinePaymentSpan2').ccAvenue4Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
										$('#onlinePaymentSpan2').techProcessPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DYPATIL"){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										//$("#onlinePaymentSpan").show();
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="RAMAIAH_UNIVERSITY"){
										$('#onlinePaymentSpan2').razorPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES"){
										$('#onlinePaymentSpan2').razor2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="HPTELIBRARY"){
										$('#onlinePaymentSpan2').sbiEPay2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
										$('#onlinePaymentSpan2').payTM2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										$('#onlinePaymentSpan3').razor8Pymt({sPC:'ACADF'});
										$('#onlinePaymentSpan4').easyPayPymt({sPC:'ACADF'});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="VCET"){
										$('#onlinePaymentSpan2').razor7Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SPIT"){
										$('#onlinePaymentSpan2').razor6Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
										if(instituteId=='1'){
											$('#onlinePaymentSpan2').sbiEPayPymt({sPC:'ACADF',sSrc:'UTD',iFBIDs:5});
											$('#onlinePaymentSpan3').easyPay3Pymt({sPC:'ACADF',iFBIDs:7});
											$('#onlinePaymentSpan4').easyPay2Pymt({sPC:'ACADF',iFBIDs:4});
										}
										if(instituteId=='2'){
											$('#onlinePaymentSpan2').sbiEPayPymt({sPC:'ACADF',sSrc:'IIHS',iFBIDs:9});
										}
										if(instituteId=='3'){
											$('#onlinePaymentSpan2').sbiEPayPymt({sPC:'ACADF',sSrc:'UIET',iFBIDs:13});
											$('#onlinePaymentSpan3').easyPay3Pymt({sPC:'ACADF',iFBIDs:16});
											$('#onlinePaymentSpan4').easyPay2Pymt({sPC:'ACADF',iFBIDs:15});
										}
										if(instituteId=='763'){
											$('#onlinePaymentSpan4').easyPay2Pymt({sPC:'ACADF',iFBIDs:56});
										}
										
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="GC_UNIVERSITY"){
										$('#onlinePaymentSpan2').bdpymtV6({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MANDSAUR"){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="CMR_UNIVERSITY" || $('#customerHelper').val()=="CMR_IT")){
											$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="ATAL_MEDICAL"  || $('#customerHelper').val()=="SINGHANIA_UNIVERSITY" || $('#customerHelper').val()=="SRHU" || $('#customerHelper').val()=="GOKHALE_INSTITUTE" ||$('#customerHelper').val()=="MAHINDRA_UNIVERSITY" || $('#customerHelper').val()=="OXFORD_EDUCATIONAL_INSTITUTIONS" || $('#customerHelper').val()=="HPNLU")){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}
								}
							}
						},
					});

				}
			},
		});
	}else{
		$('#paymentPluginsDiv').hide();
		$('#onlinePaymentSpan').hide();
		$('#paymentPluginsStudentFeeDue').hide();
	}
}

var bankId = "";
var studentId = "";
function showBankChallan(){
	$('#printprofuile12').show();
	$('#paymentPlugins').hide();
	fetchAdmissionFeeInfo();
				/*$('#newBankChallanPaymentSpan').show();
				$('#newBankChallanPaymentSpan').bcpymt({
					sPC : 'ACADF',
					iFBIDs : bankId,
					bWFH : true,
					bSelf : true,
					sFor : studentId
				});
			*/
		
	
}
function fetchAdmissionFeeInfo(){

	var installmentIds = new Array();
	$('.clsinstallment:checked').each(function(){
		installmentIds.push($(this).attr("installmentid"));
	});
	$.ajax({
		url : 'fetchApplicantAdmissionFeeDetailforstudentsidepayment.json?instituteCourseStrengthId='+ globalSource,
		dataType : 'json',
		data:{installmentIds:installmentIds.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			var BankId=jArray[0]["bankIds0"];
			/*if($('.clsinstallment').is(':checked')){
				storefinalAmount(function(replay){
					BankId=replay;
				});
			}*/
			if (jArray.length > 0) {
				$.ajax({
					url : 'fetchOnlineApplicantAdmissionFeeDetailStatus.json',
					dataType : 'json',
					async : false,
					beforeSend : function() {
						startCommonAjaxSpinner();
					},
					complete : function() {
						stopCommonAjaxSpinner();
					},
					success : function(jArray1) {
						var BankIds='';
						if (jArray1.length > 0) {

							if(jArray1[0]["prePayment"]){
								if (jArray1[1]["hasDetails"]) 
									$('#paymentPluginsDiv').html("Payment has been <b>received</b> with following details - ,<br><b>Reference Id : "+jArray1[1]["transactionReferenceId"]+" <br>Amount : "+jArray1[1]["amount"]+" <br>Date : "+jArray1[1]["date"]+" </b> ");
								else{
									$('#onlinePaymentSpan2').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									if($('#customerHelper').val()=="RCOEM"){

										/*if(eval(jArray[0]["liveAtkt"])>0){
		                                    $('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
		                                }
										else{*/
										/*$('#onlinePaymentSpan1').ucoSPPymt({
												sPC : 'ACADF'
											});*/

										/*$('#onlinePaymentSpan2').pymt({
												sPC : 'ACADF'
											});*/
										if(eval(jArray[0]["liveAtkt"])>0){
		                                    $('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
		                                }
										else{
										  $('#onlinePaymentSpan2').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										  $('#onlinePaymentSpan1').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										}
										//}

									}else if($('#customerHelper').val()=="STJOHNS"){
										$('#onlinePaymentSpan2').ccAvenue10Pymt({
											sPC : 'ACADF',
											iFBIDs:jArray[0]["bankIds0"]
										});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
										$('#newBankChallanPaymentSpan').show();
										//var BankIds='';
										if(BankId!=0){
											BankIds = BankId;
										}
										else{
											BankIds = jArray[0]["bankIds0"];
										}
										$('#newBankChallanPaymentSpan').bcpymt({
											sPC : 'ACADF',
											iFBIDs : BankIds,
											bWFH : true,
											bSelf : true,
											sFor : jArray[0]["studentId0"]
										});
									}else if($('#customerHelper').val()=="ICT_MUMBAI"){
										$('#onlinePaymentSpan2').ccAvenuePymt({
											sPC : 'ACADF',
											iFBIDs:jArray[0]["bankIds0"],
										});
									}
									else if($('#customerHelper').val()=="CHANAKYA"){
										$('#onlinePaymentSpan2').bdpymtV3({
											sPC : 'ACADF'
										});
									}else if($('#customerHelper').val()=="INDIRA_PUNE"){
										$('#onlinePaymentSpan2').junoPymt({
											sPC:'ACADF' , 
											iFBIDs:jArray[0]["bankIds0"],
											sSrc:'INS'
										});
									}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
										$('#onlinePaymentSpan2').ccAvenue4Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
										$('#onlinePaymentSpan2').techProcessPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="RAMAIAH_UNIVERSITY"){
										$('#onlinePaymentSpan2').razorPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES"){
										$('#onlinePaymentSpan2').razor2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
										$('#onlinePaymentSpan2').payTM2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
										$('#onlinePaymentSpan3').razor8Pymt({sPC:'ACADF'});
										$('#onlinePaymentSpan4').easyPayPymt({sPC:'ACADF'});
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
										if(instituteId=='2'){
											$('#onlinePaymentSpan2').sbiEPayPymt({sPC:'ACADF',sSrc:'IIHS',iFBIDs:9});
										}
									}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MANDSAUR"){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="ATAL_MEDICAL" || $('#customerHelper').val()=="SRHU" || $('#customerHelper').val()=="GOKHALE_INSTITUTE" || $('#customerHelper').val()=="MAHINDRA_UNIVERSITY" 
									|| $('#customerHelper').val()=="OXFORD_EDUCATIONAL_INSTITUTIONS"  || $('#customerHelper').val()=="SINGHANIA_UNIVERSITY")){
										$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}
								}

							}else{
								if($('#customerHelper').val()=="RCOEM"){

									/*if(eval(jArray[0]["liveAtkt"])>0){
										$('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
									}
									else{*/
									/*$('#onlinePaymentSpan1').ucoSPPymt({
											sPC : 'ACADF'
										});*/

									/*$('#onlinePaymentSpan2').pymt({
											sPC : 'ACADF'
										});*/
									if(eval(jArray[0]["liveAtkt"])>0){
										$('#paymentPluginsDiv').html('<b>Backlog found you can not perform online payment</b>');
									}
									else{
									 $('#onlinePaymentSpan2').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									}
									// $('#onlinePaymentSpan1').ccAvenuePymt2({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									//}

								}else if($('#customerHelper').val()=="STJOHNS"){
									$('#onlinePaymentSpan2').ccAvenue10Pymt({
										sPC : 'ACADF',
										iFBIDs:jArray[0]["bankIds0"]
									});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
									$('#newBankChallanPaymentSpan').show();
									
									if(BankId!=0){
										BankIds = BankId;
									}
									else{
										BankIds = jArray[0]["bankIds0"];
									}
									$('#newBankChallanPaymentSpan').bcpymt({
										sPC : 'ACADF',
										iFBIDs : BankIds,
										bWFH : true,
										bSelf : true,
										sFor : jArray[0]["studentId0"]
									});
								}else if($('#customerHelper').val()=="ICT_MUMBAI"){
									$('#onlinePaymentSpan2').ccAvenuePymt({
										sPC : 'ACADF',
										iFBIDs:jArray[0]["bankIds0"],
									});
								}
								else if($('#customerHelper').val()=="CHANAKYA"){
									$('#onlinePaymentSpan2').bdpymtV3({
										sPC : 'ACADF'
									});
								}else if($('#customerHelper').val()=="INDIRA_PUNE"){
									$('#onlinePaymentSpan2').junoPymt({
										sPC:'ACADF' , 
										iFBIDs:jArray[0]["bankIds0"],
										sSrc:'INS'
									});
								}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
									$('#onlinePaymentSpan2').ccAvenue4Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
									$('#onlinePaymentSpan2').techProcessPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="RAMAIAH_UNIVERSITY"){
									$('#onlinePaymentSpan2').razorPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES"){
									$('#onlinePaymentSpan2').razor2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
									$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
									$('#onlinePaymentSpan2').payTM2Pymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
									$('#onlinePaymentSpan3').razor8Pymt({sPC:'ACADF'});
									$('#onlinePaymentSpan4').easyPayPymt({sPC:'ACADF'});
								}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MANDSAUR"){
									$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="MAHINDRA_UNIVERSITY"  || $('#customerHelper').val()=="SINGHANIA_UNIVERSITY" || $('#customerHelper').val()=="OXFORD_EDUCATIONAL_INSTITUTIONS")){
									$('#onlinePaymentSpan2').junoPymt({sPC:'ACADF',iFBIDs:jArray[0]["bankIds0"]});
								}
							}
						}
					},
				});

			}
		},
	});
}
function ProccedAcademicToPay1(){   
	
	
	
	if($('#chkAgreeTermsMiscellaneous').is(':checked')){//chkAgreeTermsMiscellaneousoffice
		 
		var boiler = ''+
		'<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpanForMS\').show();$(\'#paymentPluginsStudentFeeDueForMS\').hide();" /><b> Online Payment &nbsp;&nbsp;&nbsp;</b>';
		/*'<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpan2\').show();$(\'#onlinePaymentSpan1\').hide();$(\'#paymentPluginsStudentFeeDue\').hide();" /><b> Online Payment 2 &nbsp;&nbsp;&nbsp;</b>';*/
		if($('#customerHelper').val()!="INDIRA_PUNE" && ($('#customerHelper').val()!="XISS") && ($('#customerHelper').val()!="KURUKSHETRA_UNIVERSITY")){
			 boiler +='<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpanForMS\').hide();$(\'#paymentPluginsStudentFeeDueForMS\').show();" /><b>Bank Challan&nbsp;&nbsp;&nbsp;</b>';
		}
		$('#paymentPluginsDivForMS').html(boiler).show();
		//if($('#customerHelper').val()=="DES"){
			//$('#paymentPluginsDivForMS').html(boiler).hide();
		//}
		
		var studentHostelFineIdArry=new Array();
		var studentHostelFineId=0;
		$('.chkMiscellneousAmtCls:checked').each(function(){
			studentHostelFineId=$(this).attr('miscHostelFineId');
			studentHostelFineIdArry.push(studentHostelFineId);
		});
		
		$.ajax({
			url : 'fetchMiscStudentDetail.json',
			dataType : 'json',
			data:{studentHostelFineIdArry:studentHostelFineIdArry.toString()},
			async : false,
			beforeSend : function() {
				startCommonAjaxSpinner();
			},
			complete : function() {
				stopCommonAjaxSpinner();
			},
			success : function(jArray1) {
				if(jArray1.length>0){

					
					if($('#customerHelper').val()=="RCOEM"){
						/*$('#onlinePaymentSpanForMS2').ucoSPPymt({
							sPC : 'MISCF'
						});
						
						$('#onlinePaymentSpanForMS2').pymt({
							sPC : 'MISCF'
						});*/
						$('#onlinePaymentSpanForMS2').ccAvenuePymt2({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
						
					}else if($('#customerHelper').val()=="STJOHNS"){
						$('#onlinePaymentSpanForMS2').ccAvenue10Pymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"]
						});
					}else if($('#customerHelper').val()=="ICT_MUMBAI"){
						$('#onlinePaymentSpanForMS2').ccAvenuePymt({
							sPC : 'MISCF',
							iFBIDs:jArray1[0]["bankIds0"],
						});
					}else if($('#customerHelper').val()=="DES"){
						$('#onlinePaymentSpanForMS2').payUPymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"],
						});
					}else if($('#customerHelper').val()=="INDIRA_PUNE"){
						$('#onlinePaymentSpanForMS2').junoPymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"],
						});
					}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
						$('#onlinePaymentSpanForMS2').ccAvenue4Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
						$('#onlinePaymentSpanForMS2').techProcessPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
						$('#onlinePaymentSpanForMS2').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="RAMAIAH_UNIVERSITY"){
						$('#onlinePaymentSpanForMS2').razorPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES"){
						$('#onlinePaymentSpanForMS2').razor2Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
						$('#onlinePaymentSpanForMS2').payTM2Pymt({sPC:'MISCF',iFBIDs:jArray[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="GC_UNIVERSITY"){
						$('#onlinePaymentSpanForMS2').bdpymtV6({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DYPATIL"){
                        $('#onlinePaymentSpanForMS2').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
			    					$('#onlinePaymentSpanForMS2').ccAvenue7Pymt({
			    						sPC:'MISCF',
			    						iFBIDs:jArray1[0]["bankIds0"]
			    					});
									$('#onlinePaymentSpanForMS5').bdpymtV4({
												sPC:'MISCF' , 
												sSrc:'INS'
											});
			    	}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
										var instituteId= $('#txtInstituteId').val();
										if(instituteId=='1'){
											$('#onlinePaymentSpanForMS2').sbiEPayPymt({sPC:'MISCF',sSrc:'UTD',iFBIDs:5});
											$('#onlinePaymentSpanForMS5').easyPay3Pymt({sPC:'MISCF',iFBIDs:7});
											$('#onlinePaymentSpanForMS6').easyPay2Pymt({sPC:'MISCF',iFBIDs:4});
										}
										if(instituteId=='2'){
											$('#onlinePaymentSpanForMS2').sbiEPayPymt({sPC:'MISCF',sSrc:'IIHS',iFBIDs:9});
										}
										if(instituteId=='3'){
											$('#onlinePaymentSpanForMS2').sbiEPayPymt({sPC:'MISCF',sSrc:'UIET',iFBIDs:13});
											$('#onlinePaymentSpanForMS5').easyPay3Pymt({sPC:'MISCF',iFBIDs:16});
											$('#onlinePaymentSpanForMS6').easyPay2Pymt({sPC:'MISCF',iFBIDs:15});
								}
					}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="CMR_UNIVERSITY" || $('#customerHelper').val()=="CMR_IT")){
                        $('#onlinePaymentSpanForMS2').razor10Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="SRHU" || $('#customerHelper').val()=="GOKHALE_INSTITUTE" || $('#customerHelper').val()=="MAHINDRA_UNIVERSITY" || $('#customerHelper').val()=="OXFORD_EDUCATIONAL_INSTITUTIONS" || $('#customerHelper').val()=="HPNLU")){
                        $('#onlinePaymentSpanForMS2').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="MANDSAUR")){
                        $('#onlinePaymentSpanForMS2').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }
				}
			},
		});
		
		
	}else{
		$('#paymentPluginsDivForMS').hide();
		$('#onlinePaymentSpanForMS').hide();
		$('#paymentPluginsStudentFeeDueForMS').hide();
	}
	
	

	

	
	
}
function ProccedAcademicToPay2(){   
	
	
	
	if($('#chkAgreeTermsMiscellaneousoffice').is(':checked')){
		 
		var boiler = ''+
		'<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpanForMSoffice\').show();$(\'#paymentPluginsStudentFeeDueForMSoffice\').hide();" /><b> Online Payment &nbsp;&nbsp;&nbsp;</b>';
		/*'<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpan2\').show();$(\'#onlinePaymentSpan1\').hide();$(\'#paymentPluginsStudentFeeDue\').hide();" /><b> Online Payment 2 &nbsp;&nbsp;&nbsp;</b>';*/
		if(($('#customerHelper').val()!="INDIRA_PUNE") && ($('#customerHelper').val()!="DES") && ($('#customerHelper').val()!="XISS")){
			boiler +='<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpanForMS\').hide();$(\'#paymentPluginsStudentFeeDueForMS\').show();" /><b>Bank Challan&nbsp;&nbsp;&nbsp;</b>';
		}
		$('#paymentPluginsDivForMSoffice').html(boiler).show();
		//if($('#customerHelper').val()=="DES"){
			//$('#paymentPluginsDivForMS').html(boiler).hide();
		//}
		
		var studentHostelFineIdArry=new Array();
		var studentHostelFineId=0;
		$('.chkAmountOffDocCls:checked').each(function(){
			studentHostelFineId=$(this).attr('miscHostelFineId');
			studentHostelFineIdArry.push(studentHostelFineId);
		});
		
		$.ajax({
			url : 'fetchMiscStudentDetail.json',
			dataType : 'json',
			data:{studentHostelFineIdArry:studentHostelFineIdArry.toString()},
			async : false,
			beforeSend : function() {
				startCommonAjaxSpinner();
			},
			complete : function() {
				stopCommonAjaxSpinner();
			},
			success : function(jArray1) {
				if(jArray1.length>0){

					
					if($('#customerHelper').val()=="RCOEM"){
						/*$('#onlinePaymentSpanForMS2').ucoSPPymt({
							sPC : 'MISCF'
						});
						
						$('#onlinePaymentSpanForMS2').pymt({
							sPC : 'MISCF'
						});*/
						$('#onlinePaymentSpanForMS2office').ccAvenuePymt2({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
						
					}else if($('#customerHelper').val()=="STJOHNS"){
						$('#onlinePaymentSpanForMS2office').ccAvenue10Pymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"]
						});
					}else if($('#customerHelper').val()=="ICT_MUMBAI"){
						$('#onlinePaymentSpanForMS2office').ccAvenuePymt({
							sPC : 'MISCF',
							iFBIDs:jArray1[0]["bankIds0"],
						});
					}else if($('#customerHelper').val()=="DES"){
						$('#onlinePaymentSpanForMS2office').ccAvenue6Pymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"],
						});
					}else if($('#customerHelper').val()=="INDIRA_PUNE"){
						$('#onlinePaymentSpanForMS2office').junoPymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"],
						});
					}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
						$('#onlinePaymentSpanForMS2office').ccAvenue4Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
						$('#onlinePaymentSpanForMS2office').techProcessPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}
					else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
						$('#onlinePaymentSpanForMS2office').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
						$('#onlinePaymentSpanForMS2office').payTM2Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="GC_UNIVERSITY"){
						$('#onlinePaymentSpanForMS2office').bdpymtV6({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="SIES"){
						$('#onlinePaymentSpanForMS2office').razor2Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DYPATIL"){
                        $('#onlinePaymentSpanForMS2office').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
			    					$('#onlinePaymentSpanForMS2office').ccAvenue7Pymt({
			    						sPC:'MISCF',
			    						iFBIDs:jArray1[0]["bankIds0"]
			    					});
									$('#onlinePaymentSpanForMS2office4').bdpymtV4({
												sPC:'MISCF' , 
												sSrc:'INS'
									});
			    	}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="CMR_UNIVERSITY" || $('#customerHelper').val()=="CMR_IT")){
                        $('#onlinePaymentSpanForMS2office').razor10Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="SRHU" || $('#customerHelper').val()=="GOKHALE_INSTITUTE" || $('#customerHelper').val()=="MAHINDRA_UNIVERSITY" || $('#customerHelper').val()=="OXFORD_EDUCATIONAL_INSTITUTIONS" || $('#customerHelper').val()=="HPNLU")){
                        $('#onlinePaymentSpanForMS2office').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="MANDSAUR")){
                        $('#onlinePaymentSpanForMS2office').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="MEGHE")){
                        $('#onlinePaymentSpanForMS2office').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
                    }
                    
				
				}
			},
		});
		
		
	}else{
		$('#paymentPluginsDivForMSoffice').hide();
		$('#onlinePaymentSpanForMS').hide();
		$('#paymentPluginsStudentFeeDueForMS').hide();
	}
	
}
function storefinalAmountforHostel(callback){
	var installmentIds = new Array();
    $('.clsinstallmentforHostel:checked').each(function(){
    	installmentIds.push($(this).attr("installmentid"));
    });
	var PaymentAmmount=$('#amtForHostelPayment').html();
	if(eval(PaymentAmmount)>0 && PaymentAmmount!=undefined)
	$.ajax({
		url : 'setpableAmountinSessiontoPayforHostel.json?PaymentAmmount='+ PaymentAmmount,
		dataType : 'text',
		data:{installmentIds:installmentIds.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(replay) {
			callback(replay);
		},
	});

}



function ProccedHstelFeeToPay(amounts){
	
	var bankIds=0;
	
	if($('#chkAgreeHostelTerms').is(':checked')){
		storefinalAmountforHostel(function(replay){
			bankIds=replay;
		});
	}
	if($('#chkAgreeHostelTerms').is(':checked')){
		if(bankIds!=null && bankIds!=undefined && bankIds!=''){
			if($('#chkAgreeHostelTerms').is(':checked')){
				$('#paymentPluginsStudentFeeDueHostel').show();
				$('#paymentPluginsStudentFeeDueHostel2').show();
				if($('#customerHelper').val()=="RCOEM"){
					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt2({sPC:'HOSTF',iFBIDs:bankIds});
					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt2({sPC:'HOSTF',iFBIDs:bankIds});
					//}

				}else if($('#customerHelper').val()=="STJOHNS"){
					$('#paymentPluginsStudentFeeDueHostel').ccAvenue10Pymt({
						sPC : 'HOSTF',
						iFBIDs:bankIds
					});
				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
					$('#paymentPluginsStudentFeeDueHostel').payUPymt({
						sPC : 'HOSTF',
						iFBIDs :bankIds,
						bR:false,
					});
				}else if($('#customerHelper').val()=="ICT_MUMBAI"){
					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt({
						sPC : 'HOSTF',
						iFBIDs:bankIds,
					});
				}
				else if($('#customerHelper').val()=="CHANAKYA"){
					$('#paymentPluginsStudentFeeDueHostel').bdpymtV3({
						sPC : 'HOSTF'
					});
				}else if($('#customerHelper').val()=="INDIRA_PUNE"){
					$('#paymentPluginsStudentFeeDueHostel').junoPymt({
						sPC:'HOSTF' , 
						iFBIDs:bankIds,
						sSrc:'INS'
					});
				}
				else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
					$('#paymentPluginsStudentFeeDueHostel').ccAvenue4Pymt({sPC:'HOSTF',iFBIDs:bankIds});
				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
					$('#paymentPluginsStudentFeeDueHostel').techProcessPymt({sPC:'HOSTF',iFBIDs:bankIds});
				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
					$('#paymentPluginsStudentFeeDueHostel').ccAvenue7Pymt({
						sPC:'HOSTF',
						iFBIDs:bankIds
					});
				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="HPTELIBRARY"){
					$('#paymentPluginsStudentFeeDueHostel').ccAvenue8Pymt({sPC:'HOSTF',iFBIDs:bankIds});
				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
					$('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
				}
			}else
				$('#paymentPluginsStudentFeeDueHostel').hide();
		}else{
			jAlert('Some bank configuration missing please contacts with Finance Admin');
			return false;
		}
	}

}

/*function amountToCheck(elem){
	//alert('sdsfsfs');
	var amount = $(elem).val();
	var amtForOnlinePayment =$(elem).attr('label');
	//alert(amtForOnlinePayment);
	//alert(amount);
	if(amount > amtForOnlinePayment){
		jAlert('You have exceed payable amount Rs.'+amtForOnlinePayment+' please enter below or same amount to procced ','',function(r){
			if(r){
				$(elem).val(amtForOnlinePayment);	
				$('#txtTxnAmount').val(amtForOnlinePayment);	
			}
		});
	}else{
		$('#txtTxnAmount').val(amtForOnlinePayment);
	}
}*/
function showAdmissionCancellationForm(studentId,instituteCourseStrengthId,callback){
	$.ajax({
		url:'checkForAdmissionCancellationCancellation.json',
		dataType:'json',
		data:'studentId='+studentId,
		beforeSend:function(){
			startCommonAjaxSpinner();
		},
		complete:function(){
			stopCommonAjaxSpinner();
		},
		success:function(jObject){
			/****************Admission not cancelled state********************/
			if(jObject.responseFlag == 0){
				//alert('In if');
				$('#divStudentInformation').find('.btn-admissionCancel').show();
				$('#divStudentInformation').find('.btn-generateVoucher').hide();
				$('#divStudentInformation').find('.btn-admissionCancel').unbind();
				$('#divStudentInformation').find('.btn-admissionCancel').bind('click',function(){
					proceedToStudentAdmissionCancellation(studentId,instituteCourseStrengthId);
				});
			} else if(jObject.responseFlag == 1){
				//alert('In else');
				/****************Admission-cancelled state********************/
				/**
				 * binding event for showing the generatd voucher
				 */
				$('#divStudentInformation').find('.btn-generateVoucher').attr('value','Undo Cancel Request');
				$('#divStudentInformation').find('.btn-generateVoucher').removeAttr('disabled');
				$('#divStudentInformation').find('.btn-admissionCancel').hide();
				$('#divStudentInformation').find('.btn-generateVoucher').show();
				$('#divStudentInformation').find('.btn-generateVoucher').unbind();
				$('#divStudentInformation').find('.btn-generateVoucher').bind('click',function(){
					//checkForVoucherGenerationOfAdmissionCancellation(jObject.studentCancellationDetailObj.studentCancellationDetailId,function(expenseVoucherObj){
					//if(!expenseVoucherObj.isGenerated){
					undoAdmissionCancellationRequest(jObject.studentCancellationDetailObj.studentCancellationDetailId,function(jObject){
						$('#divStudentInformation').find('.btn-admissionCancel').show();
						$('#divStudentInformation').find('.btn-generateVoucher').hide();
					});
					//} else {
					//	showAdmissionCancelGeneratedVoucherDialog(expenseVoucherObj);
					//}
					//});
				});
			} else {
				$('#divStudentInformation').find('.btn-generateVoucher').attr('disabled','disabled');
				$('#divStudentInformation').find('.btn-admissionCancel').hide();
				$('#divStudentInformation').find('.btn-generateVoucher').show();
				$('#divStudentInformation').find('.btn-generateVoucher').attr('value','Admission Cancelled');
			}
		}
	});
}


function getStudentHostelFeeDueReportTotalFeeStructureWiseByStudentBatchId(src){
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
$('#feesDetails').removeClass('in collapse');
$('#feesDetails').addClass('collapse');
$('#financialDetails').find('a').removeClass('collapsed');
$('#feesDetails').css("height", "0px");

$('#divStudentInformation').html('');
$('#divStudentInformationonlineFee').html('');
$('#divStudentInformationbankChallanFee').html('');
$('#studentInstallMent').html('');
$('#parpayment').html('');
$('#paymentDetails').html('');
$('#newBankChallanPaymentSpan').html('');

//	var studentId = $('#studentId').val();
	var studentId =0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	/*$.ajax({
		url:'getStudentHostelFeeDueReportTotalFeeStructureWiseByStudentId.json',
		data:'studentId='+studentId,
		dataType:'json',
		beforeSend: function() {
			//startCommonAjaxSpinner();
		},
		complete: function() {
		//	stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray=="HostelDetailNotFound")
				$('#divStudentInformationHostel').html('<div class="alert alert-error"><strong>Sorry!! No Hostel Details found.</strong></div>');

			if(jArray.length == 2){
				showHostelStudentOverallFeeDueReportForInvoiceByStudentBatchId(jArray);
			}
		}
	});*/
	var hdAuth = $('#hdAuth').val();
	var url = 'getStudentHostelFeeStructureDetailbyStudentId.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_getStudentHostelFeeStructureDetailbyStudentId.json';
	}
	$.ajax({
		url:url, 
		dataType:'json',
		junoSpinner:true,
		success:function(jArrayMain){
			showStudentHostelFeeDetails(jArrayMain);
		}
	});
}

function showHostelStudentOverallFeeDueReportForInvoiceByStudentBatchId(jArray){

	var feeStructureJArray = jArray[0];
	var studentListJsonArray = jArray[1];

	//var legacyObject = jArray[2];
	var boiler = '';
	//var exceptionalCase = false;
	/** Showing student information */
	//alert(studentListJsonArray.length);
	$('.studentFeeInviceListDetail').show();
	var occupantId = '';
	var studentId = '';
	occupantId = 0;
	globalSource = 0;
	if(studentListJsonArray.length > 0){
		tempId ='';
		occupantId = studentListJsonArray[0].occupantId;
		studentId = studentListJsonArray[0].student;
		globalSource = occupantId;
		var studentName = '<strong>'+studentListJsonArray[0].name+'</strong>';
		var courseName  = studentListJsonArray[0].coourseName!=undefined?studentListJsonArray[0].coourseName:"";
		var courseYearName  = studentListJsonArray[0].courseYearName!=undefined?studentListJsonArray[0].courseYearName:"";
		var bankIdHos = studentListJsonArray[0].bankId;
		//alert(bankIdHos);
		var hostelName  = studentListJsonArray[0].hostelName!=undefined?studentListJsonArray[0].hostelName:"Not-Allocated";
		//exceptionalCase = studentListJsonArray[0].exceptionalCase;
		var floorName = studentListJsonArray[0].floorName!=undefined?studentListJsonArray[0].floorName:"Not-Allocated";
		var roomName = studentListJsonArray[0].roomName!=undefined?studentListJsonArray[0].roomName:"Not-Allocated";
		var roomType = studentListJsonArray[0].infraTypeName!= undefined?studentListJsonArray[0].infraTypeName:"Not-Allocated";
		boiler += 

			'<table class="table table-condensed table-bordered studentPersonalInformation tablePrint">'+
			'<tr>'+
			'<td rowspan="5" width="120px"><div class = "thumbnail studentProfileImage"></div></td>'+
			'<th style="text-align:left">Name</th><td>'+decodeURIComponent(studentName)+'</td>'+
			'<th style="text-align:left">Dept / Year</th><td>'+courseName+' / '+courseYearName+'</td>'+
			'<td style = "display:none;" class="occupantId">'+occupantId+'</td>'+
			'<td style = "display:none;" class="instituteCourseStrengthId"></td>'+
			'</tr>'+
			'<tr>'+
			'<th style="text-align:left">Hostel&nbsp;&nbsp;/&nbsp;&nbsp;Floor&nbsp;&nbsp;/&nbsp;&nbsp;Room</th><td>'+
			hostelName+'&nbsp;&nbsp;/&nbsp;&nbsp;'+floorName+'&nbsp;&nbsp;/&nbsp;&nbsp;'+roomName+
			'</td>'+
			'<th style="text-align:left">Room Type</th><td class="studentRoomType">'+roomType+'</td>'+
			'</tr>'+

			/*'<tr>'+
	    	'<td colspan="5" style="text-align:right;">'+
	    		'<input type="button" class="btn btn-mini btn-inverse btn-cancelOccupant" value="Hostel Admission Cancellation">&nbsp;&nbsp;'+
	    	'</td>'+
	    '</tr>'+*/

			'</table><hr style="padding:0px;margin-bottom:5px">'+

			/*'<span><b>Rules and Regulation</b></span>'+
			'<ul>'+
			'<li>The bill payment service will be unavailable from 11:40 pm to 3:15 am daily.</li>'+
			'<li>To avoid fradulent transaction, it is recommended not to reveal details of your card to anybody; make payment yourself without going through any channels/agents.</li>'+
			'<li>Do not open multiple payment windows simultaneously. For multiple consumer numbers, make payments one at a time.</li></ul>'+
			'<b>To Procced with payement please verify the details below chosing you payment option</b>';*/

			$('#divStudentInformationHostel').html(boiler);
		$('.studentProfileImage').html('<img src="getStudentProfileImageById.json?id='+studentId+'&type=profile" class = "img-polaroid" height = "100px" width = "100px" alt = "No image">');

		$('.btn-cancelOccupant').click(function(){
			configureStudentCancelationDetail(jArray);
		});


		//showAdmissionCancellationForm(studentListJsonArray[0].studentId,studentListJsonArray[0].instituteCourseStrengthId);
	} else {
		$('#divStudentInformationHostel').html('<div class="alert alert-error"><strong>Sorry!! No Student found found</strong></div>');
	}
	/** Student Fee Structure Details */

	$('#divStudentFeeDueInformationHostel').html('');
	if(feeStructureJArray.length > 0){
		var boiler =  '';
		for(var i = 0 ; i < feeStructureJArray.length ; i++){

			tempId = 'trFeeStructureId-'+feeStructureJArray[i].feeItemId+''+occupantId;
			var isCurrent =	feeStructureJArray[i].isCurrent;
			if(isCurrent){
				boiler = '<div id="trFeeStructureId-'+feeStructureJArray[i].feeItemId+''+occupantId+'" class="well" style="padding:2px">'+
				'<div class="alert alert-info" style="padding:2px"><STRONG class="feeStructureName">'+feeStructureJArray[i].feeStructureName+'('+feeStructureJArray[i].fromDate+' - '+feeStructureJArray[i].toDate+')</STRONG>'+
				'<span style="float:right;color:#;font-weight:bold;font-family:sans-serif">[CURRENT]</span>'+
				'</div>'+
				'<table class="table table-bordered table-condensed tablePrint"  style="margin-top:-14px">';
				/*if(studentListJsonArray.length > 0){
					boiler += '<tr><th colspan="2"><input type="button" style="float:right" class="btn btn-inverse btn-mini" value="Generate / View Invoice" id = "btnGenerateInvoice" onclick="redirectToInvoiceFunctionForHostel(\'trFeeStructureId-'+feeStructureJArray[i].feeItemId+''+occupantId+'\')"></th></tr>';
				}*/
				//'<tr><th >Name</th><td class="feeStructureName"><STRONG>'+feeStructureJArray[i].feeStructureName+'('+feeStructureJArray[i].fromYear+' - '+feeStructureJArray[i].toYear+')</STRONG></td>';
				boiler +=  
					'<tr><th width="50%" style="text-align:left">A.&nbsp;&nbsp;Total Fees (Receivable) (in Rs.)</th><td style="text-align:right" class="totPayableAmt">-</td></tr>'+
					'<tr><th width="50%" style="text-align:left">B.&nbsp;&nbsp; Paid Amount till date (in Rs.)</th><td style="text-align:right" class="paid">-</td></tr>'+
					'<tr><th width="50%" style="text-align:left">C.&nbsp;&nbsp;'+juno.labelByCustomer('l.StudentReceivable')+' [A-B] (in Rs.)</th><td style="text-align:right" class="fromStudentRecievable">-</td></tr>'+
					/*'<tr><th width="50%" style="text-align:left">D.&nbsp;&nbsp;Previous Outstanding (in Rs.)</th><td style="text-align:right" class="previousOutstading">-</td></tr>'+
				'<tr><th width="50%" style="text-align:left">E.&nbsp;&nbsp;To Student Payable (in Rs.)</th><td style="text-align:right" class="toStudentPayable">-</td></tr>'+*/
					'<tr><th width="50%" style="text-align:left">D.&nbsp;&nbsp;'+juno.labelByCustomer('l.isInvoceToFeesLabel')+' Status</th><th style="text-align:center" class="Invoicestatus">-</th></tr>'+
					'<tr><th width="50%" style="text-align:left">E.&nbsp;&nbsp;Fee Deposit Status</th><th style="text-align:center" class="feePaymentStatus">-</th></tr>'+
					'<table>';

				studentBillingInfoHostel(feeStructureJArray[i].studentBillingInfo, function(billingInfo){
					boiler +=  billingInfo;
				});
				boiler +=  	'<div align="center"><a href="javascript:void(0)" class="btn btn-mini nonPrintable" onclick="printStudentHostelDetails()"><i class="icon icon-print"></i>&nbsp;Print</a> </div>'+
				'</div>';				
			}
			$('#divStudentFeeDueInformationHostel').append(boiler);
			$('#trFeeStructureId-'+feeStructureJArray[i].feeItemId+''+occupantId).data('feeStructureObject',feeStructureJArray[i]);
		}

		
		
		var jArray1=jArray[1][0]['InstallmentList'];
		var InstallmentIds='';
		var amounts=0.0;
		//if(jArray1["installment"]=="YES"){
			$('#studentInstallMent').html('');
			var  boiler1='<div class="label label-info" style="text-align:center">Installment Details</div><br><table class="table table-bordered table-condensed tablePrint"  style="margin-top:-14px">'+
			'<tr><th></th><th>Installment No</th><th>Installment Date</th><th class="gems_currency_label">Installment Amount</th><th>Receipt Number</th>'+//<th class="gems_currency_label">Student Payble Amount</th>
			'</tr>';
			if(jArray1.length>0){
				for(var i = 0 ; i < jArray1.length ; i++){
					boiler1+='<tr>';
					if(i == 0)
						boiler1+='<td><input type="checkbox" class="clsinstallmentforHostel clsinstallmentind" installmentid="'+jArray1[i]["installmentid"]+'" value="'+eval(eval(jArray1[i]["installmentAmount"])+eval(jArray1[i]["ChargesAmount"]))+'" onclick="selectamounts();"></td>';
					else{
						boiler1+='<td></td>';
					}
					InstallmentIds+=jArray1[i]["installmentid"]+','
					amounts+=eval(eval(jArray1[i]["installmentAmount"])+eval(jArray1[i]["ChargesAmount"]));
					var amountaa=eval(eval(jArray1[i]["installmentAmount"])+eval(jArray1[i]["ChargesAmount"]));
					
					boiler1+='<td class="gems_integer">'+jArray1[i]["installmentNo"]+'</td>'+
					'<td>'+jArray1[i]["installmentDate"]+'</td>'+
					'<td class="gems_currency" style="text-align:right">'+jArray1[i]["installmentAmount"]+'</td>'+
					'<td class="gems_currency" style="text-align:right">'+jArray1[i]["recieptNo"]+'</td>'+
					//'<td class="gems_currency" style="text-align:right">'+amountaa+'</td>'+
					'</tr>';
					$('#studentInstallMent').html(boiler1);
				}
			}
		//}
		$('#divStudentFeeDueInformationHostel').append(boiler1);
		
		var varible='';
		if($('#customerHelper').val()=="RCOEM")
			varible ='';
		else
			varible ='/Bank Challan';
		
		boiler ='<br><br><b><input type="checkbox" id="chkAgreeHostelTerms" onclick="ProccedHstelFeeToPay('+amounts+')">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b> '+
		'<span> You have chosen to pay an amount <b>Rs.</b> <span id="amtForHostelPayment" orgvalue="'+amounts+'" ></span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
		'<span style="font-weight:bold;color:red">*If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>'+
		/*'<br><span class="pull-right"><a href="javascript:void(0)" onclick="ProccedHstelFeeToPay()" class="btn btn-success" ><i class="icon icon-forward icon-white"></i>&nbsp;&nbsp;Pay Now</a></span><br>';*/
		/*'<span id="paymentPlugins"></span>';*/
		'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueHostel"></span><br>';
		
		if($('#customerHelper').val()=="RCOEM")
			$('#divStudentFeeDueInformationHostel').append('');
		else
			$('#divStudentFeeDueInformationHostel').append(boiler);
		
	} else {
		$('#divStudentFeeDueInformationHostel').html('<div class="alert alert-error"><strong>Sorry!! No Fee structure found</strong></div>');
	}
	var totalPaidAmounts = 0;
	if(studentListJsonArray.length > 0){
		var feeInvoiceObjectArray = 	studentListJsonArray[0].feeStructureIdList;
		for(var j = 0; j < feeInvoiceObjectArray.length ; j++){
			//var isCurrent =			feeInvoiceObjectArray[j].isCurrent;
			var feeStructureId=			feeInvoiceObjectArray[j].feeStructureId;
			var studentFeeInvoiceId=	feeInvoiceObjectArray[j].studentFeeInvoiceId;
			var invoicestatus=			feeInvoiceObjectArray[j].invoicestatus;
			var feePaymentStatus=		feeInvoiceObjectArray[j].feePaymentStatus;
			var totPayableAmt=			feeInvoiceObjectArray[j].totalPayableAmount;
			var paid=					feeInvoiceObjectArray[j].paidAmount;
			var fromStudentRecievable=	feeInvoiceObjectArray[j].fromStudentRecievable;
			var toStudentPayable=		feeInvoiceObjectArray[j].toStudentPayable;
			//alert(invoicestatus);
			totalPaidAmounts+=eval(fromStudentRecievable);
			//if(isCurrent){
			$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.totPayableAmt').text(totPayableAmt);
			$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.paid').text(paid);
			$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.fromStudentRecievable').text(fromStudentRecievable);
			$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.toStudentPayable').text(toStudentPayable);
			$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.Invoicestatus').text(invoicestatus);
			$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.feePaymentStatus').text(feePaymentStatus);
			//	$('#trFeeStructureId-'+feeStructureId+''+occupantId).find('.previousOutstading').text(legacyAmount);


		}
	}
	$('#amtForHostelPayment').html(totalPaidAmounts);
	$('#amtForHostelPayment').attr('orgvalue',totalPaidAmounts);

	$(document).ready( function() {
		//alert("aasdfe asdf  "+bankIdHos);
		$('#paymentPluginsStudentFeeDueHostel').bcpymt({sPC:'HOSTF',bWFH:false,iFBIDs:bankIdHos});

	});
	/*$(document).ready( function() {
	    $('#paymentPlugins').pymt({sPC:'TESTF'});
	});*/


	
}

function ShowOrHideHostelFeesDetails(){
	var studentId= 0;
	if($('#studentId123').val()!=null && $('#studentId123').val()!='undefined'){
		studentId= $('#studentId123').val();
	}else{
		studentId= 0;
	}
	var hdAuth = $('#hdAuth').val();
	var url = 'getcheckschoolorCollageflag.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_getcheckschoolorCollageflag.json';
	}
	$.ajax({
		url:url,
		//	data:'',
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray[0].flagList.flag){
				$('#HostelDetails').hide();
			}
		}
	});
}
function studentBillingInfo(feeInvoiceId) {
	var hdAuth = $('#hdAuth').val();
	var url = 'getStudentBillingInformation.json';
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_getStudentBillingInformation.json';
	}
	$.ajax({
		url:url,
		data:'feeInvoiceId='+feeInvoiceId,
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray != null){
				var length = jArray.length;
				var paidAmount = 0.0;
				if (jArray.length > 0) {
					var studentBillingDetails = '<div class="accordion" id="divStudentBillingDetailAccordian" style="width:100%">';
					for ( var i = 0; i < length; i++) {
						paidAmount += parseFloat(jArray[i].amount);
						var desc = jArray[i].desc;
						studentBillingDetails += '<div class="accordion-group">'+
						'<div class="accordion-heading">'+
						'<a class="accordion-toggle" data-toggle="collapse" data-parent="#divStudentBillingDetailAccordian" href="#studentBilling'+jArray[i].studentInvoiceId+''+i+'" style = "color:#000000">'+(i+1)+
						'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bill No.:&nbsp;&nbsp;'+jArray[i].billNo+'&nbsp;&nbsp;&nbsp;Received on:'+jArray[i].timestamp+ '&nbsp;&nbsp;&nbsp; Amount(in Rs.): '+
						formatAmount(jArray[i].amount)+'<span class="pull-right"><b style="color:red;font-size:12px;" >Click Here To View Receipt</b></span></a></div>'+
						'<div id="studentBilling'+jArray[i].studentInvoiceId+''+i+'" class="accordion-body collapse" style="background-color: #F7F7F7;">'+
						'<table class = "table table-condensed">'+
						'<tr><th colspan="6" style="text-align:center">RECEIPT';
						/*if ((jArray[i].billDate).toString() == (jArray[i].currentDate).toString() || jArray[i].EditDeleteFlag) {
							studentBillingDetails += '<span style="float:right">';
							//studentBillingDetails += '<input type="button" value="Reverse Entry" class="btn btn-inverse btn-mini" onclick="reversePaymentDetail(\''+ jArray[i].studentBillId + '\')">&nbsp;&nbsp;';
							if ($('#hdnUserRole').val() == "financeadmin" && jArray[i]["paymentDetails"][0] != null && jArray[i]["paymentDetails"][0] != undefined
									&& jArray[i]["paymentDetails"][0]["modeOfPayment"] != 'BankChallan')
								studentBillingDetails += '<input type="button" value="Edit" class="btn btn-inverse btn-mini" onclick="editPaymentDetail(\''+jArray[i].studentBillId + '\')">&nbsp;&nbsp;';
							studentBillingDetails += '<a onclick="deleteStudentBillDetail(\''+ jArray[i].studentBillId+ '\')" class="" href="javascript:void(0)" title="Delete Receipt"><i class="icon-trash"></i></a></span>';
						}*/
						studentBillingDetails += '</th></tr>' +
						'<tr><td><label>Bill No:</label>' + '</td>' + '<td id="tdBillNo"'+i+'>'+jArray[i].billNo+'</td>'+
						'<td><label>Amount(in  <span class="WebRupee">Rs.</span>)</label></td>'+
						'<td id="tdAmount'+i+'">'+formatRupee(parseFloat(Math.round(jArray[i].amount).toFixed(2)))+'</td>'+
						'<td><label>Barcode</label></td>'+
						'<td id="tdBarCode'+i+'"><span style = "float:right" id="tdFeeInvoiceBillBarcodeNo'+i+'"></span></td></tr>'+
						'<tr><td colspan="6">';
						if (desc != undefined)
							studentBillingDetails += '<div style="display:block"><strong>Desc/Remark</strong>&nbsp;&nbsp;&nbsp;'+jArray[i].desc+'</div>';

						studentBillingDetails += '<table class="table table-condensed table-bordered" id="showPaymentDetailTLB'+jArray[i].studentBillId+'">'+
						'<tr><th colspan="6" style="text-align:left">Cash/DD/Cheque Details</th></tr>'+
						'<tr><td style="text-align:center">Amount</td>'+
						'<td style="text-align:center">Payment Mode</td>'+
						'<td style="text-align:center">Chq/DD/Challan No.</td>'+
						'<td style="text-align:center">Bank Name</td>'+
						'<td style="text-align:center">Branch</td>'+
						'<td style="text-align:center"></td></tr>';

						var paymentDetails = jArray[i].paymentDetails;
						for ( var j = 0; j < paymentDetails.length; j++) {
							var studentBillChequeDetailId = paymentDetails[j].studentBillChequeDetailId;
							var paymentMode = "";
							if (paymentDetails[j].modeOfPayment == 'Cheque')
								paymentMode = "Challan";
							else
								paymentMode = paymentDetails[j].modeOfPayment;
							var bankName = paymentDetails[j].modeOfPayment.toString().toLowerCase() != "cash" ? paymentDetails[j].bankName: "N/A";
							var bankBranch = paymentDetails[j].modeOfPayment.toString().toLowerCase() != "cash" ? paymentDetails[j].bankBranch: "N/A";
							var amt = parseFloat(paymentDetails[j].amount).toFixed(2);
							var chequeDDNo = paymentDetails[j].chequeDDNo;
							var chequeDDDate = paymentDetails[j].chequeDDDate;

							if (paymentDetails[j].chequeBouns == "ChequeBounced")
								studentBillingDetails += '<tr class="alert alert-error">';
							else
								studentBillingDetails += '<tr>';

							studentBillingDetails += '<td id="tdBillPaymentMode'+j+'" style="text-align:right"><strong>'+formatAmount(amt)+'</strong></td>'+
							'<td id="tdBillPaymentMode'+j+'" style="text-align:left">'+paymentMode+'</td>'+
							'<td id="tdchequeD'+j+'" class="ChequeDDDate1" style="text-align:center">'+chequeDDNo+'('+chequeDDDate+')</td>'+
							'<td id="tdBankName'+j+'" style="text-align:center">'+bankName+'</td>'+
							'<td id="tdbankBranch'+j+'" style="text-align:center">'+bankBranch+'</td>'+
							'<td>';
						
							studentBillingDetails += '</td></tr>';
						}
						studentBillingDetails += '</table>'+
						'</td></tr>';

						var billPayableReceivable = parseFloat(jArray[i].studentFeeRecievable);
						if (billPayableReceivable >= 0) {
							studentBillingDetails += '<tr><td colspan="6" align="center"><span style="font-size:12px;font-weight: bold;text-align:center">Student Fees Receivable '
								+ formatRupee(parseFloat(billPayableReceivable.toFixed(2))) + '</span>';
						} else {
							billPayableReceivable = -(billPayableReceivable);
							studentBillingDetails += '<tr><td colspan="6" align="center"><span style="font-size:12px;font-weight: bold;text-align:center">Student Fees Payable '
								+ formatRupee(parseFloat(billPayableReceivable.toFixed(2))) + '</span>';
						}

						studentBillingDetails += '</td></tr></table>'+
						'<div id = "feeBillPrintPreviewBtn">'+
						'<table class="table table-bordered"><tr><th>Print Receipt</th>';
						if($('#customerHelper').val()=="IMT_GAZIABAD"){
							studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printAdmissionReceiptStudent('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Hard Copy)</div></td></tr></table>';
						}else if($('#customerHelper').val()=="BLM_MUNJAL"){
							studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceiptHorizontal('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Horizontal)</div></td></tr></table></div>';
						}else if($('#customerHelper').val()=="HPNLU"){
							studentBillingDetails +='<td colspan="2"><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceiptHorizontal('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Hard Copy)</div></td></tr></table>';
						}else{
							if(jArray[i].studSideBillPatVertical!="")
								studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="window.open(\''+ jArray[i].studSideBillPatVertical+'\')">Institute Admission Fees Receipt Print(Vertical)</div></td>'
							else
								studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceipt('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Vertical)</div></td>'
							if(jArray[i].studSideBillPathorizantal!="")
								studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="window.open(\''+ jArray[i].studSideBillPathorizantal+'\')">Institute Admission Fees Receipt Print(Horizontal)</div></td></tr></table></div>';
							else
								studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceiptHorizontal('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Horizontal)</div></td></tr></table></div>';
						}
						studentBillingDetails +='</div></div>';
					}
					studentBillingDetails += '</div>';
				} else {
					studentBillingDetails = '<div id="divReceiptHeader" style = "align:center;width:94%;margin-left: 3%;margin-right: 3%;background-color:#f7f7f7;color:#1d5987;margin-top:4px;font-weight:bold;font-size:10px;height:20px;">No Receipt history found!</div>'
						+ '<div id = "divStudentBillingInformationArea" style = "align:center;width: 94%;margin-left: 3%;margin-right: 3%;"></div>';
				}
				$('#commonDialog').modal('show').css({
					width:'870px',
					'margin-left': function () {
						return -($(this).width() / 2);
					}
				});
				$('#commonDialogBody').html(studentBillingDetails);

			}else{

			}
		}
	});
}

function printPaymentWiseStudentReceipt(studentBillId){
	var invoiceType = 'OPEN';
	var hasOfficeCopy = 'FALSE';
	var hasStudentCopy = 'TRUE';
	var printLogo = 'TRUE';
	var printType = '';
	window.location.replace('printPaymentWiseStudentReceiptPDF.json?studentBillId='+studentBillId+'&hasStudentCopy='+hasStudentCopy+'&hasOfficeCopy='+hasOfficeCopy+'&invoiceType='+invoiceType+'&printLogo='+printLogo+'&printType='+printType);
}

function printPaymentWiseStudentReceiptHorizontal(studentBillId){
	var invoiceType = 'OPEN';
	var hasOfficeCopy = 'FALSE';
	var hasStudentCopy = 'TRUE';
	var printLogo = 'TRUE';
	var printType = '';
	window.location.replace('printPaymentWiseStudentReceiptPDFHorizontal.json?studentBillId='+studentBillId+'&hasStudentCopy='+hasStudentCopy+'&hasOfficeCopy='+hasOfficeCopy+'&invoiceType='+invoiceType+'&printLogo='+printLogo+'&printType='+printType);
}


function studentBillingInfoHostel(jArray, callback) {
if(jArray != null){
	var length = jArray.length;
	var paidAmount = 0.0;
	if (jArray.length > 0) {
		var studentBillingDetailsHostel = '<div class="accordion" id="divStudentBillingDetailAccordianHostel" style="width:100%">';
		for ( var i = 0; i < length; i++) {
			paidAmount += parseFloat(jArray[i].amount);
			var desc = jArray[i].desc;
			studentBillingDetailsHostel += '<div class="accordion-group">'+
			'<div class="accordion-heading">'+
			'<a class="accordion-toggle" data-toggle="collapse" data-parent="#divStudentBillingDetailAccordianHostel" href="#studentBillingHostel'+i+'" style = "color:#000000">'+(i+1)+
			'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bill No.:&nbsp;&nbsp;'+jArray[i].billNo+'&nbsp;&nbsp;&nbsp;Received on:'+jArray[i].timestamp+ '&nbsp;&nbsp;&nbsp; Amount(in Rs.): '+
			formatAmount(jArray[i].amount)+'</a></div>'+
			'<div id="studentBillingHostel'+i+'" class="accordion-body collapse" style="background-color: #F7F7F7;">'+
			'<table class = "table table-condensed">'+
			'<tr><th colspan="6" style="text-align:center">RECEIPT';
/*			if ((jArray[i].billDate).toString() == (jArray[i].currentDate).toString() || jArray[i].EditDeleteFlag) {
				studentBillingDetailsHostel += '<span style="float:right">';
				studentBillingDetailsHostel += '<input type="button" value="Reverse Entry" class="btn btn-inverse btn-mini" onclick="reversePaymentDetail(\''+ jArray[i].studentBillId + '\')">&nbsp;&nbsp;';
				if ($('#hdnUserRole').val() == "financeadmin" && jArray[i]["paymentDetails"][0] != null && jArray[i]["paymentDetails"][0] != undefined
						&& jArray[i]["paymentDetails"][0]["modeOfPayment"] != 'BankChallan')
					studentBillingDetailsHostel += '<input type="button" value="Edit" class="btn btn-inverse btn-mini" onclick="editPaymentDetail(\''+jArray[i].studentBillId + '\')">&nbsp;&nbsp;';
				studentBillingDetailsHostel += '<a onclick="deleteStudentBillDetail(\''+ jArray[i].studentBillId+ '\')" class="" href="javascript:void(0)" title="Delete Receipt"><i class="icon-trash"></i></a></span>';
			}*/
			studentBillingDetailsHostel += '</th></tr>' +
			'<tr><td><label>Bill No:</label>' + '</td>' + '<td id="tdBillNo"'+i+'>'+jArray[i].billNo+'</td>'+
			'<td><label>Amount(in  <span class="WebRupee">Rs.</span>)</label></td>'+
			'<td id="tdAmount'+i+'">'+formatRupee(parseFloat(Math.round(jArray[i].amount).toFixed(2)))+'</td>'+
			'<td><label>Barcode</label></td>'+
			'<td id="tdBarCode'+i+'"><span style = "float:right" id="tdFeeInvoiceBillBarcodeNo'+i+'"></span></td></tr>'+
			'<tr><td colspan="6">';
			if (desc != undefined)
				studentBillingDetailsHostel += '<div style="display:block"><strong>Desc/Remark</strong>&nbsp;&nbsp;&nbsp;'+jArray[i].desc+'</div>';

			studentBillingDetailsHostel += '<table class="table table-condensed table-bordered" id="showPaymentDetailTLB'+jArray[i].studentBillId+'">'+
			'<tr><th colspan="6" style="text-align:left">Cash/DD/Cheque Details</th></tr>'+
			'<tr><td style="text-align:center">Amount</td>'+
			'<td style="text-align:center">Payment Mode</td>'+
			'<td style="text-align:center">Chq/DD/Challan No.</td>'+
			'<td style="text-align:center">Bank Name</td>'+
			'<td style="text-align:center">Branch</td>'+
			'<td style="text-align:center"></td></tr>';

			var paymentDetails = jArray[i].paymentDetails;
			for ( var j = 0; j < paymentDetails.length; j++) {
				var studentBillChequeDetailId = paymentDetails[j].studentBillChequeDetailId;
				var paymentMode = "";
				if (paymentDetails[j].modeOfPayment == 'Cheque')
					paymentMode = "Challan";
				else
					paymentMode = paymentDetails[j].modeOfPayment;
				var bankName = paymentDetails[j].modeOfPayment.toString().toLowerCase() != "cash" ? paymentDetails[j].bankName: "N/A";
				var bankBranch = paymentDetails[j].modeOfPayment.toString().toLowerCase() != "cash" ? paymentDetails[j].bankBranch: "N/A";
				var amt = parseFloat(paymentDetails[j].amount).toFixed(2);
				var chequeDDNo = paymentDetails[j].chequeDDNo;
				var chequeDDDate = paymentDetails[j].chequeDDDate;

				if (paymentDetails[j].chequeBouns == "ChequeBounced")
					studentBillingDetailsHostel += '<tr class="alert alert-error">';
				else
					studentBillingDetailsHostel += '<tr>';

				studentBillingDetailsHostel += '<td id="tdBillPaymentMode'+j+'" style="text-align:right"><strong>'+formatAmount(amt)+'</strong></td>'+
				'<td id="tdBillPaymentMode'+j+'" style="text-align:left">'+paymentMode+'</td>'+
				'<td id="tdchequeD'+j+'" class="ChequeDDDate1" style="text-align:center">'+chequeDDNo+'('+chequeDDDate+')</td>'+
				'<td id="tdBankName'+j+'" style="text-align:center">'+bankName+'</td>'+
				'<td id="tdbankBranch'+j+'" style="text-align:center">'+bankBranch+'</td>'+
				'<td>';
			/*	if (paymentMode != null && paymentMode != undefined&& paymentMode != 'BankChallan') {
					if (paymentDetails[j].chequeBouns != "ChequeBounced"&& paymentMode != "Cash")
						studentBillingDetailsHostel += '<a href="javascript:void(0)" class="btn btn-mini" onclick="chequeBouns('+ studentBillChequeDetailId+ ')">Cheque/DD Bounce</a>';
				}*/
				studentBillingDetailsHostel += '</td></tr>';
			}
			studentBillingDetailsHostel += '</table>'+
			'</td></tr>';

			var billPayableReceivable = parseFloat(jArray[i].studentFeeRecievable);
			if (billPayableReceivable >= 0) {
				studentBillingDetailsHostel += '<tr><td colspan="6" align="center"><span style="font-size:12px;font-weight: bold;text-align:center">Student Fees Receivable '
					+ formatRupee(parseFloat(billPayableReceivable.toFixed(2))) + '</span>';
			} else {
				billPayableReceivable = -(billPayableReceivable);
				studentBillingDetailsHostel += '<tr><td colspan="6" align="center"><span style="font-size:12px;font-weight: bold;text-align:center">Student Fees Payable '
					+ formatRupee(parseFloat(billPayableReceivable.toFixed(2))) + '</span>';
			}

			studentBillingDetailsHostel += '</td></tr></table>'+
			'<div id = "feeBillPrintPreviewBtn">'+
			'<table class="table table-bordered"><tr><th>Print Recipt</th>'+
			'<td><div class="btn btn-mini  btnColorBlue " onclick="printAdmissionReceiptHostelforStudent('+jArray[i].studentBillId+')">Hard Copy</div></td>'+
			'<td><div class="btn btn-mini  btnColorBlue " onclick="printPaymentWiseStudentReceipt('+jArray[i].studentBillId+')">Vertical</div></td>'+
			'<td><div class="btn btn-mini  btnColorBlue " onclick="printPaymentWiseStudentReceiptHorizontalForHostel('+jArray[i].studentBillId+')">Horizontal</div></td></tr></table></div>'+
			'</div></div>';
		}
		studentBillingDetailsHostel += '</div>';
	} else {
		studentBillingDetailsHostel = '<div id="divReceiptHeader" style = "align:center;width:94%;margin-left: 3%;margin-right: 3%;background-color:#f7f7f7;color:#1d5987;margin-top:4px;font-weight:bold;font-size:10px;height:20px;">No Receipt history found!</div>'
			+ '<div id = "divStudentBillingInformationArea" style = "align:center;width: 94%;margin-left: 3%;margin-right: 3%;"></div>';
	}
	callback(studentBillingDetailsHostel);
	
}else{
	callback("");
}

}

function printPaymentWiseStudentReceiptHorizontalForHostel(studentBillId){
	
	var invoiceType = 'OPEN';
	var hasOfficeCopy = 'FALSE';
	var hasStudentCopy = 'TRUE';
	var printLogo = 'TRUE';
	var printType = '';
	window.location.replace('printPaymentWiseStudentReceiptHorizontalForHostel.json?studentBillId='+studentBillId+'&hasStudentCopy='+hasStudentCopy+'&hasOfficeCopy='+hasOfficeCopy+'&invoiceType='+invoiceType+'&printLogo='+printLogo+'&printType='+printType);
}

function getOfficeDocStudentFeeDueReportOverallByStudentBatchId(src){
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
//	var studentId = $('#studentId').val();
	var studentId =0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	var hdAuth = $('#hdAuth').val();
	var url = 'geOfficeDocStudentFeeDueReportOverallByStudentBatchId.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_geOfficeDocStudentFeeDueReportOverallByStudentBatchId.json';
	}
	$.ajax({
		url:url,
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			showStudentOfficeDocFeeDueReportForInvoiceByStudentBatchId(jArray);
		}
	});
}
function showStudentOfficeDocFeeDueReportForInvoiceByStudentBatchId(jArray){
	tempId ='';
	globalSource = 0;
	var studentListJsonArray = jArray[0];
	//alert(studentListJsonArray);
	var feeStructureJArray = jArray[0][0]['fineList'];
	//alert(feeStructureJArray.length);
	var legacyObject = jArray[2];
	var boiler = '';
	var exceptionalCase = false;
	var admissionTypeName ='';
	/** Showing student information */
	//alert(studentListJsonArray.length);
	$('.studentFeeInviceListDetail').show();
	var studentId = '';
	if(studentListJsonArray.length > 0){
		studentId = studentListJsonArray[0].studentId;
		var stdName = studentListJsonArray[0].name;
		var studentName = '<STRONG>'+studentListJsonArray[0].name+'</STRONG>';
		var rollNo  = studentListJsonArray[0].rollNo;

		if(rollNo==undefined || rollNo=='undefined')
			rollNo = '';

		exceptionalCase = studentListJsonArray[0].exceptionalCase;
		var course = studentListJsonArray[0].coourseName;
		var admissionCategoryName = studentListJsonArray[0].admissionCategoryName;
		admissionTypeName = studentListJsonArray[0].admissionType;
		var semester = studentListJsonArray[0].semester!=undefined?studentListJsonArray[0].semester:"-";
		var division = studentListJsonArray[0].division!=undefined?studentListJsonArray[0].division:"-";
		var instituteCourseStrengthId = studentListJsonArray[0].instituteCourseStrengthId;

		var batchYear = studentListJsonArray[0].batchYear;
		var stdInstCourseSemBatch = studentListJsonArray[0].stdInstCourseSemBatch;
		globalSource = instituteCourseStrengthId;
		var status="";

		if(studentListJsonArray[0].status=="ADMISSION_CANCELLED")
			status = "ADMISSION CANCELLED";
		else if(studentListJsonArray[0].status=="PURSUING")
			status = "PURSUING";
		else if(studentListJsonArray[0].status=="YEARDOWN")
			status = "YEAR DOWN";

		exceptionalCase = exceptionalCase == undefined?false:exceptionalCase;
		boiler +=
			'<table class="table table-condensed table-bordered tablePrint studentPersonalInformation" style="display:none">'+
			'<tr>'+
			'<td rowspan="5" width="120px"><div class = "thumbnail studentProfileImage"></div></td>'+
			'<th style="text-align:left">Name</th><td>'+decodeURIComponent(studentName)+'</td>'+
			'<th style="text-align:left">Roll</th><td>'+rollNo+'</td>'+
			'<td style = "display:none;" class="studentId">'+studentId+'</td>'+
			'<td style = "display:none;" class="instituteCourseStrengthId">'+instituteCourseStrengthId+'</td>'+
			'</tr>'+
			'<tr>'+
			'<th style="text-align:left">Programme&nbsp;&nbsp;/&nbsp;&nbsp;Semester&nbsp;&nbsp;/&nbsp;&nbsp;Division</th><td colspan="3">'+course+'&nbsp;&nbsp;/&nbsp;&nbsp;'+semester+'&nbsp;&nbsp;/&nbsp;&nbsp;'+division+'</td>'+
			'<th style="text-align:left;display :none">Admission type</th><td style="display:none">'+admissionTypeName+'</td>'+
			'</tr>'+
			'<tr style="display :none">'+
			'<th style = "text-align:left">Admission category name</th>'+
			'<td style = "text-align:left">'+admissionCategoryName+'</td>'+
			/*'<th style = "text-align:left">Exceptional Case</th>'+
	        '<td style = "text-align:left">'+exceptionalCase.toString().toUpperCase()+'</td>'+*/

			'<th style = "text-align:left">Admission Status</th>'+
			'<td style = "text-align:left">'+status+'</td>'+

			'</tr>'+
			// '<tr>'+
			//   '<th style = "text-align:left">Request for Admission Cancellation</th>'+
			//  '<td style = "text-align:left" colspan="3">'+
			//'&nbsp;&nbsp;<input type="button" class="btn btn-inverse btn-mini btn-admissionCancel" style="display:none;" value="Request Admission Cancellation">&nbsp;&nbsp;'+
			//'&nbsp;&nbsp;<input type="button" class="btn btn-inverse btn-mini btn-generateVoucher" style="display:none;" disabled="disabled" value="Cancel Request">'+
			//'&nbsp;&nbsp;<input type="button" class="btn btn-mini btn-inverse btn-cancelAdmission" value="Admission Cancellation">&nbsp;&nbsp;'+


			// '</td>'+
			//'</tr>'+
			'</table><hr style="padding:0px;margin-bottom:5px">'+
			/*'<span><b>Rules and Regulation</b></span>'+
			'<ul>'+
			'<li>The bill payment service will be unavailable from 11:40 pm to 3:15 am daily.</li>'+
			'<li>To avoid fradulent transaction, it is recommended not to reveal details of your card to anybody; make payment yourself without going through any channels/agents.</li>'+
			'<li>Do not open multiple payment windows simultaneously. For multiple consumer numbers, make payments one at a time.</li></ul>'+*/



			'<b>To Procced with payement please verify the details below chosing you payment option</b>';

		$('#divStudentInformationOfficeDoc').html(boiler);
		//$('.studentProfileImage').html('<img src="getStudentProfileImageById.json?id='+studentId+'&type=profile" class = "img-polaroid" height = "100px" width = "100px" alt = "No image">');
		//showAdmissionCancellationForm(studentListJsonArray[0].studentId,studentListJsonArray[0].instituteCourseStrengthId);

		$('.btn-cancelAdmission').click(function(){
			configureStudentCancelationDetail(studentId,stdInstCourseSemBatch,rollNo,stdName,batchYear,course,semester,division);
		});

	} else {
		$('#divStudentInformationOfficeDoc').html('<div class="alert alert-error"><strong>Sorry!! No Student found found</strong></div>');
	}
	var totalAmountToPay = 0;
	if(feeStructureJArray.length > 0){
	
		var boiler='';
		
		//if(g_showStudentInvoiceFeesDetails=="Yes")
			boiler+='<div style="float:right"><a href="#" class="btn btn-mini btn-inverse" onclick="refreshStudentSideAcademic('+studentId+',\'Office Doc\')"><i class="fa fa-refresh"></i>&nbsp; Refresh</a></div>';
		
		boiler+='<table class="table table-condensed table-bordered tablePrint studentFineDetails">'+
		'<tr>'+
		'<th></th>'+
		'<th>Sr No</th>'+
		'<th>Description</th>'+
		'<th>Genrated Date</th>'+
		'<th>Generated By</th>'+
		'<th class="gems_currency">Miscellaneous Amount</th>'+
		'<th class="gems_currency">Paid Amount</th>'+
		'<th class="gems_currency">Payable Amount</th>'+
		'<th>Receipt No</th>'+
		'<th></th>'+
		'</tr>';
		for(var i =0;i<feeStructureJArray.length;i++){
			var studentHostelFineId = feeStructureJArray[i]['studentHostelFineId'];
			var journalId = feeStructureJArray[i]['journalId']; 
			var paidAmount =feeStructureJArray[i]['paidAmount'];
			var amount = feeStructureJArray[i]['amount'];
			var paidAmount = feeStructureJArray[i]['paidAmount'];
			var rceiptNo = feeStructureJArray[i]['journalId'];
			var amountPayable = 0;
			amountPayable =eval(amount) - eval(paidAmount);
			boiler+='<tr>';
			if(amountPayable==0 || amountPayable==0.0){
				boiler+='<td></td>';
			}
			else{
				boiler+='<td><input type="checkbox" class="chkAmountOffDocCls" miscHostelFineId="'+studentHostelFineId+'" value="'+amount+'" onclick="checkOfficeDocAmountIndiviual()"></td>';
			}	
			boiler+='<td class="gems_integer">'+eval(i+1)+'</td>'+
			'<td>'+feeStructureJArray[i]['description']+'</td>'+
			'<td>'+feeStructureJArray[i]['generatedDate']+'</td>'+
			'<td style="text-align:right">'+feeStructureJArray[i]['generatedBy']+'</td>'+
			'<td class="gems_currency_label">'+amount+'</td><td class="gems_currency_label">'+paidAmount+'</td><td class="gems_currency_label">'+eval(amount-paidAmount)+'</td><td>'+rceiptNo+'</td><td>';
			if(rceiptNo!=""){
			boiler+='<input type="button" id="receiptBtn" value="Receipt"  class="btn btn-inverse btn-mini" onClick="getIncomeReceipt(\''+feeStructureJArray[i]['incomeExpenseReceiptId']+'\',\''+rceiptNo+'\')">';
			}
			boiler+='</td></tr>';

			totalAmountToPay = eval(totalAmountToPay) + eval(amountPayable);
		}
		boiler+='</table>';
		$('#divStudentFeeDueInformationOfficeDoc').html(boiler);
		var varible='';
		if($('#customerHelper').val()=="RCOEM"){
			varible ='';
		}else{
			varible ='/Bank Challan';
		}
		
		boiler ='<div id="officeDocDiv" style="display:none"><b><input type="checkbox" id="chkAgreeTermsMiscellaneousoffice" onclick="ProccedAcademicToPay2('+totalAmountToPay+');">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b><br> '+
		'<span> You have chosen to pay an amount <b>Rs.</b> <label id="amtForOnlinePayment" class="amtForOnlinePaymentOffDoc" offDocAmt='+totalAmountToPay+'>'+totalAmountToPay+'</label> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
		'<span style="font-weight:bold;color:red">*If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>'+
		
		'<br><div style="text-align:center" id="paymentPluginsDivForMSoffice"></div>'+
		'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueForMSoffice"></span>'+
		'<br><div id="onlinePaymentSpanForMSoffice" style="display:none;" >'+
		'<span style="text-align:center;" id="onlinePaymentSpanForMS2office"></span><br>'+
		'<span style="text-align:center;" id="onlinePaymentSpanForMS2office4"></span>'+
		'<div></div>';
		$('#divStudentFeeDueInformationOfficeDoc').append(boiler);
	} else {
		$('#divStudentFeeDueInformationOfficeDoc').html('<div class="alert alert-error"><strong>Sorry!! No Fee structure found</strong></div>');
	}


	var bankId = 2;
	$(document).ready( function() {

		$('#paymentPluginsStudentFeeDueMisc').bcpymt({sPC:'MISCF',bWFH:false,iFBIDs:bankId});

	});

}

function getIncomeReceipt(incomeExpenseReceiptId,type,resourcecontent)
{
	var url='';
	if(type=='OnlineMode'){
        url='GetonlinepaymentDetailForIncomeReceipt.json?resourcecontent='+resourcecontent;
    }else{
        url='GetIncomeReceiptDetailForIncomeReceipt.json?receipt='+incomeExpenseReceiptId;
    }
	$.ajax({
		url:url,
		dataType:'json',
		type:'POST',
		async:false,
		beforeSend:function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(replay)
		{
			var instituteName = $('#instituteNamee').val();

			generatePaymentVoucher(replay.incomeReceipt,replay.receiptNo,replay.fromType,replay.rollNo,replay.deptName,replay.resCreatedBy,replay.receiptDate,replay.receivedFrom,replay.receivedForDetail,replay.paymentDetail,replay.bankDetail,instituteName,replay.remark,replay.footer);

		},
		error:function(){
			jAlert("Something went wrong, Please try after some time","Error");
		}
	});
}


function getIncomeReceipt1(incomeExpenseReceiptId,type,resourcecontent)
{
	var url='';
	if(type=='OnlineMode'){
		url='GetonlinepaymentDetailForIncomeReceipt.json?resourcecontent='+resourcecontent;
	}else{
		url='GetIncomeReceiptDetailForIncomeReceipt.json?receipt='+incomeExpenseReceiptId;
	}
	$.ajax({
		url:url,
		dataType:'json',
		type:'POST',
		async:false,
		beforeSend:function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(replay)
		{
			var instituteName = $('#instituteNamee').val();

			//generatePaymentVoucher(replay.incomeReceipt,replay.receiptNo,replay.fromType,replay.rollNo,replay.deptName,replay.resCreatedBy,replay.receiptDate,replay.receivedFrom,replay.receivedForDetail,replay.paymentDetail,replay.bankDetail,instituteName,replay.remark,replay.footer);
			generatePaymentVoucher1(replay.incomeReceipt,replay.receiptNo,replay.fromType,replay.rollNo,replay.deptName,replay.resCreatedBy,replay.receiptDate,replay.receivedFrom,replay.receivedForDetail,replay.paymentDetail,replay.bankDetail,instituteName,replay.remark,replay.footer);

		},
		error:function(){
			jAlert("Something went wrong, Please try after some time","Error");
		}
	});
}


function generatePaymentVoucher(receipt,receiptNo,fromType,rollNo,deptName,resCreatedBy,receiptDate,receivedFrom,receivedForDetail,paymentDetail,bankDetail,instituteName,remark,footer)
{
	var instId = $('#instCourseId').val();
	var instituteAddess = $('#instituteAddresss').val();
	//instituteAddess="";
	if(remark!='')
	{
		remark =
			'<tr>'+
			'<td colspan="3"><strong>Remark : </strong>'+remark+'</td>'+
			'</tr>';
	}

	var amountInWord = "";

	/*try
	{
		amountInWord = toWords(eval(amount));
	}
	catch (e) {
		amountInWord = '';
	}*/

	var receivedFor = '';
	var tot = 0;

	for(var i=0;i<receivedForDetail.length;i++)
	{
		receivedFor +=
			'</tr>'+
			'<td style="text-align:center;">'+eval(i+1)+'</td>'+
			'<td> '+receivedForDetail[i].detail+'</td>'+
			'<td style="text-align:right;">'+formatAmount(parseFloat(receivedForDetail[i].amount).toFixed(2))+'</td>'+
			'</tr>';

		if(receivedForDetail[i].amount!=null && !isNaN(receivedForDetail[i].amount))
			tot += eval(receivedForDetail[i].amount);
	}

	try
	{
		amountInWord = (toWords(eval(tot))+'').toUpperCase();
	}
	catch (e) {
		amountInWord = '';
	}

	var payment = '';

	for(var i=0;i<paymentDetail.length;i++)
	{/*
		payment += payment==''?paymentDetail[i].detail:' '+paymentDetail[i].detail;
		payment +=' Amount : '+paymentDetail[i].amount;
	 */
		payment +=
			'</tr>'+
			'<td style="width:81%;">'+paymentDetail[i].detail+'</td>'+
			'<td style="text-align:right;width:19%;">'+formatAmount(parseFloat(paymentDetail[i].amount).toFixed(2))+'</td>'+
			'</tr>'; 

	}

	for(var i=0;i<bankDetail.length;i++)
	{
		/*payment += payment==''?bankDetail[i].detail:' '+bankDetail[i].detail;
		payment +=' Amount : '+bankDetail[i].amount;*/

		payment +=
			'</tr>'+
			'<td style="width:81%;">'+bankDetail[i].detail+'</td>'+
			'<td style="text-align:right;width:19%;">'+formatAmount(parseFloat(bankDetail[i].amount).toFixed(2))+'</td>'+
			'</tr>';

	}

	if(payment!=null || payment!='')
	{
		payment =
			'<tr>'+
			'<td colspan="3" style="font-size:9px;">'+
			'<table cellspacing="0" cellpadding="0" class="table3" style="width:100%;">'+payment+'</table>'+
			'</td>'+
			'</tr>';

		/*payment =
			'<tr>'+
				'<td colspan="3">'+
					'<table cellspacing="0" cellpadding="0" class="table3" style="width:50%;">'+
						payment+
					'</table>'+
				'</td>'+
			'</tr>';*/
	}

	var stdDetail = '';


	if(fromType=='Student')
	{
		if(rollNo=='')
			rollNo = ' - ';

		/*stdDetail = 
			'<tr>'+
				'<td><strong>Dept. / Branch </strong></td><td colspan="2"><b> '+deptName+'</b></td>'+
			'</tr>'+
			'<tr>'+
				'<td><strong>Roll no </strong></td><td colspan="2"><b> '+rollNo+'</b></td>'+
			'</tr>';*/

		stdDetail = 
			'<tr>'+
			'<td colspan="3">'+
			'<b>'+
			'<div style="display:inline-block;">Dept. / Branch : '+deptName+'</div>'+
			'<div style="display:inline-block;margin-left:30px;">Roll no : '+rollNo+
			'</b>'+
			'</td>'+
			'</tr>';
	}
	var instName = instituteName;
	try{instituteName = instituteName.toUpperCase();}
	catch(e){}

	if(receiptNo!=undefined && receiptNo!='' && receiptNo.split('/').length==3)
	{
		var temp = receiptNo.split('/');
		temp[2]='<span class="fontBold">'+temp[2]+'</span>';
		receiptNo = temp.join('/');
	}

	if(footer!='')
		footer = '<div><pre>'+footer+'</pre></div>';
		
	var boiler = 
		'<div style="width:100%;text-align:center;font-size: 10px;" class="printDiv">'+
		/*'<strong>'+$('#subjectTo').val()+'</strong>'+*/
		'</div>'+
		'<div style="width:100%;font-family: COURIER;">'+
		'<div style="width:20%;display:inline-block;text-align:center;vertical-align:middle;">'+
		'<img height="46px" src="getInstituteLogo.json">'+
		'</div>'+
		'<div style="width:60%;display:inline-block;text-align:center;vertical-align:middle;">'+
		'<b><span style="font-size: 13px;">'+instituteName+'</span><br><span style="font-size: 10px;">'+instituteAddess+'</span></b>'+
		'</div>'+
		'<div style="width:20%;display:inline-block;text-align:center;vertical-align:middle;">'+
		'<img height="46px" src="getInstituteLogo.json">'+
		'</div>'+
		'</div><br>'+
		'<table class="table table-bordered table2" cellspacing="0" cellpadding="0" id="tblPrintIncomeResceipt" >'+
		/*'<tr>'+
					'<th colspan="3"><center><div><img height="36px" src="getInstituteLogo.json"></div><b>'+instituteName+'</b><br><b>Receipts <span id="spnCopyName"></span></b></center></th>'+
				'</tr>'+*/
		'<tr>'+
		'<th colspan="3"><center><b>RECEIPT</b></center></th>'+
		'</tr>'+
		'<tr>'+
		'<td><strong>Receipt No. </strong></td><td colspan="2"><span class="size14"> '+receiptNo+' </span><span style="float:right;" >'+receiptDate+'</span></td>'+
		'</tr>'+
		'<tr>'+
		'<td><strong>Received from </strong></td><td colspan="2" class="size14 fontBold">'+receivedFrom+'</td>'+
		'</tr>'+
		stdDetail+
		'<tr>'+
		'<th style="width:17%;">Sr no.</th>'+
		'<th style="width:63%;">Account Head</th>'+
		'<th style="width:20%;">Amount</th>'+
		'</tr>'+
		receivedFor+
		remark+
		'<tr>'+
		'<td><strong>Amount in word </strong></td>'+
		'<td colspan="2"> Rupees '+amountInWord+' ONLY</td>'+
		'</tr>'+
		'<tr>'+
		'<td colspan="2" style="text-align:right"><b>Total(In Rs.)</b></td>'+
		'<td style="text-align:right;" class="fontBold">'+formatAmount(parseFloat(tot).toFixed(2))+'/-</td>'+
		'</tr>'+
		payment+
		'<tr>'+
		//'<td colspan="3" style="text-align:right;" class="fontBold size10"><strong>For '+instName+' <br>Generated by : '+resCreatedBy+'</strong></td>'+
		'<td colspan="3" style="" class="fontBold size10">'+
			
			'<div style="text-align:right;">'+
				'<br><strong>Generated by : '+resCreatedBy+'<br>For '+instName+'</strong>'+
			'</div>'+
			footer+
		'</td>'+

		'</tr>'+
		/*'<tr>'+
				'<td colspan="3" style="font-weight:bold;font-style:italic">Provisional fee & Subject to orders of Honorable High Court & Supreme Court</td>'+
			'</tr>'+*/
		'</table>';
	//alert(boiler);

	$('#commonDialogBody').html(boiler);

	boiler ='<input type="button" value="Print Receipt" class="btn btn-primary btn-mini" id="btnReceiptPdf" style="width:110px;"/>'; 
		/*'<input type="button" value="New income receipt" class="btn btn-primary btn-mini" id="btnResNewIncomeReceipt" style="width:110px;"/>'+*/
		
	$('#commonDialogFooter').html(boiler);
	//alert(tot);
	//setAmountAndPaidStatus(tot);
	
	$('#btnReceiptPdf').click(function(){
		//printReceiptPDF(incomeReceipt);*/

		printReceipt(fromType);
		//$('#commonDialogBody').jqprint();
	});

	$('#btnResNewIncomeReceipt').click(function(){
		$('#commonDialogHeader').html('');
		$('#commonDialogBody').html('');
		$('#commonDialogFooter').html('');
		configureAddNewReceipt(gRouteStudentEmployeeMappingId);
	});

	$('#commonDialog').modal('show').css({
		width:'675px',
		'margin-left': function () {
			return -($(this).width() / 2);
		}
	});

}

function printReceipt1(){
	try{
		var elementIdToBePrinted = "divPrint";
		var outputFileName = "PaymentReceipt.pdf";
		var PageSize = "A4";
		kendo.drawing
		.drawDOM("#"+elementIdToBePrinted, 
			{ 
			paperSize: PageSize,
			margin: "1cm",
			keepTogether: ".prevent-split",
			scale: 0.8,
			height: 500,
			landscape: true,
				})
				.then(function(group){
					kendo.drawing.pdf.saveAs(group,outputFileName)
				});
	}catch(e){	}
}
function printReceipt(fromType){

	//$('#spnCopyName').html(' (Office copy)');
	var receipt=$('#commonDialogBody').html();

	var boilerPrint = 
		'<div style="height:24.6cm;">'+
		'<div style="height:30%;">'+
		receipt+
		'</div>'+
		'<div style="height:30%;padding-top:15%;">';
	
	/*if($('#customerHelper').val()=='STJOHNS'){
		boilerPrint +='<h4 style="text-align:center;">Office Copy</h4>';
	}*/
		
	/*boilerPrint +='<span style="text-align:center">---------------------------------------------------------------------------------------------------------------------</span>'+
		receipt;*/
	/*
	if($('#customerHelper').val()=='STJOHNS'){
		boilerPrint +='<h4 style="text-align:center;">Student Copy</h4>';
	}
	
	boilerPrint +='</div>'+
		'</div>';*/

	var myboiler='<html><meta charset="utf-8" /><head>'+
	'<style type="text/css">'+

	'@media print  and (width: 21cm) and (height: 29.7cm) {'+
	'@page {'+
	'     margin: 3cm;'+

	'  }'+
	'body{ background-color:#FFFFFF; background-image:none; color:#000000; border:none}'+
	'.ad{ display:none;}'+
	'.HeaderSection'+
	'{'+
	'display:none;'+
	'}'+
	'.FooterSection'+
	'{'+
	'display:none;'+
	'}'+
	'.leftbar{ display:none;}'+
	'.contentarea{ width:100%;}'+
	'}'+
	'table.table2 a:link	{	     color: #666;	    font-weight: bold;	    text-decoration: none; 	}	.table2 a:visited	{	    color: #999999;	    font-weight: bold;	    text-decoration: none;	}	.table2 a:active, .table2 a:hover	{	    color: #bd5a35;	    text-decoration: underline;	}	/* .table-bordered {	    -moz-border-bottom-colors: none;	    -moz-border-left-colors: none;	    -moz-border-right-colors: none;	    -moz-border-top-colors: none;	    border-collapse: separate;	    border-color: #DDDDDD #DDDDDD #DDDDDD -moz-use-text-color;	    border-image: none;	    border-radius: 4px 4px 4px 4px;	    border-style: solid solid solid none;	    border-width: 1px 1px 1px 0;	}	.table {	    margin-bottom: 18px;	    width: 100%;	}	table {	    border-collapse: collapse;	    border-spacing: 0;	} */	.table2	{	    width:100%;	    font-family: COURIER;	    color: Black;	    font-size: 12px;	    text-shadow: 1px 1px 0px #fff;	    border: #000 1px solid;	    -moz-border-radius: 3px;	    -webkit-border-radius: 3px;	    border-radius: 3px;	    -moz-box-shadow: 0 1px 2px #d1d1d1;	    -webkit-box-shadow: 0 1px 2px #d1d1d1;	    box-shadow: 0 1px 2px #d1d1d1;	    border-spacing: 0;	}	.table2 tr th:first-child	{	    text-align: left;	    padding-left: 10px;	    border-left: 0;	    text-align: center;	}	.table2 th	{	    border-top: 1px solid #000;	    border-bottom: 1px solid #000;	    border-left: 1px solid #000;	    text-align: center;	    height: 15px;	    font-weight: bold;	    background: #bfbfbf;	    /*background: -webkit-gradient(linear, left top, left bottom, from(#ededed), to(#ebebeb));	    background: -moz-linear-gradient(top,  #ededed,  #ebebeb); */	}	.table2 th:first-child	{	    text-align: left; /*padding-left:20px;*/	}	.table2tr:first-child th:first-child	{	    -moz-border-radius-topleft: 3px;	    -webkit-border-top-left-radius: 3px;	    border-top-left-radius: 3px;	}	.table2 tr:first-child th:last-child	{	    -moz-border-radius-topright: 3px;	    -webkit-border-top-right-radius: 3px;	    border-top-right-radius: 3px;	}	.table2 tr	{	    text-align: left;	    padding-left: 1px;	}	.table2 tr td:first-child	{	    text-align: left;	    padding-left: 10px;	    border-left: 0;	}	.table2 tr td	{	    height: 10px;	    border-top: 1px solid #ffffff;	    border-bottom: 1px solid #000;	    border-left: 1px solid #000;	    /* border-right: 1px solid #000; */	    	    	    /* background: #fafafa;	    background: -webkit-gradient(linear, left top, left bottom, from(#fbfbfb), to(#fafafa));	    background: -moz-linear-gradient(top,  #fbfbfb,  #fafafa); */	}	.table2 tr.even td	{	    background: #f6f6f6;	    background: -webkit-gradient(linear, left top, left bottom, from(#f8f8f8), to(#f6f6f6));	    background: -moz-linear-gradient(top,  #f8f8f8,  #f6f6f6);	}	.table2 tr:last-child td	{	    border-bottom: 0;	}	.table2 tr:last-child td:first-child	{	    -moz-border-radius-bottomleft: 3px;	    -webkit-border-bottom-left-radius: 3px;	    border-bottom-left-radius: 3px;	}	.table2 tr:last-child td:last-child	{	    -moz-border-radius-bottomright: 3px;	    -webkit-border-bottom-right-radius: 3px;	    border-bottom-right-radius: 3px;	}	.table2 tr:hover td	{	    /* background: #f2f2f2;	    background: -webkit-gradient(linear, left top, left bottom, from(#f2f2f2), to(#f0f0f0));	    background: -moz-linear-gradient(top,  #f2f2f2,  #f0f0f0); */	}'+
     '</style>'+
	'<link rel="stylesheet" href="css/print.css" rel="stylesheet" media="print" />'+
	'</head><body>';
	myboiler+=boilerPrint;
	myboiler+='</body></html>';
	var printWin = window.open('','','left=0,top=0,width=1,height=1,toolbar=0,scrollbars=2,status=0');
	printWin.document.write(myboiler);
	printWin.document.close();
	printWin.focus();
	printWin.print();
	printWin.close();
}
function getAllStudentFeeReceiptByStudentId(src)
{
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	
	$.ajax({
		url:'getAllStudentFeeReceiptByStudentId.json',
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			var amountTotal = 0.0;
			var boiler ='<table id="AllReceiptEntryTable" class="table table-bordered">'+
				'<thead><tr><th class="nonPrintable">Print</th><th>Receipt No.</th><th>Receipt Date</th><th>Receipt Time</th><th>Received From</th><th>Created by</th>'+
				'<th>Department / Cost Center</th><th>Remark</th><th class="gems_currency_label">Amount</th></tr></thead><tbody id="tBodyReceipt"></tbody>'+
			'<tfoot><tr><th colspan="8" class="gems_currency_label" style="align:right;">TOTAL AMOUNT</th>'+
			'<td class="totalIER gems_currency"></td>'+
			'</tr></tfoot></table>'+
			'</table><br><br>';
			$('#AllStudentFeeReceiptDetails').html(boiler);
			
			for(var i=0;i<jArray.length;i++)
			{
				boiler = '<tr>'+
				
					'<td style="text-align:center;" class="nonPrintable" ><i class="icon-list-alt pointer viewIncomeReceipt receiptsIcon" onclick="getIncomeReceipt('+jArray[i]["incomeExpenseReceiptId"]+',\''+jArray[i]["Type"]+'\',\''+jArray[i]["receiptNo"]+'\')"></i></td>'+
					'<td>&nbsp;'+jArray[i]["receiptNo"]+'</td>'+
					'<td>&nbsp;'+jArray[i]["receiptDate"]+'</td>'+
					'<td>&nbsp;'+jArray[i]["receiptTime"]+'</td>'+
					'<td>&nbsp;'+jArray[i]["receivedFrom"]+'</td>'+
					'<td>&nbsp;'+jArray[i]["createdBy"]+'</td>'+
					'<td>&nbsp;'+jArray[i]["department"]+'</td>'+
					'<td>&nbsp;'+jArray[i]["remark"]+'</td>'+
					'<td class="gems_currency">'+jArray[i]["amount"]+'</td>';
			
				$('#tBodyReceipt').append(boiler);
				$('#tBodyReceipt tr:last').data('incomeExpenseReceiptId', jArray[i]["incomeExpenseReceiptId"]);
				$('#tBodyReceipt tr:last').data('journalId', jArray[i]["journalId"]);
				$('#tBodyReceipt tr:last').data('receiptNo', jArray[i]["receiptNo"]);
				$('#tBodyReceipt tr:last').data('subBudgetAccounts', jArray[i]["subBudgetAccounts"]);
				$('#tBodyReceipt tr:last').data('crAccountHead', jArray[i]["CrAccountHeadArr"]);

				var amount = parseFloat(jArray[i]['amount']);
				amountTotal = parseFloat(amountTotal + amount);
			}

			$('.mapToBudget').click(function(){
				var journalId = $(this).closest('tr').data('journalId');
				var receiptNo = $(this).closest('tr').data('receiptNo');
				var subBudgetAccounts = $(this).closest('tr').data('subBudgetAccounts');
				mapToBudgetModel(journalId, receiptNo, subBudgetAccounts);
			});
			
			$('.totalIER').html(amountTotal);
			
			$('#btnIEReceiptListToPdf').click(function(){
				$('#AllReceiptEntryTable_filter input:text').val('').keyup();
				var oSettings = $('#AllReceiptEntryTable').dataTable().fnSettings();
				oSettings._iDisplayLength = -1;
				$('#AllReceiptEntryTable').dataTable().fnDraw();
				printDetailToPDF('<table class="tablePrint">'+$('#AllReceiptEntryTable').html()+'</table>',true,'');
				oSettings._iDisplayLength = 10;
				$('#AllReceiptEntryTable').dataTable().fnDraw();
				getNewFeeReceipt();
			});
		},
		error:function(){
			jAlert("Something went wrong, Please try after some time","Error");
		}
	});
}
function printAdmissionReceiptHostelforStudent(studentBillId){
	getHostelReceiptwisePaymentInformationForPrinting(studentBillId,function(jObject){
		var instituteName = $('#instituteName').val();
		var receiptHeading = $('#hpReceiptHeading').val();
		
		var receiptNo = jObject['receiptNo'];
		// var instituteName = jObject['instituteName'];
		var hostelNo = jObject['hostelNo'];
		var hostelName = jObject['hostelName'];
		//var currDate = jObject['currDate'];
		var currDate = jObject['receiptDate'];
		var studentName = jObject['studentName']; 
		var studentUID = jObject['studentUID'];
		if(studentUID == undefined){
			studentUID = '-';
		}
		var studclass = jObject['class'];
		var particularArray =  jObject['particularArray'];
		var receiptArray =  jObject['receiptArray'];
		var generatedBy =  jObject['generatedBy'];
		var remark	 =  jObject['remark'];
		if(remark == '' || remark == undefined){
			remark = '';//'Interim fee. Final fee would be finalized by the S.S.Samiti';
		} 
		var totalAmount = 0;	
		var payment = '';
		var stdDetail = 
			'<tr>'+
				'<td colspan="3">'+
					'<b>'+
						'<div style="display:inline-block;">Dept. / Branch : '+studclass+'</div>'+
					'</b>'+
				'</td>'+
			'</tr>'+
		'<tr>'+
		'<td colspan="3">'+
			'<b>'+
				'<div style="display:inline-block;">Institute Name : '+instituteName+'</div>'+
			'</b>'+
		'</td>'+
	'</tr>';
		
		/*if(receiptNo!=undefined)
			receiptNo=receiptNo.split('/')[0]+"/"+receiptNo.split('/')[1]+"/"+'<strong>'+receiptNo.split('/')[2]+'</strong>'; */
		for(var i=0;i<receiptArray.length;i++)
		{
			payment +=
				'</tr>'+
					'<td style="width:81%;">'+receiptArray[i].paidBy+'</td>'+
					'<td style="text-align:right;width:19%;">'+formatAmount(parseFloat(receiptArray[i].amount).toFixed(2))+'</td>'+
				'</tr>';
				
		}
		
		if(payment!=null || payment!='')
		{
			payment =
				'<tr>'+
					'<td colspan="3" style="font-size:9px;">'+
						'<table cellspacing="0" cellpadding="0" class="table2" style="width:100%;">'+payment+'</table>'+
					'</td>'+
				'</tr>';
		}
		var boiler = 
			'<div style="width:100%;text-align:center;font-size: 10px;" class="printDiv">'+
			'<strong>'+$('#subjectTo').val()+'</strong>'+
		'</div>'+
		'<div style="width:100%;font-family: COURIER;">'+
			'<div style="width:20%;display:inline-block;text-align:center;vertical-align:middle;">'+
				'<img height="46px" src="getInstituteLogo.json">'+
			'</div>'+
			'<div style="width:60%;display:inline-block;text-align:center;vertical-align:middle;font-size: 13px;">'+
				'<b>'+receiptHeading+'</b>'+
			'</div>'+
			'<div style="width:20%;display:inline-block;text-align:center;vertical-align:middle;">'+
				'<img height="46px" src="getInstituteLogo.json">'+
			'</div>'+
		'</div><br>'+
		'<table class="table table-bordered table2" cellspacing="0" cellpadding="0" id="tblPrintIncomeResceipt" >'+
				/*'<tr>'+
					'<th colspan="3"><center><div><img height="36px" src="getInstituteLogo.json"></div><b>'+instituteName+'</b><br><b>Receipts <span id="spnCopyName"></span></b></center></th>'+
				'</tr>'+*/
			'<tr>'+
				'<th colspan="3"><center><b>RECEIPT</b></center></th>'+
			'</tr>'+
			'<tr>'+
				'<td><strong>Receipt No. </strong></td><td colspan="2"><span class="size14"> '+receiptNo+' </span><span style="float:right;" >'+currDate+'</span></td>'+
			'</tr>'+
			'<tr>'+
				'<td><strong>Received from </strong></td><td colspan="2" class="size14 fontBold">'+
				'<span class="size14"> '+studentName+'</span><span style="float:right;" >UID: '+studentUID+'</span></td>'+
			'</tr>'+
			'<tr>'+
			'<td><strong>Hostel Name  </strong></td><td colspan="2" class="size14 fontBold">'+
			'<span class="size14"> '+hostelName+'</span><span style="float:right;" >Room No : '+hostelNo+'</span></td>'+
		'</tr>'+
			stdDetail+
			'<tr>'+
				'<th style="width:17%;">Sr no.</th>'+
				'<th style="width:63%;">Account Head</th>'+
				'<th style="width:20%;">Amount</th>'+
			'</tr>';
			for(var k = 0; k<particularArray.length;k++){
				 boiler+='</tr><td style="text-align:center">'+eval(k+1)+'</td>';
				 
				 if(particularArray[k]['isRefundable'])
					 boiler+='<td style="">'+particularArray[k]['orgFeeItemHeadName']+'( Refundable )</td>';
				 else
					 boiler+='<td style="">'+particularArray[k]['orgFeeItemHeadName']+'</td>';
				 
				 boiler+='<td style="text-align:right">'+commaFormatted(Math.round(parseFloat(particularArray[k]['totalAmount'])).toFixed(2))+'</td></tr>';
				 
				 totalAmount=totalAmount+eval(particularArray[k]['totalAmount']);
				 
			 }
			amountInWord = (toWords(eval(totalAmount))+' Only.');
			boiler+='<tr>'+
				'<td><strong>Amount in word </strong></td>'+
				'<td colspan="2"> Rupees '+amountInWord+' </td>'+
			'</tr>'+
			'<tr>'+
				'<td colspan="2" style="text-align:right"><b>Total(In Rs.)</b></td>'+
				'<td style="text-align:right;" class="fontBold">'+formatAmount(parseFloat(totalAmount).toFixed(2))+'/-</td>'+
			'</tr>';
			boiler+='<tr>'+
					payment+
				'<tr>'+
					'<td colspan="3">'+remark+'</td>'+
				'</tr>'+
				'<tr>'+
				'<td colspan="3" style="text-align:right;" class="fontBold size10"><strong>For '+instituteName+' <br><br>Generated By : '+generatedBy+'</strong></td>'+
			'</tr>'+
			/*'<tr>'+
				'<td colspan="3" style="font-weight:bold;font-style:italic">Provisional fee & Subject to orders of Honorable High Court & Supreme Court</td>'+
			'</tr>'+*/
		'</table>';
			
			var boilerPrint = 
				'<div style="height:24.6cm;">'+
					'<div style="height:40%;">'+
					boiler+
					'</div>'+
					/*'<div style="height:40%;padding-top:16%;">'+
					'<span style="text-align:center">---------------------------------------------------------------------------------------------------------------------</span>'+
					boiler+
					'</div>'+*/
					/*'<div style="height:40%;padding-top:16%;">'+
					'<span style="text-align:center">---------------------------------------------------------------------------------------------------------------------</span>'+
					boiler+
					'</div>'+*/
				'</div>';
				
			var myboiler='<html><meta charset="utf-8" /><head>'+
				'<style type="text/css">'+
				
				'@media print  and (width: 21cm) and (height: 29.7cm) {'+
			    '@page {'+
				 '     margin: 3cm;'+
			    
				  '  }'+
				'body{ background-color:#FFFFFF; background-image:none; color:#000000; }'+
				'.ad{ display:none;}'+
				'.HeaderSection'+
				'{'+
				'display:none;'+
				'}'+
				'.FooterSection'+
				'{'+
				'display:none;'+
				'}'+
				'.leftbar{ display:none;}'+
				'.contentarea{ width:100%;}'+
				'}'+
				'table.table2 a:link	{	     color: #666;	    font-weight: bold;	    text-decoration: none; 	}	.table2 a:visited	{	    color: #999999;	    font-weight: bold;	    text-decoration: none;	}	.table2 a:active, .table2 a:hover	{	    color: #bd5a35;	    text-decoration: underline;	}	/* .table-bordered {	    -moz-border-bottom-colors: none;	    -moz-border-left-colors: none;	    -moz-border-right-colors: none;	    -moz-border-top-colors: none;	    border-collapse: separate;	    border-color: #DDDDDD #DDDDDD #DDDDDD -moz-use-text-color;	    border-image: none;	    border-radius: 4px 4px 4px 4px;	    border-style: solid solid solid none;	    border-width: 1px 1px 1px 0;	}	.table {	    margin-bottom: 18px;	    width: 100%;	}	table {	    border-collapse: collapse;	    border-spacing: 0;	} */	.table2	{	    width:100%;	    font-family: COURIER;	    color: Black;	    font-size: 12px;	    text-shadow: 1px 1px 0px #fff;	    border: #000 1px solid;	    -moz-border-radius: 3px;	    -webkit-border-radius: 3px;	    border-radius: 3px;	    -moz-box-shadow: 0 1px 2px #d1d1d1;	    -webkit-box-shadow: 0 1px 2px #d1d1d1;	    box-shadow: 0 1px 2px #d1d1d1;	    border-spacing: 0;	}	.table2 tr th:first-child	{	    text-align: left;	    padding-left: 10px;	    border-left: 0;	    text-align: center;	}	.table2 th	{	    border-top: 1px solid #000;	    border-bottom: 1px solid #000;	    border-left: 1px solid #000;	    text-align: center;	    height: 15px;	    font-weight: bold;	    background: #bfbfbf;	    /*background: -webkit-gradient(linear, left top, left bottom, from(#ededed), to(#ebebeb));	    background: -moz-linear-gradient(top,  #ededed,  #ebebeb); */	}	.table2 th:first-child	{	    text-align: left; /*padding-left:20px;*/	}	.table2tr:first-child th:first-child	{	    -moz-border-radius-topleft: 3px;	    -webkit-border-top-left-radius: 3px;	    border-top-left-radius: 3px;	}	.table2 tr:first-child th:last-child	{	    -moz-border-radius-topright: 3px;	    -webkit-border-top-right-radius: 3px;	    border-top-right-radius: 3px;	}	.table2 tr	{	    text-align: left;	    padding-left: 1px;	}	.table2 tr td:first-child	{	    text-align: left;	    padding-left: 10px;	    border-left: 0;	}	.table2 tr td	{	    height: 10px;	    border-top: 1px solid #ffffff;	    border-bottom: 1px solid #000;	    border-left: 1px solid #000;	    /* border-right: 1px solid #000; */	    	    	    /* background: #fafafa;	    background: -webkit-gradient(linear, left top, left bottom, from(#fbfbfb), to(#fafafa));	    background: -moz-linear-gradient(top,  #fbfbfb,  #fafafa); */	}	.table2 tr.even td	{	    background: #f6f6f6;	    background: -webkit-gradient(linear, left top, left bottom, from(#f8f8f8), to(#f6f6f6));	    background: -moz-linear-gradient(top,  #f8f8f8,  #f6f6f6);	}	.table2 tr:last-child td	{	    border-bottom: 0;	}	.table2 tr:last-child td:first-child	{	    -moz-border-radius-bottomleft: 3px;	    -webkit-border-bottom-left-radius: 3px;	    border-bottom-left-radius: 3px;	}	.table2 tr:last-child td:last-child	{	    -moz-border-radius-bottomright: 3px;	    -webkit-border-bottom-right-radius: 3px;	    border-bottom-right-radius: 3px;	}	.table2 tr:hover td	{	    /* background: #f2f2f2;	    background: -webkit-gradient(linear, left top, left bottom, from(#f2f2f2), to(#f0f0f0));	    background: -moz-linear-gradient(top,  #f2f2f2,  #f0f0f0); */	}'+
				'</style>'+
				'<link rel="stylesheet" href="css/print.css" rel="stylesheet" media="print" />'+
				'</head><body>';
				myboiler+=boilerPrint;
				myboiler+='</body></html>';
						var printWin = window.open('','','left=0,top=0,width=1,height=1,toolbar=0,scrollbars=2,status=0');
						printWin.document.write(myboiler);
						printWin.document.close();
						printWin.focus();
						printWin.print();
						printWin.close();
	});
}

function getStudentotherFeeDetails(src){
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	var studentId =0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	var btn='<input type="button" value="Make Payment" class="btn btn-mini btn-inverse pull-right" onclick="studentFine('+studentId+')">';
	if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY")
		btn='<input type="button" value="Make Payment" class="btn btn-mini btn-inverse pull-right" onclick="addStudentOtherFine('+studentId+',\'4\')">';
	
	$.ajax({
		url:'getMiscellaneousStudentOtherFeeDueReportOverallByStudentBatchId.json',
		data:{
			studentId:studentId,
			financePolicyId:'4'
		},
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(feeStructureJArray){
          var totalAmountToPay=0.0;
			boiler='<br><div>'+btn+'</div><br><table class="table table-condensed table-bordered tablePrint studentFineDetails">'+
			'<tr>'+
			'<th>Sr No</th><th></th>'+
			'<th>Fee Name</th>'+
			'<th>Description</th>'+
			'<th>Generated Date</th>'+
			'<th>Generated By</th>'+
			'<th>Miscellaneous Amount</th>'+
			'<th>Paid Amount</th>'+
			'<th>Payable Amount</th>'+
			'<th>Receipt No</th>'+
			'</tr>';
			if(feeStructureJArray.length>0){
				for(var i =0;i<feeStructureJArray.length;i++){
					var studentHostelFineId = feeStructureJArray[i]['studentHostelFineId'];
					var journalId = feeStructureJArray[i]['journalId']; 
					var paidAmount =feeStructureJArray[i]['paidAmount'];
					var amount = feeStructureJArray[i]['amount']!=null && feeStructureJArray[i]['amount']!=undefined && feeStructureJArray[i]['amount']!=''?feeStructureJArray[i]['amount']:0.00;
					var paidAmount = feeStructureJArray[i]['paidAmount']!=null && feeStructureJArray[i]['paidAmount']!=undefined && feeStructureJArray[i]['paidAmount']!=''?feeStructureJArray[i]['paidAmount']:0.00;
					var rceiptNo = feeStructureJArray[i]['journalId'];
					var amountPayable = eval(amount) - eval(paidAmount);
					boiler+='<tr>';
					boiler+='<td class="gems_integer">'+eval(i+1)+'</td>';
					if(rceiptNo=='' || rceiptNo==undefined )
						boiler+='<td><input type="checkbox" class="clsotherMSstudentHosFineId" value="'+studentHostelFineId+'"></td>';
					else
						boiler+='<td></td>';
					boiler+='<td>'+feeStructureJArray[i]['accountHeadname']+'</td><td>'+feeStructureJArray[i]['description']+'</td>'+
					'<td>'+feeStructureJArray[i]['generatedDate']+'</td>'+
					'<td style="text-align:left">'+feeStructureJArray[i]['generatedBy']+'</td>'+
					'<td class="gems_currency">'+amount+'</td><td class="gems_currency">'+paidAmount+'</td><td class="gems_currency">'+(amountPayable<0?(-eval(amountPayable)):eval(amountPayable))+'</td><td>'+rceiptNo+'</td></tr>';
					if(amountPayable>0)
						totalAmountToPay = eval(totalAmountToPay) + eval(amountPayable);
				}
			}else{
				boiler+='<tr><td colspan="8">Data not found !!!</td></tr>';
			}
			boiler+='</table>';
			$('#AllStudentotherFeeDetails').html(boiler);
			var varible='';
			if($('#customerHelper').val()=="RCOEM"){
				varible ='';
			}else{
				varible ='/Bank Challan';
			}
			if(eval(totalAmountToPay)>0){
				boiler ='<br><br><b><input type="checkbox" id="chkAgreeTermsMiscellaneous1" onclick="ProccedAcademicToPayother('+totalAmountToPay+',\'4\');">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b> '+
				'<span> You have chosen to pay an amount <b>Rs.</b> <span id="amtForOnlinePayment">'+totalAmountToPay+'</span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
				'<span style="font-weight:bold;color:red">*If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>'+

				'<br><div style="text-align:center" id="paymentPluginsDivForMS1"></div>'+
				'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueForMS1"></span>'+
				'<br><div id="onlinePaymentSpanForMS1" style="display:none;" >'+
					'<span style="text-align:center;" id="onlinePaymentSpanForMS21"></span>'+
				'</div>'+
				'<br><div id="onlinePaymentSpanForMSReva" style="display:none;">'+
					'<span id="onlinePaymentSpanREVAMiscRazor" class="span3"></span>&nbsp;&nbsp;'+
					'<span id="onlinePaymentSpanREVAMiscPaytm" class="span3"></span>&nbsp;&nbsp;'+
					'<span id="onlinePaymentSpanREVAMiscEasy" class="span3"></span>&nbsp;&nbsp;'+
				'</div>';
				$('#AllStudentotherFeeDetails').append(boiler);
			}
		}
	});
}
function otherfeeCondition(){
	if($('#customerHelper').val()!=undefined && $('#customerHelper').val()!="REVA_UNIVERSITY"){
		$('#onlinePaymentSpanForMS1').show();
		$('#paymentPluginsStudentFeeDueForMS1').hide();
	}else{
		$('#onlinePaymentSpanForMSReva').show();
		//$('#paymentPluginsStudentFeeDueForMS1').hide();
	}
}
function ProccedAcademicToPayother(totAmt, financePolicyId){
   var studenthostelfineIds = new Array();
    $('.clsotherMSstudentHosFineId:checked').each(function(){
    	studenthostelfineIds.push($(this).val());
    });
	if(financePolicyId==undefined)
		financePolicyId=0;
    
	if($('#chkAgreeTermsMiscellaneous1').is(':checked')){
		 
		var boiler = ''+
		'<input type="radio" class="" name="paymentMode" id="" value="" onclick="otherfeeCondition();" /><b> Online Payment &nbsp;&nbsp;&nbsp;</b>';
		/*'<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpan2\').show();$(\'#onlinePaymentSpan1\').hide();$(\'#paymentPluginsStudentFeeDue\').hide();" /><b> Online Payment 2 &nbsp;&nbsp;&nbsp;</b>';*/
		if($('#customerHelper').val()!="INDIRA_PUNE"){
			boiler +='<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpanForMS1\').hide();$(\'#paymentPluginsStudentFeeDueForMS1\').show();" /><b>Bank Challan&nbsp;&nbsp;&nbsp;</b>';
		}
		$('#paymentPluginsDivForMS1').html(boiler).show();
		if($('#customerHelper').val()=="DES"){
			$('#paymentPluginsDivForMS1').html(boiler).hide();
		}
		
		$.ajax({
			url : 'fetchOtherMiscStudentDetail.json',
			dataType : 'json',
			data:{ 
				studenthostelfineIds:studenthostelfineIds.toString(),
				financePolicyId:financePolicyId
			},
			async : false,
			beforeSend : function() {
				startCommonAjaxSpinner();
			},
			complete : function() {
				stopCommonAjaxSpinner();
			},
			success : function(jArray1) {
				if(jArray1.length>0){

					
					if($('#customerHelper').val()=="RCOEM"){
						/*$('#onlinePaymentSpanForMS2').ucoSPPymt({
							sPC : 'MISCF'
						});
						
						$('#onlinePaymentSpanForMS2').pymt({
							sPC : 'MISCF'
						});*/
						$('#onlinePaymentSpanForMS21').ccAvenuePymt2({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
						
					}else if($('#customerHelper').val()=="STJOHNS"){
						$('#onlinePaymentSpanForMS21').ccAvenue10Pymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"]
						});
					}else if($('#customerHelper').val()=="ICT_MUMBAI"){
						$('#onlinePaymentSpanForMS21').ccAvenuePymt({
							sPC : 'MISCF',
							iFBIDs:jArray1[0]["bankIds0"],
						});
					}else if($('#customerHelper').val()=="DES"){
						$('#onlinePaymentSpanForMS21').payUPymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"],
						});
					}else if($('#customerHelper').val()=="INDIRA_PUNE"){
						$('#onlinePaymentSpanForMS21').junoPymt({
							sPC : 'MISCF',
							iFBIDs :jArray1[0]["bankIds0"],
						});
					}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
						$('#onlinePaymentSpanForMS21').ccAvenue4Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
						$('#onlinePaymentSpanForMS21').techProcessPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
						$('#onlinePaymentSpanForMS21').junoPymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY"){
						$('#onlinePaymentSpanREVAMiscPaytm').payTM2Pymt({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
						$('#onlinePaymentSpanREVAMiscRazor').razor8Pymt({sPC:'MISCF'});
						$('#onlinePaymentSpanREVAMiscEasy').easyPayPymt({sPC:'MISCF'});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="GC_UNIVERSITY"){
						$('#onlinePaymentSpanForMS21').bdpymtV6({sPC:'MISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}
				}
			},
		});
		
		
	}else{
		$('#paymentPluginsDivForMS').hide();
		$('#onlinePaymentSpanForMS').hide();
		$('#paymentPluginsStudentFeeDueForMS').hide();
	}
}

function studentFine(studentid){
	$('#studentFinemodal').modal('show');
	var boiler=''+
	'<table class="table table-bordered table-condensed" id="studentFine">'+
	'<tr>'+
	'<th>Account For</th>'+
	'<td><select id="cmbAccountFor" class="perticular" onchange="getGstPercentage()"></select></td>'+
	'<th class="gems_currency_label">Amount</th>'+
	'<td><input type="text" id="txtFineAmnt"style="text-align: right"/><br><span id="errormsg"></span></td>'+
	'</tr>'+
	'<tr><td id="isGstTrueTble" colspan="4"></td></tr>'+
	'<tr>'+
	'<th>Description</th>'+
	'<td colspan="3"><textarea id="txtDesc"></textarea></td>'+
	'</tr>'+
	'<tr>'+
	'<td colspan="4"><input type="button" '+
	'	style="margin-left: 400px" onclick="saveStudentFineDetails('+studentid+')"'+
	'value="Save" class="btn btn-inverse btn-mini" />&nbsp;&nbsp;<input type="button" value="Close" class="btn btn-mini btn-danger" data-dismiss="modal"></td>'+
	'</tr>'+
	'</table>';

	$('#studentFinediv').html(boiler);
	$('#txtFineAmnt').numeric();
	var institutecourseId=$('#instCourseId').val();
	if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY")
		getStudentMiscellaneousAccountHeadList('4');
	else
		showStudentMiscellaneousAccountHead(institutecourseId);
}

function saveStudentFineDetails(studentid) {

	var totalamount=0;
	var studentId = studentid;
	var totalamount = $('#txtFineAmnt').val();
	var desc = $('#txtDesc').val();
	var accountHeadId = $('#cmbAccountFor').val();
	var instituteCourseId = $('#instCourseId').val();
	if (instituteCourseId != undefined) {
		instituteCourseId = instituteCourseId.split('-')[0];
	}
	if (instituteCourseId == undefined)
		instituteCourseId = $('#cmbAssocForDue').val();

	/*if (isNaN(amount)) {
		jAlert("Please Enter Valid an Amount...");
		return false;
	} else */if (studentId == "") {
		jAlert("Please Select Student...");
		return false;
	} else if (accountHeadId == "" || accountHeadId == "0") {
		jAlert("Please Select  Account Head...");
		return false;
	} else if (instituteCourseId == "") {
		jAlert("Please Select Department...");
		return false;
	}
	var occupantId = 0;
	var hostelPolicyId = 0;
	var hostelPlanId = 0;
	var totalIntegratedAmt=0;
	var totalCentralAmt=0;
	var totalSateAmt=0;
	var totalCessAmt=0;
	var totalVatAmt=0;

	totalVatAmt=$('#totVatAMt').text();
	if(totalVatAmt=="")
		totalVatAmt=0;
	var inegratedTax = $('#integratedTax').text();
	//var integratedMulAmt = $('#txtIntegratedAmnt').val();
	var totalIntegratedAmt = $('#totIntAmt').text();
	if(totalIntegratedAmt=="")
		totalIntegratedAmt=0;
	//totalIntegratedAmt = eval(totalIntegratedAmt);// + eval(integratedMulAmt);

	var centralTax = $('#centralTax').text();
	//var centralMulAmt = $('#txtCentralAmnt').val();
	var totalCentralAmt = $('#totCentralAmt').text();
	if(totalCentralAmt=="")
		totalCentralAmt=0;
	//totalCentralAmt = eval(totalCentralAmt);// + eval(centralMulAmt);

	var stateTax = $('#stateTax').text();
	//var stateMulAmt = $('#txtstateAmnt').val();
	var totalSateAmt = $('#totStateAmt').text();
	if(totalSateAmt=="")
		totalSateAmt=0;
	//totalSateAmt = eval(totalSateAmt);// + eval(stateMulAmt);

	var cessTax = $('#cessTax').text();
	//var cessMulAmt = $('#txtCessAmnt').val();
	var totalCessAmt = cessTax * totalamount / 100;
	if(totalCessAmt=="")
		totalCessAmt=0;
	//totalCessAmt = eval(totalCessAmt);// + eval(cessMulAmt);

/*	if(integratedMulAmt==""){
		jAlert("Please Enter Integrated Amount");
		return false;
	}

	if(centralMulAmt==""){
		jAlert("Please Enter Central Amount");
		return false;
	}

	if(stateMulAmt==""){
		jAlert("Please Enter State Amount");
		return false;
	}

	if(cessMulAmt==""){
		jAlert("Please Enter Cess Amount");
		return false;
	}*/

	/*$('.allTaxTotalAmtCls').each(function(){
		var totalamount1 = $(this).text();
		totalamount += eval(totalamount1);
	});*/
	totalamount = $('#totalAllAmtId').text();
	if(totalamount=="")
		totalamount = $('#txtFineAmnt').val();
	if(desc==""){

		desc="(Integrated Tax is : "+inegratedTax+" Total Amount is : "+totalIntegratedAmt+")"+
		"(Central Tax is : "+centralTax+" Total Amount is : "+totalCentralAmt+")"+
		"(State Tax is : "+stateTax+" Total Amount is : "+totalSateAmt+")"+
		"(Cess Tax is : "+cessTax+" Total Amount is : "+totalCessAmt+")";
	}

	$.ajax({
		url : 'saveStudentFineDetailsByStudent.json',
		dataType : 'text',
		type : 'POST',
		data:{
			studentId:studentId,
			amount:totalamount,
			desc:desc,hostelPlanId: hostelPlanId,
			occupantId:occupantId,
			accountHeadId:accountHeadId,
			instituteCourseId:instituteCourseId,
			totalIntegratedAmt:totalIntegratedAmt,
			totalCentralAmt:totalCentralAmt,
			totalSateAmt:totalSateAmt,
			totalVatAmt:totalVatAmt
		},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function() {
			$('#txtFineAmnt').val('');
			$('#txtDesc').val('');
			$('#cmbStudentId').val(0).trigger("liszt:updated");
			jAlert("Details saved successfully..", "Message");
			$('#studentFinemodal').modal('hide');
			getStudentotherFeeDetails();

		},
		error : function() {
			jAlert("Error...!");
		}
	});
}

function showStudentMiscellaneousAccountHead(institutecourseId) {

	var instituteCourseId =institutecourseId;
	/* if(instituteCourseId != 0)
		{
		jAlert("Please Select Department");
		return false;
		}
	if(instituteCourseId !=undefined){
		instituteCourseId =instituteCourseId.split('-')[0];
	} */

	if (instituteCourseId != undefined) {
		instituteCourseId = instituteCourseId.split('-')[0];
	}
	if (instituteCourseId == undefined)
		instituteCourseId = $('#cmbAssocForDue').val();

	$.ajax({
		url : 'getAccountHeadByAccountHeadTypeForAcademic.json?headType=AccountHead_Student_Miscellaneous&instituteCourseId='+ instituteCourseId,
		dataType : 'json',
		async : false,
		success : function(jArray) {
			var boiler = '<option value="0">Select</option>';
			for ( var i = 0; i < jArray.length; i++)
				boiler += '<option value="'+jArray[i].accountHeadId+'" isGstApplicable="'+jArray[i].isGSTApplicable+'">'
				+ jArray[i].accountHeadName + '</option>';

			$('#cmbAccountFor').html(boiler);
			convertComboToSearchable('#cmbAccountFor');
		},
		error : function() {
			jAlert("Something went wrong, Please try after some time");
		}
	});
}

function showStudentOverallFeeDemandDetailsBySemesterId(){

	var studentId=0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	var statusflag=true;
		var hdAuth = $('#hdAuth').val();
		var url = 'checkStudentFeeStructureStatus.json?studentId='+studentId;
		if(hdAuth == "student" || hdAuth == "Student"){
			url = 'stu_checkStudentFeeStructureStatus.json';
		}
		$.ajax({
			url:url, 
			dataType:'json',
			beforeSend: function() {
				startCommonAjaxSpinner();
			},
			complete: function() {
				stopCommonAjaxSpinner();
			},
			success:function(jArray){
				if(jArray.status=='Notrestructure'){
					
					$('#divSemsterIds').show();
					$('#feeDemandDetails').show()
					$.ajax({
						url:'getSemsterListByStudentId.json',
						dataType:'json',
						async:false,
						beforeSend:function() {
							startCommonAjaxSpinner();
						},
						complete: function() {
							stopCommonAjaxSpinner();
						},
						success:function(jObj){
							var boiler='<table class="table table-bordered table-condensed" id="" ><tr><th>Semster Name</th><td><select id="semsterIdsSel" onchange="feeDemandDetailsSaveBySemsterId(this)"><option value="0">Select</option>';

							var noOfSemId = 1;
							var noOfSem = jObj["semsterName"];
							for(var i=0;i<noOfSem;i++){
								boiler+='<option value="'+noOfSemId+'">'+integer_to_roman(eval(i+1))+'</option>';
								noOfSemId++;
							}
							boiler+='</select></td></tr></table>';
							$('#divSemsterIds').html(boiler);
						},
					});
				}else{
					jAlert('Your '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' is under process please contact your finance Department');
					$('#acadfee').attr('class','accordion-toggle');
					$('#divSemsterIds').hide();
					$('#feeDemandDetails').hide();
				}

			}
		});
	
}

function downloadDemand(semester){
	window.location.replace("downloadstudentFeeInvoiceDemandbyStudent.json?semester="+semester);
}
function feeDemandDetailsSaveBySemsterId(src){

	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	
	var semsterId = $('#semsterIdsSel option:selected').val();
	$.ajax({
		url:'feeDemandDetailsSaveBySemsterId.json',
		data:{semsterId:semsterId},
		dataType:'json',
		async:false,
		beforeSend:function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(mainjArray){

			//if(mainjArray[0].isshowtostudent=='Yes'){
				var totalSFIAmount = "0.0";
				var totalAmountPaid = "0.0";
				var totalRemLgcy = "0.0";
				var totalRemLateFee = "0.0";
				var totalSchlrship = "0.0";
				var totalAmount1 = "0.0";
				var totalAmount2 = "0.0";
				var totalAmount3 = "0.0";
				var balance = "0.0";
				var totalFeePaid ="0.0";
				var totalBalance="0.0";
				var schBalance ="0.0";
				var schPaid = "0.0";
				var schPaidBalance ="0.0";
				var studentFeesInvoiceId=0;
				var totalschAmt = "0.0";
				var addtotalAMt="0.0";
				var toBalan="0.0";
				var totamountExcess="0.0";
				var totAmtRemEx="0.0";
				var totSchAm="0.0";
				
				var studFeeInvoiceArr;
				var sfiPaidjArray ;
				var lgcyRemjArray ;
				var lateFeesArr ;
				var scholershipArr ;
				var schDetailsArray ;
				var schNameArray ;
				var feePaidArray ;
				var schPaidArray ;
				var feeHeadsjArray;
				var semesterName;
				var semester=0;
				var schFeeHeadjArray;
				var cfPrevSemAdArray;
				var lastPaymentDate;
				var boiler='<table class="table table-bordered table-condensed" id=""><tr><th colspan="6">Student Demand</th></tr>';
				if(mainjArray.length>0){
					boiler+='<div><spam id="ReceiptSpam"></spam></div>';
					for(var i=0;i<mainjArray.length;i++){
						studFeeInvoiceArr = mainjArray[i]["studFeeInvoiceArr"];
						sfiPaidjArray = mainjArray[i]["sfiPaidjArray"];
						lgcyRemjArray = mainjArray[i]["lgcyRemjArray"];
						lateFeesArr = mainjArray[i]["lateFeesArr"];
						scholershipArr = mainjArray[i]["scholershipArr"];
						schDetailsArray = mainjArray[i]["schDetailsArray"];
						schNameArray = mainjArray[i]["schNameArray"];
						feePaidArray = mainjArray[i]["feePaidArray"];
						schPaidArray = mainjArray[i]["schPaidArray"];
						feeHeadsjArray= mainjArray[i]["feeHeadsjArray"];
						semesterName=mainjArray[i]["semName"];
						semester=mainjArray[i]["semId"];
						schFeeHeadjArray=mainjArray[i]["schFeeHeadjArray"];
						cfPrevSemAdArray =mainjArray[i]["cfPrevSemAdArray"];
						lastPaymentDate=mainjArray[i]["lastPaymentDate"];
						var scholershipName = "";
						if(schNameArray.length>0){
							for(var n=0;n<schNameArray.length;n++){
								scholershipName+='Scholarship Name :'+schNameArray[n]["scholarshipName"]+'';
							}
						}
						
						boiler+='<tr style="display:none;"><td colspan="6"><input type="button" value="Download Demand" class="btn btn-inverse btn-mini pull-right" onclick="downloadDemand('+semester+');"></td></tr>';
						
						if(scholershipName!="")
							boiler+='<tr><th colspan="6">Student Demand for semester '+semesterName+" [ "+scholershipName+']</th></tr>';
						else
							boiler+='<tr><th colspan="6">Student Demand for semester '+semesterName+' (Last Payment Date : '+lastPaymentDate+' )</th></tr>';
						
						boiler+='<tr><th>Sr. No.</th><th>Particulars</th><th class="gems_currency_label">Amount</th><th class="gems_currency_label">Scholarship Awarded</th><th class="gems_currency_label">Fee Paid</th><th class="gems_currency_label">Balance</th></tr>';
						
						if(studFeeInvoiceArr.length>0){
							totalSFIAmount=0;
							totalFeePaid=0;
							totalBalance=0.00;
							schPaid=0.0;
							totalSchlrship=0.0;
							totalschAmt=0.0;
							addtotalAMt=0.0;
							totamountExcess=0.0;
							totAmtRemEx=0.0;
							totSchAm=0.0;
							
							for(var s=0;s<studFeeInvoiceArr.length;s++){
								var feeItemId = studFeeInvoiceArr[s]["feeItemId"];
								studentFeesInvoiceId=studFeeInvoiceArr[s]["studentInvoiceId"];
								for(var fp=0; fp<feePaidArray.length;fp++){
									var feeItemIdFeePaid = feePaidArray[fp]["feeItemId"];
									var semesterFeePId = feePaidArray[fp]["semesterFeePId"];
									if(feeItemId==feeItemIdFeePaid ){
										totalSFIAmount = eval(totalSFIAmount) + eval(studFeeInvoiceArr[s]["amount"]);
										balance = eval(studFeeInvoiceArr[s]["amount"]) - eval(feePaidArray[fp]["feePaidAmount"]);
										boiler+='<tr>'+
										'<td style="text-align:right">'+(s+1)+'</td>'+
										'<td>'+studFeeInvoiceArr[s]["accountName"]+'</td>'+
										'<td class="gems_currency">'+studFeeInvoiceArr[s]["amount"]+'</td>';

										boiler+='<td class="gems_currency">'+studFeeInvoiceArr[s]["schpnshipAmout"]+'</td>';
										totSchAm += eval(studFeeInvoiceArr[s]["schpnshipAmout"]);
										addtotalAMt = eval(feePaidArray[fp]["feePaidAmount"]) + studFeeInvoiceArr[s]["schpnshipAmout"];
										toBalan = eval(studFeeInvoiceArr[s]["amount"]) - addtotalAMt;
										boiler+='<td class="gems_currency">'+feePaidArray[fp]["feePaidAmount"]+'</td>';

										if(studFeeInvoiceArr[s]["amount"]<addtotalAMt)
											boiler+='<td style="text-align:right"><b>(-)'+Math.abs(toBalan)+' </b></td>';
										else
											boiler+='<td class="gems_currency">'+toBalan+'</td>';

										boiler+='</tr>';
										totalFeePaid += eval(feePaidArray[fp]["feePaidAmount"]);
									}
								}
								
								for(var fp=0; fp<feeHeadsjArray.length;fp++){
									var feeItemIdFeePaidAS = feeHeadsjArray[fp]["feeItemId"];
									if(feeItemId==feeItemIdFeePaidAS ){
										totalSFIAmount  += eval(studFeeInvoiceArr[s]["amount"]);
										balance = eval(studFeeInvoiceArr[s]["amount"]);
										
										totalFeePaid += 0.00;
										
										totSchAm+= eval(studFeeInvoiceArr[s]["schpnshipAmout"]);
										addtotalAMt = 0.00 + studFeeInvoiceArr[s]["schpnshipAmout"];
										toBalan = eval(studFeeInvoiceArr[s]["amount"]) - addtotalAMt;
										
										boiler+='<tr>'+
										'<td style="text-align:right">'+(s+1)+'</td>'+
										'<td>'+studFeeInvoiceArr[s]["accountName"]+'</td>'+
										'<td class="gems_currency">'+studFeeInvoiceArr[s]["amount"]+'</td>'+
										'<td class="gems_currency">'+studFeeInvoiceArr[s]["schpnshipAmout"]+'</td>'+
										'<td class="gems_currency">0.00</td>'+
										'<td class="gems_currency">'+toBalan+'</td>'+
										'</tr>';
										
									}
								}
								
								totalBalance = eval(totalBalance) + eval(toBalan);
							}
							boiler+='<tr>'+
							'<th colspan="2" style="text-align:right">TOTAL </th>'+
							'<td class="gems_currency">'+totalSFIAmount+'</td>'+
							'<td class="gems_currency">'+totSchAm+'</td>'+
							'<td class="gems_currency">'+totalFeePaid+'</td>'+
							'<td class="gems_currency">'+totalBalance+'</td>'+
							'</tr>';
						}
												/*if(sfiPaidjArray.length>0){
							for(var p=0;p<sfiPaidjArray.length;p++){
								if(sfiPaidjArray[p]["paidAmount"]!="undefined"){
									boiler+='<tr>'+
									'<th colspan="2" style="text-align:right">Less: Amount Paid</th>'+
									'<td class="gems_currency">'+sfiPaidjArray[p]["paidAmount"]+'</td>'+
									'<td class="gems_currency"></td>'+
									'<td class="gems_currency"></td>'+
									'</tr>';

									totalAmountPaid = sfiPaidjArray[p]["paidAmount"];
								}
							}
						}*/

						if(lgcyRemjArray.length>0){
							for(var r=0;r<lgcyRemjArray.length;r++){
								if(lgcyRemjArray[r]["remaninglegacy"]!="undefined"){
									boiler+='<tr>'+
									'<th colspan="2" style="text-align:right">Add / Less: Previous Semester Adjustment</th>'+
									'<td class="gems_currency">'+lgcyRemjArray[r]["remaninglegacy"]+'</td>'+
									'<td class="gems_currency"></td>'+
									'<td class="gems_currency"></td>'+
									'</tr>';
									totalRemLgcy =  lgcyRemjArray[r]["remaninglegacy"];
								}
							}
						}


						if(lateFeesArr.length>0){
							for(var l=0;l<lateFeesArr.length;l++){
								if(lateFeesArr[l]["remaningLatelegacy"]!="undefined"){
									boiler+='<tr>'+
									'<th colspan="2" style="text-align:right"> Late Fees As on Date</th>'+
									'<td class="gems_currency">'+lateFeesArr[l]["remaningLatelegacy"]+'</td>'+
									'<td class="gems_currency">0</td>'+
									'<td class="gems_currency">'+lateFeesArr[l]["lateFeesAmountPaid"]+'</td>'+
									'<td class="gems_currency">'+lateFeesArr[l]["lateFeesAmountBalance"]+'</td>'+
									'</tr>';
									totalRemLateFee = lateFeesArr[l]["remaningLatelegacy"];
								}
							}
						}

						/*if(schDetailsArray.length>0){
							schBalance=0;
							schPaid=0;
							schPaidBalance=0;
							for(var d=0;d<schDetailsArray.length;d++){
								var studFeeInvoSchFeeId = schDetailsArray[d]["studFeeInvoSchFeeId"];
								var semsterSchFeeId =schDetailsArray[d]["semsterSchFeeId"];
								var feeItemScholarshipId =schDetailsArray[d]["feeItemScholarshipId"];
								
								if(schPaidArray.length>0){
									for(var sp=0;sp<schPaidArray.length;sp++){
										var studentFeeInSchPaidId = schPaidArray[sp]["studentFeeInSchPaidId"];
										var semesterSchPaidId = schPaidArray[sp]["semesterSchPaidId"];
										var schPaidAmount = schPaidArray[sp]["schPaidAmount"];
										var feeItemScholarshipIdPaid =schPaidArray[sp]["feeItemScholarshipIdPaid"];
										
										if(studFeeInvoSchFeeId==studentFeeInSchPaidId && semsterSchFeeId==semesterSchPaidId && feeItemScholarshipIdPaid== feeItemScholarshipId){
											schBalance = eval(schDetailsArray[d]["scholershipAmt"]) - eval(schPaidAmount);
											boiler+='<tr>'+
											'<td style="text-align:right">'+(d+1)+'</td>'+
											'<td>'+schDetailsArray[d]["accountName"]+'</td>'+
											'<td style="text-align:right" class="gems_currency">'+schDetailsArray[d]["scholershipAmt"]+'</td>'+
											'<td class="gems_currency">'+schPaidAmount+'</td>'+
											'<td class="gems_currency">'+schBalance+'</td>'+
											'</tr>';
											
											schPaid += eval(schPaidAmount);
											schPaidBalance +=  eval(schBalance);
										}
									}
								}else{
									for(var sp=0;sp<schFeeHeadjArray.length;sp++){
										var studentFeeInSchPaidId = schFeeHeadjArray[sp]["studFeeInvoSchFeeId"];
										if(studFeeInvoSchFeeId==studentFeeInSchPaidId ){
											schBalance = eval(schDetailsArray[d]["scholershipAmt"]);
											boiler+='<tr>'+
											'<td style="text-align:right">'+(d+1)+'</td>'+
											'<td>'+schDetailsArray[d]["accountName"]+'</td>'+
											'<td style="text-align:right" class="gems_currency">'+schDetailsArray[d]["scholershipAmt"]+'</td>'+
											'<td class="gems_currency">0.00</td>'+
											'<td class="gems_currency">'+eval(schDetailsArray[d]["scholershipAmt"])+'</td>'+
											'</tr>';
											
											schPaid=0.00;
											schPaidBalance = 0.00;
										}
									}
								}
							}
						}

						if(scholershipArr.length>0){
							for(var h=0;h<scholershipArr.length;h++){
								if(scholershipArr[h]["scholarshipAmount"]!="undefined"){
									boiler+='<tr>'+
									'<th colspan="2" style="text-align:right">Less: - Scholarship Awarded (B)</th>'+
									'<td class="gems_currency">'+scholershipArr[h]["scholarshipAmount"]+'</td>'+
									'<td class="gems_currency">'+schPaid+'</td>'+
									'<td class="gems_currency">'+eval(scholershipArr[h]["scholarshipAmount"]-schPaid)+'</td>'+
									'</tr>';

									totalSchlrship = scholershipArr[h]["scholarshipAmount"];
								}
							}
						}*/
						
						var totalamount = eval(totalSFIAmount) - eval(totalSchlrship);
						var totalSchPaid = eval(totalFeePaid) - eval(schPaid);
						
						/*boiler+='<tr>'+
						'<th colspan="2" style="text-align:right"> '+semesterName+' Semester fee Total (A-B)</th>'+
						'<td class="gems_currency">'+totalamount+'</td>'+
						'<td class="gems_currency">'+totalSchPaid+'</td>'+
						'<td class="gems_currency">'+(totalamount-totalSchPaid)+'</td>'+
						'</tr>';*/
						
						if(cfPrevSemAdArray.length>0){
							for(var cf=0;cf<cfPrevSemAdArray.length;cf++){
								if(cfPrevSemAdArray[cf]["amountRemaining"]!=0.0 ){
									totamountExcess = eval(cfPrevSemAdArray[cf]["amountRemaining"]) + totalBalance;
									boiler+='<tr><th colspan="2" style="text-align:right">C/F-Previous Semester Adjustment</th><td colspan="4" class="gems_currency">'+cfPrevSemAdArray[cf]["amountRemaining"]+'</td></tr>';
								}
								
								if(cfPrevSemAdArray[cf]["amountExcess"]!=0.0){
									totamountExcess =   totalBalance-eval(cfPrevSemAdArray[cf]["amountExcess"]);
									boiler+='<tr><th colspan="2" style="text-align:right">C/F-Previous Semester Adjustment</th><td colspan="4" class="gems_currency">-'+cfPrevSemAdArray[cf]["amountExcess"]+'</td></tr>';
								}
								
								if(cfPrevSemAdArray[cf]["amountRemaining"]!=0.0 && cfPrevSemAdArray[cf]["amountExcess"]!=0.0){
									totAmtRemEx = eval(cfPrevSemAdArray[cf]["amountRemaining"]) + totalBalance;
									totamountExcess = totAmtRemEx - cfPrevSemAdArray[cf]["amountExcess"];
								}
								boiler+='<tr><th colspan="2" style="text-align:right">Total</th><td colspan="4" class="gems_currency">'+totamountExcess+'</td></tr>';
							}
						}

						totalAmount1 = eval(totalSFIAmount) +  eval(totalRemLateFee) + eval(totalRemLgcy); // Add
						totalAmount2 =  eval(totalSchlrship); // Less
						totalAmount3 = totalAmount1 - totalAmount2;

						/*boiler+='<tr><th colspan="2" style="text-align:right">Total Fees: </th><td class="gems_currency"><b>'+totalAmount3+
						'</b></td><td class="gems_currency">'+eval(totalSchPaid)+'</td>'+
						'<td class="gems_currency">'+eval(totalBalance-schPaidBalance)+'</td></tr>';*/
						boiler+='<tr><td colspan="6" style="height:40px"></td></tr>';
						
						
						
						onlinePaymentText(totalAmount3);
					}
					
					var EnrollmentNo=mainjArray[0]["studentuniqueId"]!=undefined && mainjArray[0]["studentuniqueId"]!='-'?mainjArray[0]["studentuniqueId"]:mainjArray[0]["studentuniqueNo"];
					/*var boilerq='<br><br><b>· “BMLUNI” is e-collect code allocated for BML Munjal University.<br>';

					boilerq+='· Beneficiary Account Number :   <span style="color:red;font-size:12px;">BMLUNI'+EnrollmentNo+'</span><br>';

					boilerq+='· Beneficiary Name : BML Munjal University<br>';

					boilerq+='· IFS Code : YESB0CMSNOC<br>';

					boilerq+='· Bank Name : Yes Bank<br>';

					boilerq+='· Branch : Worli, Mumbai <br><br><br></b>';
					$('#bankdetails').html(boilerq);*/
				}else{
					boiler+='<tr><td colspan="5">No Data Found..<td></tr>';
				}
				boiler+='</table>';
				$('#studDemandDiv').html(boiler);				
			$('#ReceiptSpam').html('<input type="button" value="Receipts" class="btn btn-mini btn-inverse  btnColorBlack " onclick="studentBillingInfo(\''+studentFeesInvoiceId+'\');">');
		},
	});
}

function integer_to_roman(num) {
	if (typeof num !== 'number') 
	return false; 

	var digits = String(+num).split(""),
	key = ["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM",
	"","X","XX","XXX","XL","L","LX","LXX","LXXX","XC",
	"","I","II","III","IV","V","VI","VII","VIII","IX"],
	roman_num = "",
	i = 3;
	while (i--)
	roman_num = (key[+digits.pop() + (i * 10)] || "") + roman_num;
	return Array(+digits.join("") + 1).join("M") + roman_num;
}

function onlinePaymentText(totalAmount3){

	var boiler='<b>Enter Amount :</b>&nbsp;&nbsp;&nbsp;<input type="text" id="txtPaymentAmt" style="text-align:right" >';
	//$('#onlinePaymentDiv').html(boiler);

	$("#txtPaymentAmt").keypress(function (e) {
		var keyCode = e.which ? e.which : e.keyCode;
		var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
		return result;
	});

	$(function() {
		$('#txtPaymentAmt').keyup(function(e) {
			if(e.keyCode == 13) {
				selectOnlinePayment(totalAmount3);
			}
		});
	});	
}

function selectOnlinePayment(totalAmount3){
	var paymentAmount = $('#txtPaymentAmt').val();
	var semsterId = $('#semsterIdsSel option:selected').val();
	
	if(paymentAmount!="" && semsterId!=0 && (paymentAmount==totalAmount3 || paymentAmount<totalAmount3 ) ){
		var boiler ='<input type="radio" value="OnlinePayment" name="onlinePymnt" onclick="makeStudentFeeDemandOnlinePayment('+paymentAmount+','+semsterId+')">&nbsp;<b>Online Payment</b>'+
		'<br><div style="text-align:center;" id="paymentPluginsDiv1"></div><div style="text-align:center;display:none;" id="paymentPluginsDiv"></div>'+
		'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDue"></span>'+
		'<br><div id="onlinePaymentSpan" style="display:none;">'+
		'<span style="text-align:center;" id="onlinePaymentSpan2"></span>'+
		'<div>';
		$('#bttnonlinePaymentDiv').html(boiler);
	}else{
		jAlert("Please Enter Valid Amount");
		$('#bttnonlinePaymentDiv').html('');
	}
}

function makeStudentFeeDemandOnlinePayment(paymentAmount,semsterId){
	$.ajax({      
		url:'makeStudentFeeDemandOnlinePayment.json',
		data:{paymentAmount:paymentAmount,semsterId:semsterId},
		dataType:'json',
		async:false,
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){	
			$('#onlinePaymentSpan').show();
			if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="BLM_MUNJAL"){
				//$('#onlinePaymentSpan').ccAvenue4Pymt({sPC:'TRNSPT',iFBIDs:jArray["bankIds0"]});
			}
		},
		error:function(){
			jAlert("No Records","Error");
		}
	});
}

function getStudentPaymentDetails(src){
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
		
	$('#chkAgreeTermsAcademicBML').attr('checked',false);
	ProccedAcademicToPayforBML();
	
	$.ajax({      
		url:'getStudentPaymentDetails.json',
		data:{},
		dataType:'json',
		async:false,
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(mainJArray){
			var jArray=mainJArray[0];
			
			var boiler='<br><br><table class="table table-bordered table-striped table-condensed" style="width:100%;" id="studentOfflinePaymentDetails1">'+
			'<tr><th>Sr. No.</th><th></th><th>Particulars</th><th class="gems_currency_label">'+juno.labelByCustomer('l.isInvoceToFeesLabel')+' Amount</th><th class="gems_currency_label">Amount In-process</th><th class="gems_currency_label">Payment Amount</th></tr>';
			if(jArray.length>0){
				for(var i=2;i<jArray.length;i++){
					var feeHeads = 'amtstud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "");
                    var type='checkBox';
					boiler+='<tr class="trstudentFeeStructure">'+
					//'<input class="feeItemId" type="hidden" accountHeadid="'+jArray[i]["accountHeadId"]+'" value="'+jArray[i]["feeItemId"]+'">'+
					'<td style="text-align:right">'+(i-1)+'</td>';
					if(jArray[i]["unitPrice"]!="0.0"){
						boiler+='<td style="text-align:center" id="chk_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'">'+
						'<input type="checkbox" types="'+jArray[i]["academics"]+'" class="claAmt chk_'+jArray[i]["studentExceptionInvoiceId"]+'" feeHead="chk_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" value="'+jArray[i]["studentExceptionInvoiceId"]+'" id="'+jArray[i]["studentExceptionInvoiceId"]+'_'+jArray[i]["academics"]+'" onclick="calculateAmount(\''+type+'\','+jArray[i]["studentExceptionInvoiceId"]+',\''+feeHeads+'\')"></td>';
					}else{
						boiler+='<td style="text-align:center"></td>';
					}
					
					boiler+='<td id="desc_'+jArray[i]["studentExceptionInvoiceId"]+'">'+jArray[i]["description"]+'</td>'+
					'<td class="gems_currency amt_'+jArray[i]["studentExceptionInvoiceId"]+' invAmts" id="amtsStud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" style="text-align:right">'+jArray[i]["unitPrice"]+'</td>'+
					'<td class="gems_currency inp_'+jArray[i]["studentExceptionInvoiceId"]+' amtInProces" id="amtstud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" style="text-align:right"></td>'+
					'<td class="editamt paymentAmts" id="editamt_'+jArray[i]["studentExceptionInvoiceId"]+'" style="text-align:right"></td>'+
					'</tr>';
				}
				boiler+='<tr><td colspan="3" style="text-align:right" class="gems_currency_label">Total</td><td id="invAmts" class="gems_currency"></td><td id="amtInProces" class="gems_currency"></td><td id="paymentAmts" class="gems_currency"></td></tr>';
			}else{
				boiler+='<tr><td colspan="2">Data Not Found</td></tr>';
			}
			boiler+='</table>';
			$('#AllStudentPaymentDetails').html(boiler);
			$('.claAmt').trigger('onclick');
			//$('.claAmts').trigger('onclick');
			
			if(jArray.length>0 && jArray[1].length>0){
				for(var i=0;i<jArray[1].length;i++){
					var studId = jArray[1][i]["studId"];
					var feeHeads = jArray[1][i]["feeHeads"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "");
					var amount = jArray[1][i]["amount"]!=undefined && jArray[1][i]["amount"]!='' ? eval(jArray[1][i]["amount"]):0;;
					var amt = $('#amtsStud_'+feeHeads).text()!=undefined && $('#amtsStud_'+feeHeads).text()!='' ? eval($('#amtsStud_'+feeHeads).text()):0;
					$('#amtstud_'+feeHeads).text(amount);
					console.log(amt+':::'+amount);
					if((amt-amount)==0 || amt == 0){
						$('#chk_'+feeHeads).text('');
					}
				}
			}
			
			var invAmts = 0;
			$('.invAmts').each(function(){
				var tmp = $(this).text()!=undefined && $(this).text()!='' ? $(this).text() :'0';
				invAmts +=eval(tmp);
			});
			$('#invAmts').text(invAmts);
			
			var amtInProces = 0;
			$('.amtInProces').each(function(){
				var tmp = $(this).text()!=undefined && $(this).text()!='' ? $(this).text() :'0';
				amtInProces +=eval(tmp);
			});
			$('#amtInProces').text(amtInProces);
		},
		error:function(){
			jAlert("No Records","Error");
		}
	});
}

function getStudentPaymentDetails1(src){
	
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	$('#chkAgreeTermsAcademicBMLoffline').attr('checked',false);
	ProccedAcademicToPayforBMLoffline();
	$.ajax({      
		url:'getStudentPaymentDetails.json',
		data:{},
		dataType:'json',
		async:false,
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(mainJArray){
			var jArray=mainJArray[0];
			var boiler ='<br><br><table class="table table-bordered table-striped table-condensed" style="width:100%;" id="">'+
			'<tr><th>Sr. No.</th><th>UTR Code</th><th>Bank Name</th><th>IFSC No</th><th>Type</th><th>Payment Date</th><th>Settled Voucher No</th><th>Particulars</th><th>Action</th></tr>';
			
			if(jArray.length>0 && jArray[0].length>0){
				for(var i=0;i<jArray[0].length;i++){
//                    var type='checkBox';
					boiler+='<tr class="trstudentFeeStructure">'+
					//'<input class="feeItemId" type="hidden" accountHeadid="'+jArray[i]["accountHeadId"]+'" value="'+jArray[i]["feeItemId"]+'">'+
					'<td style="text-align:right">'+(i+1)+'</td>'+
					'<td>'+jArray[0][i]["utrCode"]+'</td>'+
					'<td>'+jArray[0][i]["bankName"]+'</td>'+
					'<td>'+jArray[0][i]["ifscCode"]+'</td>'+
					'<td>'+jArray[0][i]["type"]+'</td>'+
					'<td>'+jArray[0][i]["paymentDate"]+'</td>'+
					'<td>'+jArray[0][i]["settledVoucherNo"]+'</td>'+
					'<td>'+jArray[0][i]["feeHeads"]+'</td>'+
					'<td>';
					
					if(jArray[0][i]["settledVoucherNo"]==''){
						boiler+='<a style="cursor:pointer;" onClick="deleteOfflineStudentPaymentEntry(\''+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'\');" id="linkDelete_'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" onlineTransactionPaymentSplitDetailsId="'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" title="Delete"><i class="fa fa-trash-o fa-1x"></i>&nbsp;</a>&nbsp;&nbsp;';

					if(jArray[0][i]["isPutForFinance"]!='Yes'){
						boiler+='<a style="cursor:pointer;" onlineTransactionPaymentSplitDetailsId="'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" id="linkFinanceApproval_'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" onClick="putForFinanceOfflineStudentPaymentEntry(\''+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'\');" title="Put for Finance"><i class="fa fa-share-square-o fa-1x"></i>&nbsp;</a>';
					}else{
						boiler +='<label>Sent to Finance Authority</label>';
					}
					
					}else{
						boiler+='<label>Accepted by Finance Authority</label>';
					}
					boiler+='</td>'+
					'</tr>';
				}

			}else{
				boiler+='<tr><td colspan="2">Data Not Found</td></tr>';
			}
			boiler+='</table>';
			
			$('#AllStudentPaymentDetailsoffline').html(boiler);
           var EnrollmentNo="";
			var boiler='<br>'+
			(jArray.length>2?'<div><input type="checkbox" class="" id="ckbPayExceedFees" onclick="payExceedFee()">&nbsp;&nbsp;<b>Please Select for Excess Fee ?</b></div>'+
					'<div><b>Select the checkbox for the fees you want to pay.</b></div>':'')+
			'<br><table class="table table-bordered table-striped table-condensed" style="width:100%;" id="studentOfflinePaymentDetails">'+
			'<tr><th>Sr. No.</th><th></th><th>Particulars</th><th class="gems_currency_label">'+juno.labelByCustomer('l.isInvoceToFeesLabel')+' Amount</th><th class="gems_currency_label">Amount In-process</th><th class="gems_currency_label">Payment Amount</th></tr>';
			if(jArray.length>0){
				for(var i=2;i<jArray.length;i++){
					var feeHeads = 'amtstud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "");
                    var type='checkBox';
					boiler+='<tr class="trstudentFeeStructure">'+
					//'<input class="feeItemId" type="hidden" accountHeadid="'+jArray[i]["accountHeadId"]+'" value="'+jArray[i]["feeItemId"]+'">'+
					'<td style="text-align:right">'+(i-1)+'</td>';
					if(jArray[i]["unitPrice"]!="0.0"){
						boiler+='<td style="text-align:center" id="chk_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'"><input type="checkbox" types="'+jArray[i]["academics"]+'" class="claAmts chks_'+jArray[i]["studentExceptionInvoiceId"]+'" feeHead="chk_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" value="'+jArray[i]["studentExceptionInvoiceId"]+'" id="'+jArray[i]["studentExceptionInvoiceId"]+'_'+jArray[i]["academics"]+'" onclick="calculateAmounts(\''+type+'\','+jArray[i]["studentExceptionInvoiceId"]+',\''+feeHeads+'\');"></td>';
					}else{
						boiler+='<td style="text-align:center"></td>';
					}
					EnrollmentNo=jArray[i]["studentuniqueId"]!=undefined && jArray[i]["studentuniqueId"]!='-'?jArray[i]["studentuniqueId"]:jArray[i]["studentuniqueNo"];
					boiler+='<td id="desc_'+jArray[i]["studentExceptionInvoiceId"]+'">'+jArray[i]["description"]+'</td>'+
					'<td class="gems_currency amts_'+jArray[i]["studentExceptionInvoiceId"]+' invAmt" id="amtsStud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" style="text-align:right">'+jArray[i]["unitPrice"]+'</td>'+
					'<td class="gems_currency amtInProcess amtInProcess_'+jArray[i]["studentExceptionInvoiceId"]+'" id="amtstud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" style="text-align:right"></td>'+
					'<td class="editamt paymentAmt" id="editamts_'+jArray[i]["studentExceptionInvoiceId"]+'" style="text-align:right"></td>'+

					//'<td></td>'+
					'</tr>';
				}
				boiler+='<tr id="trPayExceedFees" style="display:none"><td colspan="3" style="text-align:right" class="gems_currency_label">Excess Fee Amount</td><td colspan="3" id="paymentExceed" class="gems_currency" style="text-align:right"><input id="txtPayExceedFees" class="gems_currency" style="width:90px;text-align:right;" onkeyup="calculateAmountAccess();" type="text" value="0"></td></tr>';
				boiler+='<tr><td colspan="3" style="text-align:right" class="gems_currency_label">Total</td><td id="invAmt" class="gems_currency"></td><td id="amtInProcess" class="gems_currency"></td><td id="paymentAmt" class="gems_currency"></td></tr>';

			}else{
				boiler+='<tr><td colspan="2">Data Not Found</td></tr>';
			}
			boiler+='</table>';
			
			/*if($('#customerHelper').val()=="BLM_MUNJAL"){

				boiler+='<br><br><b>· “BMLUNI” is e-collect code allocated for BML Munjal University.<br>';

				boiler+='· Beneficiary Account Number :   <span style="color:red;font-size:12px;">BMLUNI'+EnrollmentNo+'</span><br>';

				boiler+='· Beneficiary Name : BML Munjal University<br>';

				boiler+='· IFS Code : YESB0CMSNOC<br>';

				boiler+='· Bank Name : Yes Bank<br>';

				boiler+='· Branch : Worli, Mumbai <br><br><br></b>';
			}*/
			
			$('#AllStudentPaymentDetailsoffline').append(boiler);
			if(src==undefined){
				$('.claAmts').attr('checked',false);
			}
			$('.claAmts').trigger('onclick');
			$('.clsExceed').numeric();
			
			if(jArray.length>0 && jArray[1].length>0){
				for(var i=0;i<jArray[1].length;i++){
					var studId = jArray[1][i]["studId"];
					var feeHeads = jArray[1][i]["feeHeads"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "");
					var amount = jArray[1][i]["amount"]!=undefined && jArray[1][i]["amount"]!='' ? eval(jArray[1][i]["amount"]):0;;
					var amt = $('#amtsStud_'+feeHeads).text()!=undefined && $('#amtsStud_'+feeHeads).text()!='' ? eval($('#amtsStud_'+feeHeads).text()):0;
					$('#amtstud_'+feeHeads).text(amount);
					console.log(amt+':::'+amount);
					if((amt-amount)==0 || amt == 0){
						$('#chk_'+feeHeads).text('');
					}
				}
			}
			
			var invAmt = 0;
			$('.invAmt').each(function(){
				var tmp = $(this).text()!=undefined && $(this).text()!='' ? $(this).text() :'0';
				invAmt +=eval(tmp);
			});
			$('#invAmt').text(invAmt);
			
			var amtInProcess = 0;
			$('.amtInProcess').each(function(){
				var tmp = $(this).text()!=undefined && $(this).text()!='' ? $(this).text() :'0';
				amtInProcess +=eval(tmp);
			});
			$('#amtInProcess').text(amtInProcess);
		},
		error:function(){
			jAlert("No Records","Error");
		}
	});
}



function getStudentPaymentDetailsHostel(src){
	
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	$('#chkAgreeTermsAcademicBMLoffline').attr('checked',false);
	ProccedAcademicToPayforBMLoffline();
	$.ajax({      
		url:'getStudenthostelPaymentDetails.json',
		data:{},
		dataType:'json',
		async:false,
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			
			var boiler ='<br><br><table class="table table-bordered table-striped table-condensed" style="width:100%;" id="">'+
			'<tr><th>Sr. No.</th><th>UTR Code</th><th>Bank Name</th><th>IFSC No</th><th>Type</th><th>Payment Date</th><th>Settled Voucher No</th><th>Particulars</th><th>Action</th></tr>';
			
			if(jArray.length>0 && jArray[0].length>0){
				for(var i=0;i<jArray[0].length;i++){
//                    var type='checkBox';
					boiler+='<tr class="trstudentFeeStructure">'+
					//'<input class="feeItemId" type="hidden" accountHeadid="'+jArray[i]["accountHeadId"]+'" value="'+jArray[i]["feeItemId"]+'">'+
					'<td style="text-align:right">'+(i+1)+'</td>'+
					'<td>'+jArray[0][i]["utrCode"]+'</td>'+
					'<td>'+jArray[0][i]["bankName"]+'</td>'+
					'<td>'+jArray[0][i]["ifscCode"]+'</td>'+
					'<td>'+jArray[0][i]["type"]+'</td>'+
					'<td>'+jArray[0][i]["paymentDate"]+'</td>'+
					'<td>'+jArray[0][i]["settledVoucherNo"]+'</td>'+
					'<td>'+jArray[0][i]["feeHeads"]+'</td>'+
					'<td>';
					
					if(jArray[0][i]["settledVoucherNo"]==''){
						boiler+='<a style="cursor:pointer;" onClick="deleteOfflineStudentPaymentEntryHostel(\''+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'\');" id="linkDelete_'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" onlineTransactionPaymentSplitDetailsId="'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" title="Delete"><i class="fa fa-trash-o fa-1x"></i>&nbsp;</a>&nbsp;&nbsp;';

					if(jArray[0][i]["isPutForFinance"]!='Yes'){
						boiler+='<a style="cursor:pointer;" onlineTransactionPaymentSplitDetailsId="'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" id="linkFinanceApproval_'+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'" onClick="putForFinanceOfflineStudentPaymentEntry(\''+jArray[0][i]["onlineTransactionPaymentSplitDetailsId"]+'\');" title="Put for Finance"><i class="fa fa-share-square-o fa-1x"></i>&nbsp;</a>';
					}else{
						boiler +='<label>Sent to Finance Authority</label>';
					}
					
					}else{
						boiler+='<label>Accepted by Finance Authority</label>';
					}
					boiler+='</td>'+
					'</tr>';
				}

			}else{
				boiler+='<tr><td colspan="2">Data Not Found</td></tr>';
			}
			boiler+='</table>';
			
			$('#AllStudentPaymentDetailsofflineHostel').html(boiler);
           var EnrollmentNo="";
			var boiler='<br>'+
			
			(jArray.length>2?'<div><input type="checkbox" class="" id="ckbPayExceedFees" onclick="payExceedFeeHostel()">&nbsp;&nbsp;<b>Please Select for Excess Fee ?</b></div>'+
					'<div><b>Select the checkbox for the fees you want to pay.</b></div>':'')+
			'<br><table class="table table-bordered table-striped table-condensed" style="width:100%;" id="studentOfflinePaymentDetails">'+
			'<tr><th>Sr. No.</th><th></th><th>Particulars</th><th class="gems_currency_label">'+juno.labelByCustomer('l.isInvoceToFeesLabel')+' Amount</th><th class="gems_currency_label">Amount In-process</th><th class="gems_currency_label">Payment Amount</th></tr>';
			if(jArray.length>0){
				for(var i=2;i<jArray.length;i++){
					var feeHeads = 'amtstud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "");
                    var type='checkBox';
					boiler+='<tr class="trstudentFeeStructure">'+
					//'<input class="feeItemId" type="hidden" accountHeadid="'+jArray[i]["accountHeadId"]+'" value="'+jArray[i]["feeItemId"]+'">'+
					'<td style="text-align:right">'+(i-1)+'</td>';
					if(jArray[i]["unitPrice"]!="0.0"){
						boiler+='<td style="text-align:center" id="chk_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'"><input type="checkbox" types="'+jArray[i]["academics"]+'" class="claAmts chks_'+jArray[i]["studentExceptionInvoiceId"]+'" financepolicyid='+jArray[i]["financepolicyid"]+' feeHead="chk_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" value="'+jArray[i]["studentExceptionInvoiceId"]+'" id="'+jArray[i]["studentExceptionInvoiceId"]+'_'+jArray[i]["academics"]+'" onclick="calculateAmountsHostel(\''+type+'\','+jArray[i]["studentExceptionInvoiceId"]+',\''+feeHeads+'\');"></td>';
					}else{
						boiler+='<td style="text-align:center"></td>';
					}
					EnrollmentNo=jArray[i]["studentuniqueId"]!=undefined && jArray[i]["studentuniqueId"]!='-'?jArray[i]["studentuniqueId"]:jArray[i]["studentuniqueNo"];
					boiler+='<td id="desc_'+jArray[i]["studentExceptionInvoiceId"]+'">'+jArray[i]["description"]+'</td>'+
					'<td class="gems_currency amts_'+jArray[i]["studentExceptionInvoiceId"]+' invAmt" id="amtsStud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" style="text-align:right">'+jArray[i]["unitPrice"]+'</td>'+
					'<td class="gems_currency amtInProcess amtInProcess_'+jArray[i]["studentExceptionInvoiceId"]+'" id="amtstud_'+jArray[i]["description"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "")+'" style="text-align:right"></td>'+
					'<td class="editamt paymentAmt" id="editamts_'+jArray[i]["studentExceptionInvoiceId"]+'" style="text-align:right"></td>'+

					//'<td></td>'+
					'</tr>';
				}
				boiler+='<tr id="trPayExceedFees" style="display:none"><td colspan="3" style="text-align:right" class="gems_currency_label">Excess Fee Amount</td><td colspan="3" id="paymentExceed" class="gems_currency" style="text-align:right"><input id="txtPayExceedFees" class="gems_currency" style="width:90px;text-align:right;" onkeyup="calculateAmountAccessHostel();" type="text" value="0"></td></tr>';
				boiler+='<tr><td colspan="3" style="text-align:right" class="gems_currency_label">Total</td><td id="invAmt" class="gems_currency"></td><td id="amtInProcess" class="gems_currency"></td><td id="paymentAmt" class="gems_currency"></td></tr>';

			}else{
				boiler+='<tr><td colspan="2">Data Not Found</td></tr>';
			}
			boiler+='</table>';
			
			/*if($('#customerHelper').val()=="BLM_MUNJAL"){

				boiler+='<br><br><b>· “BMLUNI” is e-collect code allocated for BML Munjal University.<br>';

				boiler+='· Beneficiary Account Number :   <span style="color:red;font-size:12px;">BMLUNI'+EnrollmentNo+'</span><br>';

				boiler+='· Beneficiary Name : BML Munjal University<br>';

				boiler+='· IFS Code : YESB0CMSNOC<br>';

				boiler+='· Bank Name : Yes Bank<br>';

				boiler+='· Branch : Worli, Mumbai <br><br><br></b>';
			}*/
			
			$('#AllStudentPaymentDetailsofflineHostel').append(boiler);
			if(src==undefined){
				$('.claAmts').attr('checked',false);
			}
			$('.claAmts').trigger('onclick');
			$('.clsExceed').numeric();
			
			if(jArray.length>0 && jArray[1].length>0){
				for(var i=0;i<jArray[1].length;i++){
					var studId = jArray[1][i]["studId"];
					var feeHeads = jArray[1][i]["feeHeads"].replace(/\s+/g, '').replace(/[^a-zA-Z ]/g, "");
					var amount = jArray[1][i]["amount"]!=undefined && jArray[1][i]["amount"]!='' ? eval(jArray[1][i]["amount"]):0;;
					var amt = $('#amtsStud_'+feeHeads).text()!=undefined && $('#amtsStud_'+feeHeads).text()!='' ? eval($('#amtsStud_'+feeHeads).text()):0;
					$('#amtstud_'+feeHeads).text(amount);
					console.log(amt+':::'+amount);
					if((amt-amount)==0 || amt == 0){
						$('#chk_'+feeHeads).text('');
					}
				}
			}
			
			var invAmt = 0;
			$('.invAmt').each(function(){
				var tmp = $(this).text()!=undefined && $(this).text()!='' ? $(this).text() :'0';
				invAmt +=eval(tmp);
			});
			$('#invAmt').text(invAmt);
			
			var amtInProcess = 0;
			$('.amtInProcess').each(function(){
				var tmp = $(this).text()!=undefined && $(this).text()!='' ? $(this).text() :'0';
				amtInProcess +=eval(tmp);
			});
			$('#amtInProcess').text(amtInProcess);
		},
		error:function(){
			jAlert("No Records","Error");
		}
	});
}

function payExceedFee(){
	if($('#ckbPayExceedFees').is(":checked")){
		$('.claAmts').attr('checked',true);
		$('.claAmts').trigger('onclick');
		$('.clsExceed').attr('readonly',true);
		$('#trPayExceedFees').show();
	}else{
		$('.claAmts').attr('checked',true);
		$('.claAmts').trigger('onclick');
		$('.clsExceed').attr('readonly',false);
		$('#trPayExceedFees').hide();
	}
}
function payExceedFeeHostel(){
	if($('#ckbPayExceedFees').is(":checked")){
		$('.claAmts').attr('checked',true);
		$('.claAmts').trigger('onclick');
		$('.clsExceed').attr('readonly',true);
		$('#trPayExceedFees').show();
	}else{
		$('.claAmts').attr('checked',true);
		$('.claAmts').trigger('onclick');
		$('.clsExceed').attr('readonly',false);
		$('#trPayExceedFees').hide();
	}
}

function calculateAmountAccess(){
	calculateAmounts();
	var Amt=$('#paymentAmt').text()!=null?$('#paymentAmt').text():0;
	var Amt1=($('#txtPayExceedFees').val()!=''||$('#txtPayExceedFees').val()!=null)?$('#txtPayExceedFees').val():0
	if(!Amt1.includes("-")){
		if(Amt1==''||Amt1==0){
			$('#paymentAmt').text(Amt);
			$('#amtForOnlinePaymentStudentFeeDueBML').html(Amt);
		}else{
			$('#paymentAmt').text(eval(Amt)+eval(Amt1));
			$('#amtForOnlinePaymentStudentFeeDueBML').html(eval(Amt)+eval(Amt1));
		}
	}else{
		jAlert("Please Enter valid Excess Amount");
		$('#txtPayExceedFees').val('0');
		return false;
	}
}

function calculateAmountAccessHostel(){
	calculateAmountsHostel();
	var Amt=$('#paymentAmt').text()!=null?$('#paymentAmt').text():0;
	var Amt1=($('#txtPayExceedFees').val()!=''||$('#txtPayExceedFees').val()!=null)?$('#txtPayExceedFees').val():0
	if(!Amt1.includes("-")){
		if(Amt1==''||Amt1==0){
			$('#paymentAmt').text(Amt);
			$('#amtForOnlinePaymentStudentFeeDueBML').html(Amt);
		}else{
			$('#paymentAmt').text(eval(Amt)+eval(Amt1));
			$('#amtForOnlinePaymentStudentFeeDueBML').html(eval(Amt)+eval(Amt1));
		}
	}else{
		jAlert("Please Enter valid Excess Amount");
		$('#txtPayExceedFees').val('0');
		return false;
	}
}

//calculateAmountAccessHostel

function calculateAmount(type,studentExceptionInvoiceId){
	
	if($('.chk_'+studentExceptionInvoiceId).is(':checked')){
		var amt=eval($('.amt_'+studentExceptionInvoiceId).text());
		var impamt=$('.inp_'+studentExceptionInvoiceId).text()!=''?eval($('.inp_'+studentExceptionInvoiceId).text()):0;
		amt=eval(amt)-eval(impamt);
		$('#editamt_'+studentExceptionInvoiceId).html('<input type="text" pattern="/[0-9]|\./" id="txtUnitPriceid_'+studentExceptionInvoiceId+'" class="gems_currency" style="width:90px;text-align:right;" onkeyup="calculateAmount();" value="'+amt+'">');
		$('#editamt_'+studentExceptionInvoiceId).keypress(function (e) {
	        var keyCode = e.which ? e.which : e.keyCode;
	        var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
	        return result;
	    });
	}else{
		var amt=eval($('.amt_'+studentExceptionInvoiceId).text());
		$('#editamt_'+studentExceptionInvoiceId).html('');
	}
	var Amount=0.0;
	var flag=true;
	$('.claAmt:checked').each(function(){
		var studentExceptionInvoiceId=$(this).val();
		var headAmt=eval($('.amt_'+studentExceptionInvoiceId).text());
		var amt=$('#txtUnitPriceid_'+studentExceptionInvoiceId).val()!=undefined || $('#txtUnitPriceid_'+studentExceptionInvoiceId).val()!='' ? eval($('#txtUnitPriceid_'+studentExceptionInvoiceId).val()):0;
		
		if(amt>0){
			if(amt > headAmt) {
				jAlert("Please Enter valid amount for specified head.");
				$('#txtUnitPriceid_'+studentExceptionInvoiceId).val(headAmt)
				Amount+=eval(headAmt);
				return false;
			}
			Amount+=eval(amt);
		}
		else{
			flag=false;	
		}
	});
	$('#paymentAmts').text(Amount);
	if(flag){
		if(eval(Amount)>0.0){
			Amount+=($('#txtPayExceedFees').val()==null||$('#txtPayExceedFees').val()==''|| $('#txtPayExceedFees').val()!=undefined )?0:eval($('#txtPayExceedFees').val());
			var varible='';
			var boiler ='<br><br><br><b><input type="checkbox" id="chkAgreeTermsAcademicBML" onclick="ProccedAcademicToPayforBML()">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b> '+
			'<span><span id="paymentdiv"> You have chosen to pay an amount </span><b>Rs- <span id="amtForOnlinePaymentStudentFeeDueBMLs">'+Amount+'</b></span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
			'<br><div style="text-align:center;" id="paymentPluginsDiv1"></div><div style="text-align:center;display:none;" id="paymentPluginsDivBML"></div>'+
			'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueBML"></span>'+
			'<br><div class="row-fluid"><div class="span4" id="onlinePaymentSpanBML" style="display:none;">'+
			'</div><div class="span4" id="onlinePaymentSpanBML1" style="display:none;"></div>'+
			'<div class="span4" id="onlinePaymentSpanBML2" style="display:none;"></div>'+
			'</div><div class="span4"></div><div class="span4" id="onlinePaymentSpanREVARazor" style="display:none;"></div>'+
			'</div><div class="span4" id="onlinePaymentSpanREVAPaytm" style="display:none;"></div>'+
			'</div><div class="span4" id="onlinePaymentSpanREVAEasy" style="display:none;"></div></div>'+
			
			'<span id="onlinePaymentSpanREVARazor" style="display:none;"></span>&nbsp;&nbsp;'+
			'<span id="onlinePaymentSpanREVAPaytm" style="display:none;"></span>&nbsp;&nbsp;'+
			'<span id="onlinePaymentSpanREVAEasy" style="display:none;"></span>&nbsp;&nbsp;'+
			//'<br><span id="newBankChallanPaymentSpan"></span>'+
			'<br>';
			$('#paydetails').html(boiler);
			if($('#customerHelper').val()=="BLM_MUNJAL"){
				$('#onlinePaymentSpanREVARazor').hide();
				$('#onlinePaymentSpanREVAPaytm').hide();
				$('#onlinePaymentSpanREVAEasy').hide();
				$('#onlinePaymentSpanBML').show();
				$('#onlinePaymentSpanBML1').show();
				$('#onlinePaymentSpanBML2').show();
			}else if($('#customerHelper').val()=="REVA_UNIVERSITY"){
				$('#onlinePaymentSpanBML').hide();
				$('#onlinePaymentSpanBML1').hide();
				$('#onlinePaymentSpanBML2').hide();
				
				$('#onlinePaymentSpanREVARazor').show();
				$('#onlinePaymentSpanREVAPaytm').show();
				$('#onlinePaymentSpanREVAEasy').show();
			}
		}else{
			$('#paydetails').html('');
		}
	}else{
		$('#paydetails').html('');
		jAlert('Please enter amount in selected row');
		return false;
	}
	applyGemsPlugins();

}
function validationAmount(feeHeads,studentExceptionInvoiceId){
	calculateAmounts();
	var amt1 =($('.amts_'+studentExceptionInvoiceId).text()!=null || $('.amts_'+studentExceptionInvoiceId).text()!='')?$('.amts_'+studentExceptionInvoiceId).text():0;
	var amt2 =($('.amtInProcess_'+studentExceptionInvoiceId).text()!=null && $('.amtInProcess_'+studentExceptionInvoiceId).text()!='')?$('.amtInProcess_'+studentExceptionInvoiceId).text():0;
	amt1=eval(amt1)-eval(amt2);
	var amt0=$('#txtUnitPriceid_'+studentExceptionInvoiceId).val();
	if(!amt0.includes("-")){
		if(eval(amt0)>eval(amt1)){
			jAlert("Entered Payment Amount is greater Than "+juno.labelByCustomer('l.isInvoceToFeesLabel')+" Amount");
			$('#txtUnitPriceid_'+studentExceptionInvoiceId).val(amt1);
			return false;
		};
	}else{
		jAlert("Please Enter valid Payment Amount");
		$('#txtUnitPriceid_'+studentExceptionInvoiceId).val(amt1);
		return false;
	}
}
function validationAmountHostel(feeHeads,studentExceptionInvoiceId){
	calculateAmountsHostel();
	var amt1 =($('.amts_'+studentExceptionInvoiceId).text()!=null || $('.amts_'+studentExceptionInvoiceId).text()!='')?$('.amts_'+studentExceptionInvoiceId).text():0;
	var amt2 =($('.amtInProcess_'+studentExceptionInvoiceId).text()!=null && $('.amtInProcess_'+studentExceptionInvoiceId).text()!='')?$('.amtInProcess_'+studentExceptionInvoiceId).text():0;
	amt1=eval(amt1)-eval(amt2);
	var amt0=$('#txtUnitPriceid_'+studentExceptionInvoiceId).val();
	if(!amt0.includes("-")){
		if(eval(amt0)>eval(amt1)){
			jAlert("Entered Payment Amount is greater Than "+juno.labelByCustomer('l.isInvoceToFeesLabel')+" Amount");
			$('#txtUnitPriceid_'+studentExceptionInvoiceId).val(amt1);
			return false;
		};
	}else{
		jAlert("Please Enter valid Payment Amount");
		$('#txtUnitPriceid_'+studentExceptionInvoiceId).val(amt1);
		return false;
	}
}
//calculateAmountsHostel
function calculateAmounts(type,studentExceptionInvoiceId,feeHeads){
	var amt1 = $('#'+feeHeads).text()!=undefined && $('#'+feeHeads).text()!='' ? eval($('#'+feeHeads).text()):0;
	if($('.chks_'+studentExceptionInvoiceId).is(':checked')){
		var amt=eval($('.amts_'+studentExceptionInvoiceId).text()) - eval(amt1);
		$('#editamts_'+studentExceptionInvoiceId).html('<input type="text" id="txtUnitPriceid_'+studentExceptionInvoiceId+'" class="clsExceed gems_currency" style="width:90px;text-align:right;" onkeyup="calculateAmounts();validationAmount(\''+amt+'\',\''+studentExceptionInvoiceId+'\');" value="'+amt+'">');
	}else{
		var amt=eval($('.amts_'+studentExceptionInvoiceId).text()) - eval(amt1);
		$('#editamts_'+studentExceptionInvoiceId).html('');
	}
	var Amount=0.0;
	var flag=true;
	$('.claAmts:checked').each(function(){
		var studentExceptionInvoiceId=$(this).val();
		var feeHead=$(this).attr('feeHead');
		var amt1 = $('#'+feeHead).text()!=undefined && $('#'+feeHead).text()!='' ? eval($('#'+feeHead).text()):0;
		var amt=$('#txtUnitPriceid_'+studentExceptionInvoiceId).val()!=undefined || $('#txtUnitPriceid_'+studentExceptionInvoiceId).val()!='' ? eval($('#txtUnitPriceid_'+studentExceptionInvoiceId).val()):0;
		
		amt = amt - amt1;
		
		if(amt>0){
			Amount+=eval(amt);
		}
		else{
			flag=false;	
		}
	});
	$('#paymentAmt').text(Amount);
	//
	if(flag){
		if(eval(Amount)>0.0){
			var varible='';
			var boiler ='<br><br><br><b><input type="checkbox" id="chkAgreeTermsAcademicBMLoffline" onclick="ProccedAcademicToPayforBMLoffline()">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b> '+
			'<span><span id="paymentdiv"> You have chosen to pay an amount </span><b>Rs- <span id="amtForOnlinePaymentStudentFeeDueBML">'+Amount+'</b></span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
			'<br><br><div id="studentofflinepaymentdiv"></div>';
			$('#paydetailsoffline').html(boiler);
		}else{
			$('#paydetailsoffline').html('');
		}
	}else{
		$('#paydetailsoffline').html('');
		jAlert('Please enter amount in selected row');
		return false;
	}
	applyGemsPlugins();

}
function calculateAmountsHostel(type,studentExceptionInvoiceId,feeHeads,financepolicyId){
	var amt1 = $('#'+feeHeads).text()!=undefined && $('#'+feeHeads).text()!='' ? eval($('#'+feeHeads).text()):0;
	if($('.chks_'+studentExceptionInvoiceId).is(':checked')){
		var amt=eval($('.amts_'+studentExceptionInvoiceId).text()) - eval(amt1);
		$('#editamts_'+studentExceptionInvoiceId).html('<input type="text" id="txtUnitPriceid_'+studentExceptionInvoiceId+'" class="clsExceed gems_currency" style="width:90px;text-align:right;" onkeyup="calculateAmountsHostel();validationAmountHostel(\''+amt+'\',\''+studentExceptionInvoiceId+'\');" value="'+amt+'">');
	}else{
		var amt=eval($('.amts_'+studentExceptionInvoiceId).text()) - eval(amt1);
		$('#editamts_'+studentExceptionInvoiceId).html('');
	}
	var Amount=0.0;
	var flag=true;
	$('.claAmts:checked').each(function(){
		var studentExceptionInvoiceId=$(this).val();
		var feeHead=$(this).attr('feeHead');
		var amt1 = $('#'+feeHead).text()!=undefined && $('#'+feeHead).text()!='' ? eval($('#'+feeHead).text()):0;
		var amt=$('#txtUnitPriceid_'+studentExceptionInvoiceId).val()!=undefined || $('#txtUnitPriceid_'+studentExceptionInvoiceId).val()!='' ? eval($('#txtUnitPriceid_'+studentExceptionInvoiceId).val()):0;
		
		amt = amt - amt1;
		
		if(amt>0){
			Amount+=eval(amt);
		}
		else{
			flag=false;	
		}
	});
	$('#paymentAmt').text(Amount);
	//
	if(flag){
		if(eval(Amount)>0.0){
			var varible='';
			var boiler ='<br><br><br><b><input type="checkbox" id="chkAgreeTermsAcademicBMLofflineHostel" onclick="ProccedAcademicToPayforBMLofflineHostel()">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b> '+
			'<span><span id="paymentdiv"> You have chosen to pay an amount </span><b>Rs- <span id="amtForOnlinePaymentStudentFeeDueBML">'+Amount+'</b></span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
			'<br><br><div id="studentofflinepaymentdivHostel"></div>';
			$('#paydetailsofflineHostel').html(boiler);
		}else{
			$('#paydetailsofflineHostel').html('');
		}
	}else{
		$('#paydetailsofflineHostel').html('');
		jAlert('Please enter amount in selected row');
		return false;
	}
	applyGemsPlugins();

}
function ProccedAcademicToPayforBMLofflineHostel(){
	if($('#chkAgreeTermsAcademicBMLofflineHostel').is(':checked')){
		var boiler='<table class="table table-bordered table-striped table-condensed" style="width:100%;" id="">'+
		'<tr><th>NEFT/RTGS/IMPS<b style="color: red; font-size: 16px;">*</b></th><td><select id="neftregs" onchange="">'+
		'<option value="DD">Demand Draft</option><option value="NEFT">NEFT</option><option value="RTGS">RTGS</option><option value="IMPS">IMPS</option></td><th>Bank Name<b style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="bankName"></td></tr>'+
		'<tr><th>Branch Name<b style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="branchName"></td><th>IFSC Code<b style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="ifsccode"></td></tr>'+
		'<tr><th>Payment Date <b style="color: red; font-size: 16px;">*</b></th><td><input type="text" readonly id="paymentDate"></td><th>UTR Code<b style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="utrcode"></td></tr>'+
		'<tr><td colspan="4" style="text-align:center"><label class="btn btn-mini btn-inverse  btnColorBlack " onClick="SaveOfflinePaymentDetailsforHostel();">Save</label></td></tr>';
		$('#studentofflinepaymentdivHostel').html(boiler);
		
		$('#paymentDate').datepicker({
			dateFormat : "M dd,yy",
			inline : true,
			changeMonth : true,
			changeYear : true,
			maxDate:new Date(),
			yearRange : "-40:+0",
			firstDay : 1,
		});
	}else{
		$('#studentofflinepaymentdivHostel').html('');
	}	
}

function ProccedAcademicToPayforBMLoffline(){
	if($('#chkAgreeTermsAcademicBMLoffline').is(':checked')){
		var boiler='<table class="table table-bordered table-striped table-condensed" style="width:100%;" id="">'+
		'<tr><th>NEFT/RTGS/IMPS<b style="color: red; font-size: 16px;">*</b></th><td><select id="neftregs" onchange="changePayemntmodestudSide();">'+
		'<option value="DD">Demand Draft</option><option value="NEFT">NEFT</option><option value="RTGS">RTGS</option><option value="IMPS">IMPS</option><option value="UPI">UPI</option></td><th>Bank Name<b class="upiMand" style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="bankName"></td></tr>'+
		'<tr><th>Branch Name<b class="upiMand" style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="branchName"></td><th>IFSC Code<b class="upiMand" style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="ifsccode"></td></tr>'+
		'<tr><th>Payment Date <b style="color: red; font-size: 16px;">*</b></th><td><input type="text" readonly id="paymentDate"></td><th>UTR Code<b style="color: red; font-size: 16px;">*</b></th><td><input type="text" id="utrcode"></td></tr>'+
	//	'<tr><td colspan="4" style="text-align:center"><label class="btn btn-mini btn-inverse  btnColorBlack " onClick="SaveOflinePaymentDetails();">Save</label>';
		'<tr><td colspan="4" style="text-align:center"><label class="btn btn-mini btn-inverse  btnColorBlack " onClick="SaveOflinePaymentDetailsNew();">Save</label>';
		boiler+='</td></tr>';
		$('#studentofflinepaymentdiv').html(boiler);
		
		$('#paymentDate').datepicker({
			dateFormat : "M dd,yy",
			inline : true,
			changeMonth : true,
			changeYear : true,
			maxDate:new Date(),
			yearRange : "-40:+0",
			firstDay : 1,
		});
	}else{
		$('#studentofflinepaymentdiv').html('');
	}	
}

function changePayemntmodestudSide(){
	var paymentMode=$('#neftregs').val();
	if(paymentMode=="UPI"){
		$('.upiMand').hide();
		
		$('#bankName').attr('readonly',true);
		$('#bankName').attr('placeholder','Not Required');
		
		$('#branchName').attr('readonly',true);
		$('#branchName').attr('placeholder','Not Required');
		
		$('#ifsccode').attr('readonly',true);
		$('#ifsccode').attr('placeholder','Not Required');
	}else{
		$('.upiMand').show();
		
		$('#bankName').attr('readonly',false);
		$('#bankName').attr('placeholder','');
		
		$('#branchName').attr('readonly',false);
		$('#branchName').attr('placeholder','');
		
		$('#ifsccode').attr('readonly',false);
		$('#ifsccode').attr('placeholder','');
	}
}

function SaveOflinePaymentDetails(){
	
	var payDetArr = new Array();
	var dataString = "";
	var misDataString ="";
	var totalAmount =0;
	var ExcessFee=$('#txtPayExceedFees').val()!=null||$('#txtPayExceedFees').val()!=''?$('#txtPayExceedFees').val():0;
	if($('#ckbPayExceedFees').is(":checked")){
		if(ExcessFee==0 ||ExcessFee==''){
			jAlert("Please enter Excess Fee Amount ");
			return;
		}
	}
	$('.claAmts:checked').each(function(){
		
		var studentExceptionInvoiceId = $(this).val();
		var amount =$('#txtUnitPriceid_'+studentExceptionInvoiceId).val();
		var description = $('#desc_'+studentExceptionInvoiceId).html();
		var type = $(this).attr('types');
		totalAmount+=eval(amount);
		
		if(type=="Academic")
			dataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
		else
			misDataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
	});
	totalAmount=eval(totalAmount)+eval(ExcessFee);
	if(misDataString.length>1)
		misDataString=misDataString.substring(0, misDataString.length-1);
	
	if(dataString.length>1)
		dataString=dataString.substring(0, dataString.length-1);
	
	
		var type=$('#neftregs option:selected').val();
		if(type==''){
			jAlert("Please select NEFT/RTGS/IMPS");
			return;
		}
		if(type!="UPI"){
			var bankName=$('#bankName').val();
			if(bankName==""){
				jAlert("Please Enter Bank Name");
				return;
			}
			var branchName=$('#branchName').val();
			if(branchName==""){
				jAlert("Please Enter Branch Name");
				return;
			}
			var ifsccode=$('#ifsccode').val();
			if(ifsccode==""){
				jAlert("Please Enter IFSC Code");
				return;
			}
		}
		var utrcode=$('#utrcode').val();
		if(utrcode==""){
			jAlert("Please Enter UTR Code");
			return;
		}
		var paymentDate=$('#paymentDate').val();
		if(paymentDate==""){
			jAlert("Please Select Payment Date");
			return;
		}
		
		$.ajax({      
			url:'SaveOfflinePaymentDetails.json',
			data:{
					type:type,
					branchName:branchName,
					ifsccode:ifsccode,
					utrcode:utrcode,
					paymentDate:paymentDate,
					bankName:bankName,
					totalAmount:totalAmount,
					dataString:dataString.toString(),
					misDataString:misDataString.toString(),
					ExcessFee:ExcessFee
				},
			dataType:'text',
			async:false,
			beforeSend: function() {
				startCommonAjaxSpinner();
			},
			complete: function() {
				stopCommonAjaxSpinner();
			},
			success:function(onlineTransactionPaymentSplitDetailsIds){	
				if(onlineTransactionPaymentSplitDetailsIds=='UTR Code already exists'){
					jAlert(onlineTransactionPaymentSplitDetailsIds);
					return false;
				}
				if(onlineTransactionPaymentSplitDetailsIds=='Failed'){
					jAlert("something went wrong");
					return false;
				}
				$('#onlinePaymentSpan').show();
				/*if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="BLM_MUNJAL"){
					//$('#onlinePaymentSpan').ccAvenue4Pymt({sPC:'TRNSPT',iFBIDs:jArray["bankIds0"]});
				}*/
				
				  jConfirm("Record saved successfully...!!. \nDo you want to Put for Finance Approval? ","Confirm",function(r)
						  {
					  if(r ==true)
					  {
						  putForFinanceOfflineStudentPaymentEntry(onlineTransactionPaymentSplitDetailsIds);
					  }else{
						  getStudentPaymentDetails1();
					  }
				 });
				
				
			},
			error:function(){
				jAlert("No Records","Error");
			}
		});
	}

function SaveOfflinePaymentDetailsforHostel(){
		
	var payDetArr = new Array();
	var dataString = "";
	var misDataString ="";
	var totalAmount =0;
	var ExcessFee=$('#txtPayExceedFees').val()!=null||$('#txtPayExceedFees').val()!=''?$('#txtPayExceedFees').val():0;
	if($('#ckbPayExceedFees').is(":checked")){
		if(ExcessFee==0 ||ExcessFee==''){
			jAlert("Please enter Excess Fee Amount ");
			return;
		}
	}
	var financePolicyId=0;
	$('.claAmts:checked').each(function(){
		
		var studentExceptionInvoiceId = $(this).val();
		if(financePolicyId ==0 || financePolicyId==undefined || financePolicyId=='' || financePolicyId=='0')
		 financePolicyId = $(this).attr('financepolicyid');

		var amount =$('#txtUnitPriceid_'+studentExceptionInvoiceId).val();
		var description = $('#desc_'+studentExceptionInvoiceId).html();
		var type = $(this).attr('types');
		totalAmount+=eval(amount);
		
		if(type=="Academic")
			dataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
		else
			misDataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
	});
	totalAmount=eval(totalAmount)+eval(ExcessFee);
	if(misDataString.length>1)
		misDataString=misDataString.substring(0, misDataString.length-1);
	
	if(dataString.length>1)
		dataString=dataString.substring(0, dataString.length-1);
	
	
		var type=$('#neftregs option:selected').val();
		if(type==''){
			jAlert("Please select NEFT/RTGS/IMPS");
			return;
		}
		var bankName=$('#bankName').val();
		if(bankName==""){
			jAlert("Please Enter Bank Name");
			return;
		}
		var branchName=$('#branchName').val();
		if(branchName==""){
			jAlert("Please Enter Branch Name");
			return;
		}
		var ifsccode=$('#ifsccode').val();
		if(ifsccode==""){
			jAlert("Please Enter IFSC Code");
			return;
		}
		var utrcode=$('#utrcode').val();
		if(utrcode==""){
			jAlert("Please Enter UTR Code");
			return;
		}
		var paymentDate=$('#paymentDate').val();
		if(paymentDate==""){
			jAlert("Please Select Payment Date");
			return;
		}
		
		$.ajax({      
			url:'SaveOfflinePaymentDetailsforHostel.json',
			data:{
					type:type,
					branchName:branchName,
					ifsccode:ifsccode,
					utrcode:utrcode,
					paymentDate:paymentDate,
					bankName:bankName,
					financePolicyId:financePolicyId,
					totalAmount:totalAmount,
					dataString:dataString.toString(),
					misDataString:misDataString.toString(),
					ExcessFee:ExcessFee
				},
			dataType:'text',
			async:false,
			beforeSend: function() {
				startCommonAjaxSpinner();
			},
			complete: function() {
				stopCommonAjaxSpinner();
			},
			success:function(onlineTransactionPaymentSplitDetailsIds){	
				if(onlineTransactionPaymentSplitDetailsIds=='UTR Code already exists'){
					jAlert(onlineTransactionPaymentSplitDetailsIds);
					return false;
				}
				//$('#onlinePaymentSpan').show();
				/*if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="BLM_MUNJAL"){
					//$('#onlinePaymentSpan').ccAvenue4Pymt({sPC:'TRNSPT',iFBIDs:jArray["bankIds0"]});
				}*/
				
				  jConfirm("Record saved successfully...!!. \nDo you want to Put for Finance Approval? ","Confirm",function(r)
						  {
					  if(r ==true)
					  {
						  putForFinanceOfflineStudentPaymentEntryHostel(onlineTransactionPaymentSplitDetailsIds);
					  }else{
						  getStudentPaymentDetailsHostel();
					  }
				 });
				
				
			},
			error:function(){
				jAlert("No Records","Error");
			}
		});
	}

function ProccedAcademicToPayforBML(){  
	var payDetArr = new Array();
	var dataString = "";
	var misDataString ="";
	var totalAmount =0;
	var studentId=0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	
	if($('#chkAgreeTermsAcademicBML').is(':checked')){
		$('.claAmt:checked').each(function(){
			
			var studentExceptionInvoiceId = $(this).val();
			var amount =$('#txtUnitPriceid_'+studentExceptionInvoiceId).val();
			var description = $('#desc_'+studentExceptionInvoiceId).html();
			var type = $(this).attr('types');
			totalAmount+=eval(amount);
			
			if(type=="Academic")
				dataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
			else if(type=="Hostel")
				dataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
			else
				misDataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
		});
		
		if(misDataString.length>1)
			misDataString=misDataString.substring(0, misDataString.length-1);
		
		if(dataString.length>1)
			dataString=dataString.substring(0, dataString.length-1);

		var boiler = '';
		$('#paymentPluginsDivBML').html(boiler).show();
		$.ajax({
			url : 'fetchApplicantAdmissionFeeDetailforstudentsidepaymentForBML.json?instituteCourseStrengthId='+ globalSource,
			dataType : 'text',
			data:{
				totalAmount:totalAmount,
				dataString:dataString.toString(),
				misDataString:misDataString.toString(),
				studentId:studentId
			},
			async : false,
			beforeSend : function() {
				startCommonAjaxSpinner();
			},
			complete : function() {
				stopCommonAjaxSpinner();
			},
			success : function(bnkId) {
				$('#paymentPluginsStudentFeeDueBML').show();
				if($('#customerHelper').val()=="BLM_MUNJAL"){
					$('#onlinePaymentSpanBML').show();
					$('#onlinePaymentSpanBML').payU3Pymt({
						sPC : 'CMF'
					});
					$('#onlinePaymentSpanBML1').show();
					$('#onlinePaymentSpanBML1').ccAvenue5Pymt({
						sPC : 'CMF'
					});		
					$('#onlinePaymentSpanBML2').show();
					$('#onlinePaymentSpanBML2').easyPay8Pymt({
						sPC : 'CMF'
					});
					
				}else if($('#customerHelper').val()=="REVA_UNIVERSITY"){
					$('#onlinePaymentSpanREVARazor').razor8Pymt({sPC:'CMF'});
					$('#onlinePaymentSpanREVAPaytm').payTM2Pymt({sPC:'CMF',iFBIDs:"4"});
					$('#onlinePaymentSpanREVAEasy').easyPayPymt({sPC:'CMF'});
					
					$('#onlinePaymentSpanREVARazor').show();
					$('#onlinePaymentSpanREVAPaytm').show();
					$('#onlinePaymentSpanREVAEasy').show();
				}else if($('#customerHelper').val()=="MAHINDRA_UNIVERSITY" || $('#customerHelper').val()=="SRHU"){
                    $('#onlinePaymentSpanBML1').show();
                    $('#onlinePaymentSpanBML1').junoPymt({sPC:'CMF',iFBIDs:bnkId});

                }
			},
		});
	}else{
		if($('#customerHelper').val()=="BLM_MUNJAL"){
			$('#paymentPluginsStudentFeeDueBML').hide();
			$('#onlinePaymentSpanBML').hide();
			$('#onlinePaymentSpanBML1').hide();
			$('#onlinePaymentSpanBML2').hide();
		}else if($('#customerHelper').val()=="REVA_UNIVERSITY"){
			$('#onlinePaymentSpanREVARazor').hide();
			$('#onlinePaymentSpanREVAPaytm').hide();
			$('#onlinePaymentSpanREVAEasy').hide();
		}else if($('#customerHelper').val()=="MAHINDRA_UNIVERSITY" || $('#customerHelper').val()=="SRHU"){
            $('#paymentPluginsStudentFeeDueBML').hide();
            $('#onlinePaymentSpanBML1').hide();
            $('#onlinePaymentSpanBML2').hide();
        }
	}
}

function deleteOfflineStudentPaymentEntry(onlineTransactionPaymentSplitDetailsId){
	$.ajax({
		url : 'deleteOfflineStudentPaymentEntry.json',
		dataType : 'text',
		data:{onlineTransactionPaymentSplitDetailsId:onlineTransactionPaymentSplitDetailsId.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			jAlert("Record deleted successfully...!!");
			getStudentPaymentDetails1();
		},
	});
}

function deleteOfflineStudentPaymentEntryHostel(onlineTransactionPaymentSplitDetailsId){
	$.ajax({
		url : 'deleteOfflineStudentPaymentEntry.json',
		dataType : 'text',
		data:{onlineTransactionPaymentSplitDetailsId:onlineTransactionPaymentSplitDetailsId.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			jAlert("Record deleted successfully...!!");
			getStudentPaymentDetailsHostel();
		},
	});
}
function putForFinanceOfflineStudentPaymentEntry(onlineTransactionPaymentSplitDetailsId){
	$.ajax({
		url : 'putForFinanceOfflineStudentPaymentEntry.json',
		dataType : 'text',
		data:{onlineTransactionPaymentSplitDetailsId:onlineTransactionPaymentSplitDetailsId.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			jAlert("Record sent to finance authority...!!");
			getStudentPaymentDetails1();
		},
	});
}

function putForFinanceOfflineStudentPaymentEntryHostel(onlineTransactionPaymentSplitDetailsId){
	$.ajax({
		url : 'putForFinanceOfflineStudentPaymentEntry.json',
		dataType : 'text',
		data:{onlineTransactionPaymentSplitDetailsId:onlineTransactionPaymentSplitDetailsId.toString()},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			jAlert("Record sent to finance authority...!!");
			getStudentPaymentDetailsHostel();
		},
	});
}

function getGstPercentage(){
	$('#txtFineAmnt').val('');
	var accountHeadId = $('#cmbAccountFor').val();
	var headType= 'AccountHead_Student_Miscellaneous';
	var isGstApplicable  = $('#cmbAccountFor option:selected').attr('isGstApplicable');
	
	$.ajax({
		url : 'getGstPercentageByAccountHead.json',
		dataType : 'json',
		data:{accountHeadId:accountHeadId,headType:headType},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			
			var integretedAccontHead = jArray.integretedAccontHead;
			var centralAccontHead = jArray.centralAccontHead;
			var stateAccontHead = jArray.stateAccontHead;
			var vatAccontHead = jArray.VatAccontHead;
			
			$('#isGstTrueTble').show();
			if(isGstApplicable=="true"){
				
				var boiler='<table class="table table-bordered table-condensed">';
				if($('#customerHelper').val()!=undefined && $('#customerHelper').val()!="IMT_DUBAI") {
					boiler+='<tr id="integratedTaxTr"><th style="text-align:right">Integrated Tax (in percent) : </th><td id="integratedTax">'+jArray.integratedTax+'</td><th class="gems_currency_label" style="text-align:right">Total Tax Amount</th><td id="totIntAmt" class="allTaxTotalAmtCls">0</td></tr>'+
							'<tr id="centralTaxTr"><th style="text-align:right">Central Tax (in percent) : </th><td id="centralTax">'+jArray.centralTax+'</td><th class="gems_currency_label" style="text-align:right">Total Tax Amount</th><td id="totCentralAmt" class="allTaxTotalAmtCls">0</td></tr>'+
							'<tr id="stateTaxTr"><th style="text-align:right">State Tax (in percent) : </th><td id="stateTax">'+jArray.stateTax+'</td><th class="gems_currency_label" style="text-align:right">Total Tax Amount</th><td id="totStateAmt" class="allTaxTotalAmtCls">0</td></tr>'+
							'<tr id="cessTaxTr"><th style="text-align:right">Cess Tax (in percent) : </th><td id="cessTax">'+jArray.cessTax+'</td><th class="gems_currency_label" style="text-align:right">Total Tax Amount</th><td id="totCessAMt" class="allTaxTotalAmtCls">0</td></tr>';
				}else {
					boiler+='<tr id="vatTaxTr"><th style="text-align:right">Vat Tax (in percent) : </th><td id="VatTax">'+jArray.VatTax+'</td><th class="gems_currency_label" style="text-align:right">Total Tax Amount</th><td id="totVatAMt" class="allTaxTotalAmtCls">0</td></tr>';
				}
				boiler+='<tr><th class="gems_currency_label" colspan="3" style="text-align:right">Total Amount</th><td id="totalAllAmtId" class="gems_currency"></td></tr>'+
				'</table>';
				$('#isGstTrueTble').html(boiler);
				
				var totalamount=0;
				$(function() {
					$('#txtFineAmnt').keyup(function(e) {
						var allTaxAmt = $('#txtFineAmnt').val();
						var inegratedTax = $('#integratedTax').text();
						var centralTax = $('#centralTax').text();
						var stateTax = $('#stateTax').text();
						var cessTax = $('#cessTax').text();
						var vatTax = $('#VatTax').text();
						if(stateAccontHead>0 && centralAccontHead>0){
							$('#centralTaxTr').show();
							$('#stateTaxTr').show();
							$('#integratedTaxTr').hide();
							$('#cessTaxTr').hide();
							$('#vatTaxTr').hide();
							var totalCentralAmt = centralTax * allTaxAmt / 100;
							var totalSateAmt = stateTax * allTaxAmt / 100;
							$('#totCentralAmt').text(totalCentralAmt);
							$('#totStateAmt').text(totalSateAmt);
							$('#totIntAmt').text(0);
							$('#VatTax').text(0);
						}else if(integretedAccontHead > 0){
							$('#integratedTaxTr').show();
							$('#centralTaxTr').hide();
							$('#stateTaxTr').hide();
							$('#vatTaxTr').hide();
							$('#cessTaxTr').hide();
							var totalIntegratedAmt = inegratedTax * allTaxAmt / 100;
							$('#totIntAmt').text(totalIntegratedAmt);
							$('#totCentralAmt').text(0);
							$('#totStateAmt').text(0);
							$('#VatTax').text(0);
						}else if(vatAccontHead > 0){
							$('#integratedTaxTr').hide();
							$('#centralTaxTr').hide();
							$('#stateTaxTr').hide();
							$('#vatTaxTr').show();
							$('#cessTaxTr').hide();
							var totalvatAmt = vatTax * allTaxAmt / 100;
							$('#totVatAMt').text(eval(totalvatAmt));
							$('#totCentralAmt').text(0);
							$('#totIntAmt').text(0);
							$('#totStateAmt').text(0);
						}else{
							$('#integratedTaxTr').hide();
							$('#centralTaxTr').hide();
							$('#stateTaxTr').hide();
							$('#vatTaxTr').hide();
							$('#cessTaxTr').show();
							var totalcessTaxAmt = cessTax * allTaxAmt / 100;
							$('#totIntAmt').text(totalcessTaxAmt);
							$('#totCentralAmt').text(0);
							$('#totStateAmt').text(0);
							$('#VatTax').text(0);
						}
						getcalculateAmount();
					});
				});

				/*$(function() {
					$('#txtCentralAmnt').keyup(function(e) {
						
						var centralMulAmt = $('#txtCentralAmnt').val();

						var totalCentralAmt = centralTax * centralMulAmt / 100;
						totalCentralAmt = eval(totalCentralAmt) ;//+ eval(centralMulAmt);
						$('#totCentralAmt').text(totalCentralAmt);
						getcalculateAmount();
					});
				});
                 
				$(function() {
					$('#txtstateAmnt').keyup(function(e) {
						
						var stateMulAmt = $('#txtstateAmnt').val();

						var totalSateAmt = stateTax * stateMulAmt / 100;
						totalSateAmt = eval(totalSateAmt);// + eval(stateMulAmt);
						$('#totStateAmt').text(totalSateAmt);
						getcalculateAmount();
					});
				});

				$(function() {
					$('#txtCessAmnt').keyup(function(e) {
						
						var cessMulAmt = $('#txtCessAmnt').val();

						var totalCessAmt = cessTax * cessMulAmt / 100;
						totalCessAmt = eval(totalCessAmt);// + eval(cessMulAmt);
						$('#totCessAMt').text(totalCessAmt);
						getcalculateAmount();
					});
				});
				
				$("#txtIntegratedAmnt").keypress(function (e) {
					var keyCode = e.which ? e.which : e.keyCode;
					var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
					return result;
				});

				$("#txtCentralAmnt").keypress(function (e) {
					var keyCode = e.which ? e.which : e.keyCode;
					var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
					return result;
				});

				$("#txtstateAmnt").keypress(function (e) {
					var keyCode = e.which ? e.which : e.keyCode;
					var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
					return result;
				});

				$("#txtCessAmnt").keypress(function (e) {
					var keyCode = e.which ? e.which : e.keyCode;
					var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
					return result;
				});*/
				$("#txtFineAmnt").keypress(function (e) {
					var keyCode = e.which ? e.which : e.keyCode;
					var result = !( ( keyCode >= 65 && keyCode <= 90) || ( keyCode >= 33 && keyCode <= 47) || keyCode == 126 || ( keyCode >= 97 && keyCode <= 122) || ( keyCode >= 58 && keyCode <= 64) || ( keyCode >= 91 && keyCode <= 96));
					return result;
				})
			}else{
				$('#isGstTrueTble').hide();
			}
		},
	});
}

function getcalculateAmount(){
	var totalamount=0.0;
	var finalamt = $('#txtFineAmnt').val();
	$('.allTaxTotalAmtCls').each(function(){
		var totalamount1 = $(this).text()!=''?$(this).text():0;
		totalamount += eval(totalamount1);
	});
	$('#totalAllAmtId').text(totalamount +  eval(finalamt));
}

function checkOfficeDocAmountIndiviual(){
	var totalAmount = $('.amtForOnlinePaymentOffDoc').attr('offDocAmt');
	var amount=0.0;
	var flag='true';
	var count=0;
	$('.chkAmountOffDocCls:checked').each(function(){
		amount+=eval($(this).val());
		flag='false';
		count++;
	});
	if(count==0){
		$('#officeDocDiv').hide();
		jAlert('Please select atleast one payment');
		return false;
	}else{
		$('#officeDocDiv').show();
	}
	if(flag=='false'){
		$('.amtForOnlinePaymentOffDoc').html(amount);
	}else{
		$('.amtForOnlinePaymentOffDoc').html(totalAmount);
	}
}
function checkOfficeDocAmountIndiviual1(){
	var totalAmount = $('.amtForOnlinePaymentOffDoc').attr('offDocAmt');
	var amount=0.0;
	var flag='true';
	var count=0;
	$('.chkMiscellneousAmtCls:checked').each(function(){
		amount+=eval($(this).val());
		flag='false';
		count++;
	});
	if(count==0){
		$('#miscTotalDiv').hide();
		jAlert('Please select atleast one payment');
		return false;
	}else{
		$('#miscTotalDiv').show();
	}
	if(flag=='false'){
		$('.amtForOnlinePaymentMisc').html(amount);
	}else{
		$('.amtForOnlinePaymentMisc').html(totalAmount);
	}
}
function getMiscellaneousAmtOnCheck(){
	var totalAmount = $('.amtForOnlinePaymentMisc').attr('miscTotalAmt');
	var amount=0.0;
	var flag='true';
	var count=0;
	$('.chkMiscellneousAmtCls:checked').each(function(){
		amount+=eval($(this).val());
		flag='false';
		count++;
	});
	if(count==0){
		$('#miscTotalDiv').hide();
		jAlert('Please select atleast one payment');
		return false;
	}else{
		$('#miscTotalDiv').show();
	}
	if(flag=='false'){
		$('.amtForOnlinePaymentMisc').html(amount);
	}else{
		$('.amtForOnlinePaymentMisc').html(totalAmount);
	}
}

function setZeroBill(studentFeesInvoiceId){
	$.ajax({
		url : 'generateZeroBill.json',
		dataType : 'text',
		data:{
			studentFeesInvoiceId : studentFeesInvoiceId
		},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(text) {
			showStudentOverallFeeDueReportForInvoiceByStudentBatchId('0');
			jAlert("bill generated successfully.");
		},
	});
}

function registrationForm(studentId){
	//window.location.replace('downloadRegistrationformforMGMU.json?studentId='+studentId);
}

function getStudentMiscellaneousAccountHeadList(financePolicyId){
	$.ajax({
		url : 'getAccountHeadsListudentMiscByFinancePolicy.json',
		dataType : 'json',
		type:'POST',
		data:{
			financePolicyId : financePolicyId
		},
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function(jArray) {
			var boiler = '<option value="0">Select</option>';
			for ( var i = 0; i < jArray.length; i++)
				boiler += '<option value="'+jArray[i].accountHeadId+'" isGstApplicable="'+jArray[i].isGSTApplicable+'">'
				+ jArray[i].accountHeadName + '</option>';

			$('#cmbAccountFor').html(boiler);
			convertComboToSearchable('#cmbAccountFor');
		},
		error : function() {
			jAlert("Something went wrong, Please try after some time");
		}
	});
}

function addStudentOtherFine(studentid, financePolicyId){
	var _table='<table class="table table-bordered table-condensed" id="studentFine"><tr>'+
	'<th>Account For</th>'+
	'<td><select id="cmbAccountFor" class="perticular" onchange="getGstPercentage()"></select></td>'+
	'<th class="gems_currency_label">Amount</th>'+
	'<td><input type="text" id="txtFineAmnt"style="text-align: right"/><br><span id="errormsg"></span></td>'+
	'</tr>'+
	'<tr><td id="isGstTrueTble" colspan="4"></td></tr>'+
	'<tr>'+
	'<th>Description</th>'+
	'<td colspan="3"><textarea id="txtDesc"></textarea></td>'+
	'</tr>'+
	'</table>';
	
	var foot='<input type="button" style="margin-left: 400px" onclick="saveStudentOtherFineDetails('+studentid+','+financePolicyId+')"'+
	'value="Save" class="btn btn-success btn-mini" />';
	
	juno.modal({
		header:'Student Other Fees',
		body:_table,
		footer :foot,
		width: '850px'
	});
	$('#txtFineAmnt').numeric();
	getStudentMiscellaneousAccountHeadList(financePolicyId);
}

function saveStudentOtherFineDetails(studentId, financePolicyId){
	var fineAmt = $('#txtFineAmnt').val();
	var desc = $('#txtDesc').val();
	var accountHeadId = $('#cmbAccountFor').val();
	
	if (studentId == "") {
		jAlert("Please Select Student...");
		return false;
	}
	
	if (accountHeadId == "" || accountHeadId == "0") {
		jAlert("Please Select Account Head...");
		return false;
	}
	
	if(desc ==""){
		jAlert("Please Enter Description...");
		return false;
	}
	
	if(fineAmt ==""){
		jAlert("Please Enter Amount...");
		return false;
	}
	
	$.ajax({
		url : 'saveStudentOtherFeesByStudent.json',
		dataType : 'text',
		data :{
			studentId:studentId,
			amount:fineAmt,
			desc: desc,
			accountHeadId:accountHeadId,
			financePolicyId:financePolicyId
		},
		type : 'POST',
		async : false,
		beforeSend : function() {
			startCommonAjaxSpinner();
		},
		complete : function() {
			stopCommonAjaxSpinner();
		},
		success : function() {
			$('#txtFineAmnt').val('');
			$('#txtDesc').val('');
			$('#cmbStudentId').val(0).trigger("liszt:updated");
			jAlert("Details saved successfully..", "Message");
			juno.modal('hide');
			getStudentotherFeeDetails();
			getStudentExamFeeDetails();
		},
		error : function() {
			jAlert("Error...!");
		}
	});
}

function getStudentExamFeeDetails(src) {
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	var studentId =0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	var btn='<input type="button" value="Make Payment" class="btn btn-mini btn-inverse pull-right" onclick="studentFine('+studentId+')">';
	if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="REVA_UNIVERSITY")
		btn='<input type="button" value="Make Payment" class="btn btn-mini btn-inverse pull-right" onclick="addStudentOtherFine('+studentId+',\'2\')">';
	
	$.ajax({
		url:'getMiscellaneousStudentOtherFeeDueReportOverallByStudentBatchId.json',
		data:{
			studentId:studentId,
			financePolicyId:'2'
		},
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(feeStructureJArray){
          var totalAmountToPay=0.0;
			boiler='<br><div>'+btn+'</div><br><table class="table table-condensed table-bordered tablePrint studentFineDetails">'+
			'<tr>'+
			'<th>Sr No</th><th></th>'+
			'<th>Fee Name</th>'+
			'<th>Description</th>'+
			'<th>Generated Date</th>'+
			'<th>Generated By</th>'+
			'<th>Miscellaneous Amount</th>'+
			'<th>Paid Amount</th>'+
			'<th>Payable Amount</th>'+
			'<th>Receipt No</th>'+
			'</tr>';
			if(feeStructureJArray.length>0){
				for(var i =0;i<feeStructureJArray.length;i++){
					var studentHostelFineId = feeStructureJArray[i]['studentHostelFineId'];
					var journalId = feeStructureJArray[i]['journalId']; 
					var paidAmount =feeStructureJArray[i]['paidAmount'];
					var amount = feeStructureJArray[i]['amount']!=null && feeStructureJArray[i]['amount']!=undefined && feeStructureJArray[i]['amount']!=''?feeStructureJArray[i]['amount']:0.00;
					var paidAmount = feeStructureJArray[i]['paidAmount']!=null && feeStructureJArray[i]['paidAmount']!=undefined && feeStructureJArray[i]['paidAmount']!=''?feeStructureJArray[i]['paidAmount']:0.00;
					var rceiptNo = feeStructureJArray[i]['journalId'];
					var amountPayable = eval(amount) - eval(paidAmount);
					boiler+='<tr>';
					boiler+='<td class="gems_integer">'+eval(i+1)+'</td>';
					if(rceiptNo=='' || rceiptNo==undefined )
						boiler+='<td><input type="checkbox" class="clsotherMSstudentHosFineId" value="'+studentHostelFineId+'"></td>';
					else
						boiler+='<td></td>';
					boiler+='<td>'+feeStructureJArray[i]['accountHeadname']+'</td><td>'+feeStructureJArray[i]['description']+'</td>'+
					'<td>'+feeStructureJArray[i]['generatedDate']+'</td>'+
					'<td style="text-align:left">'+feeStructureJArray[i]['generatedBy']+'</td>'+
					'<td class="gems_currency">'+amount+'</td><td class="gems_currency">'+paidAmount+'</td><td class="gems_currency">'+(amountPayable<0?(-eval(amountPayable)):eval(amountPayable))+'</td><td>'+rceiptNo+'</td></tr>';
					if(amountPayable>0)
						totalAmountToPay = eval(totalAmountToPay) + eval(amountPayable);
				}
			}else{
				boiler+='<tr><td colspan="8">Data not found !!!</td></tr>';
			}
			boiler+='</table>';
			$('#studentExamFeeDetails').html(boiler);
			var varible='';
			if($('#customerHelper').val()=="RCOEM"){
				varible ='';
			}else{
				varible ='/Bank Challan';
			}
			if(eval(totalAmountToPay)>0){
				boiler ='<br><br><b><input type="checkbox" id="chkAgreeTermsMiscellaneous1" onclick="ProccedAcademicToPayother('+totalAmountToPay+',\'2\');">&nbsp;I accept the above '+juno.labelByCustomer('l.isInvoceToFeesLabel')+' details</b> '+
				'<span> You have chosen to pay an amount <b>Rs.</b> <span id="amtForOnlinePayment">'+totalAmountToPay+'</span> from your Credit / Debit card '+varible+' of Specified bank account against '+juno.labelByCustomer('l.StudentReceivable')+'.</span><br>'+
				'<span style="font-weight:bold;color:red">*If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>'+

				'<br><div style="text-align:center" id="paymentPluginsDivForMS1"></div>'+
				'<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueForMS1"></span>'+
				'<br><div id="onlinePaymentSpanForMS1" style="display:none;" >'+
					'<span style="text-align:center;" id="onlinePaymentSpanForMS21"></span>'+
				'</div>'+
				'<br><div id="onlinePaymentSpanForMSReva" style="display:none;">'+
					'<span id="onlinePaymentSpanREVAMiscRazor" class="span3"></span>&nbsp;&nbsp;'+
					'<span id="onlinePaymentSpanREVAMiscPaytm" class="span3"></span>&nbsp;&nbsp;'+
					'<span id="onlinePaymentSpanREVAMiscEasy" class="span3"></span>&nbsp;&nbsp;'+
				'</div>';
				$('#studentExamFeeDetails').append(boiler);
			}
		}
	});
}
/*
var gstudGender='';
function showStudentHostelFeeDetails(jArrayMain){
	$('#divStudentHostelFeeInstallmentInformation').html('');
	$('#divStudentHostelFeeInformation').html('');
	$('#divStudentHostelFeeOnlineInformation').html('');
	$('#divStudentHostelFeeBankChallanInformation').html('');
	var date = new Date();
	var curYear = date.getFullYear();
	var nextYear = curYear+1;
	var jArray=jArrayMain[0];var flag=false; var invoiceAmount=0.0;
	if(jArray.length > 0){
		var boiler='';
		for(var i in jArray){
			const { RECEIVABLE=0, RECEIVED=0, InfraTypeName='', roomDetails='', 
					FromDate,ToDate, Excess=0, FeeItemId=0, StudentFeeInvoiceId=0,
					feeStructureName='',Pending=0, concessionGivenAmount=0,GENDER='' }=jArray[i];
			tempId = `trFeeStructureId-${FeeItemId}-${StudentFeeInvoiceId}`;
			var temp=RECEIVABLE==0?'alert alert-error':'';
			boiler+=`<tr id="${tempId}" class="${temp}">
				<td id="Feename">${feeStructureName}</td>
				<td id="Feename">${InfraTypeName}</td>
				<td id="Feename">${roomDetails}</td>`;
				if($('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
					boiler+=`<td id="Feename">${curYear} - ${nextYear}</td>`;
				}else{
					boiler+=`<td id="Feename">${FromDate} - ${ToDate}</td>`;
				}
				boiler+=`<td style="text-align:right;" class="studentReceivable gems_currency">${RECEIVABLE}</td>
				<td style="text-align:right;" class="studentPaid gems_currency">${RECEIVED}</td>
				<td style="text-align:right;" class="concessionAmount gems_currency">${concessionGivenAmount}</td>
				<td style="text-align:right;" class="studentPending gems_currency">${Pending}</td>
				<td style="text-align:right;" class="studentPayable gems_currency">${Excess}</td>
				</tr>`;
				invoiceAmount +=eval(Pending);
				gstudGender = GENDER;
		}
		
		$('#divStudentHostelFeeInformation').html(`</br><div class="label label-info" style="padding:2px;text-align:center">Hostel Fee Structure Details</div></br>
		<table class="table table-bordered table-condensed"  style="margin-top:-14px"><thead>
		<tr><th>Fee Structure Name</th>
		<th>Infrastructure Name</th>
		<th>Room Details</th>
		<th>Fee Structure Dates</th>
		<th class="gems_currency_label">Total Fees</th>
		<th class="gems_currency_label">Paid Amount</th>
		<th class="gems_currency_label">Concession Given</th>
		<th class="gems_currency_label">${juno.labelByCustomer('l.StudentReceivable')}</th>
		<th class="gems_currency_label">${juno.labelByCustomer('l.StudentPayable')}</th>
		</tr></thead>
				<tbody id="feeStructure">${boiler}</tbody>
		<tfoot><tr><th colspan="4" class="gems_currency_label">Total</th> 
		<th id="studentReceivable" style="text-align:right;" class="gems_currency"></th>
		<th id="studentPaid" style="text-align:right;" class="gems_currency"></th>
		<th id="concessionAmount" style="text-align:right;" class="gems_currency"></th>
		<th id="studentPending" style="text-align:right;" class="gems_currency"></td></th>
		<th id="studentPayable" style="text-align:right;" class="gems_currency">
		</th></tr></tfoot></table></br></br>`);
		
		var studentReceivable=0;
		$('.studentReceivable').each(function() {
			studentReceivable+=eval($(this).html());
		});
		$('#studentReceivable').text(studentReceivable);
		var studentPaid=0;
		$('.studentPaid').each(function() {
			studentPaid+=eval($(this).html());
		});
		$('#studentPaid').text(studentPaid);
		var studentPending=0;
		$('.studentPending').each(function() {
			studentPending+=eval($(this).html());
		});
		$('#studentPending').text(studentPending);
		var studentPayable=0;
		$('.studentPayable').each(function() {
			studentPayable+=eval($(this).html());
		});
		$('#studentPayable').text(studentPayable);
		var concessionAmount=0;
		$('.concessionAmount').each(function() {
			concessionAmount+=eval($(this).html());
		});
		$('#concessionAmount').text(concessionAmount);
		
		flag=invoiceAmount>0?true:false;
		$('#divStudentHostelFeePaymentInformation').html('');
	} else {
		$('#divStudentHostelFeeInformation').html('<div class="alert alert-error"><strong>Sorry!! No Fee structure found</strong></div>');
	}
	
	var jArray=jArrayMain[1];
	if(jArray.length > 0){
		var boiler='';
		for(var i in jArray){
			const { TransactionUniqueReference='', TransactionAmount=0, TransactionCategory='', TransactionDate=''}=jArray[i];
			tempId ='';// `trFeeStructureId-${FeeItemId}-${StudentFeeInvoiceId}`;
			boiler+=`<tr id="${tempId}">
				<td>${TransactionUniqueReference}</td>
				<td>${TransactionCategory}</td>
				<td style="text-align:right;" class="TransactionAmount gems_currency">${TransactionAmount}</td>
				<td>${TransactionDate}</td>
				</tr>`;
		}
		
		$('#divStudentHostelFeeOnlineInformation').html(`</br><div class="label label-info" style="padding:2px;text-align:center">Hostel Fee Online Transactions Details</div></br>
		<table class="table table-bordered table-condensed"  style="margin-top:-14px"><thead>
		<tr><th>Transaction Number</th>
		<th>Transaction Category</th>
		<th class="gems_currency_label">Transaction Amount</th>
		<th>Transaction Date</th>
		</tr></thead>
				<tbody id="feeStructure">${boiler}</tbody>
		<tfoot><tr><th colspan="2" class="gems_currency_label">Total</th> 
		<th id="TransactionAmount" style="text-align:right;" class="gems_currency"></th>
		<th></th></tr></tfoot></table></br></br>`);
		
		var TransactionAmount=0;
		$('.TransactionAmount').each(function() {
			TransactionAmount+=eval($(this).html());
		});
		$('#TransactionAmount').text(TransactionAmount);
	}
	
	var jArray=jArrayMain[2];
	if(jArray.length > 0){
		var boiler='';
		for(var i in jArray){
			const { TransactionUniqueReference='', TransactionAmount=0, TransactionCategory='', TransactionDate=''}=jArray[i];
			tempId ='';// `trFeeStructureId-${FeeItemId}-${StudentFeeInvoiceId}`;
			boiler+=`<tr id="${tempId}">
				<td>${TransactionUniqueReference}</td>
				<td>${TransactionCategory}</td>
				<td style="text-align:right;" class="bctTransactionAmount gems_currency">${TransactionAmount}</td>
				<td>${TransactionDate}</td>
				</tr>`;
		}
		
		$('#divStudentHostelFeeBankChallanInformation').html(`</br><div class="label label-info" style="padding:2px;text-align:center">Hostel Fee Bank Challan Details</div></br>
		<table class="table table-bordered table-condensed"  style="margin-top:-14px"><thead>
		<tr><th>Transaction Number</th>
		<th>Transaction Category</th>
		<th class="gems_currency_label">Transaction Amount</th>
		<th>Transaction Date</th>
		</tr></thead>
				<tbody id="feeStructure">${boiler}</tbody>
		<tfoot><tr><th colspan="2" class="gems_currency_label">Total</th> 
		<th id="bctTransactionAmount" style="text-align:right;" class="gems_currency"></th>
		<th></th></tr></tfoot></table></br></br>`);
		
		var bctTransactionAmount=0;
		$('.bctTransactionAmount').each(function() {
			bctTransactionAmount+=eval($(this).html());
		});
		$('#bctTransactionAmount').text(bctTransactionAmount);
	}
	var InstallmentIds='';
	var jArray=jArrayMain[3];
	if(jArray.length > 0){
		var boiler='';
		for(var i in jArray){
			const { InstallmentNo='', InstallmentAmount=0, InstallmentDate='', ChargesAmount=0, 
					ChargesType='',LateFee='', OnFees='', studentFeeInstallmentId=0,
					feeItemId=0, studentFeeInvoiceId=0}=jArray[i];
			tempId ='';// `trFeeStructureId-${FeeItemId}-${StudentFeeInvoiceId}`;
			var amt=eval(InstallmentAmount)+eval(ChargesAmount);
			InstallmentIds+= studentFeeInstallmentId +','
			var temp='';
			if(i==0)
				temp=`<input type="checkbox" id="chkb_Inst_0" installmentId="${studentFeeInstallmentId}" feeItemId="${feeItemId}" studentFeeInvoiceId="${studentFeeInvoiceId}" class="clsInstallmentforHostel clsInstallmentId" value="${amt}" onclick="checkBoxSelectionforHostelInstallment(${amt});">`;
			else
				temp=`<input type="checkbox" style="display:none" installmentId="${studentFeeInstallmentId}" feeItemId="${feeItemId}" studentFeeInvoiceId="${studentFeeInvoiceId}" class="clsInstallmentforHostel clsInstallmentId" value="${amt}" onclick="checkBoxSelectionforHostelInstallment(${amt});">`;

			boiler+=`<tr id="${tempId}">
				<td style="text-align:center">${temp}</td>
				<td class="gems_integer">${InstallmentNo}</td>
				<td class="InstallmentAmount gems_currency">${InstallmentAmount}</td>
				<td>${InstallmentDate}</td>
				<td>${ChargesType}</td>
				<td class="ChargesAmount gems_currency">${ChargesAmount}</td>
				<td>${LateFee}</td>
				<td class="amt gems_currency">${amt}</td>
				</tr>`;
		}
		
		$('#divStudentHostelFeeInstallmentInformation').html(`</br><div class="label label-info" style="padding:2px;text-align:center">Hostel Fee Installment Details</div></br>
		<table class="table table-bordered table-condensed"  style="margin-top:-14px"><thead>
		<tr><th></th><th>Installment No</th>
		<th class="gems_currency_label">Installment Amount</th>
		<th>Installment Date</th>
		<th>Charges Type</th>
		<th class="gems_currency_label">Charges Amount</th>
		<th>No of Late Days/Months</th>
		<th>Your Charges amount</th>
		</tr></thead>
				<tbody id="feeStructure">${boiler}</tbody>
		<tfoot><tr><th colspan="2" class="gems_currency_label">Total</th> 
		<th id="InstallmentAmount" style="text-align:right;" class="gems_currency"></th>
		<th colspan="2"></th>
		<th id="ChargesAmount" style="text-align:right;" class="gems_currency"></th>
		<th></th>
		<th id="amtT" style="text-align:right;" class="gems_currency"></th>
		</tr></tfoot></table></br></br><div id="studentInstallmentList"></div>`);
		
		var InstallmentAmount=0;
		$('.InstallmentAmount').each(function() {
			InstallmentAmount+=eval($(this).html());
		});
		$('#InstallmentAmount').text(InstallmentAmount);
		var ChargesAmount=0;
		$('.ChargesAmount').each(function() {
			ChargesAmount+=eval($(this).html());
		});
		$('#ChargesAmount').text(ChargesAmount);
		var amtT=0;
		$('.amt').each(function() {
			amtT+=eval($(this).html());
		});
		$('#amtT').text(amtT);
	}
	
	if(flag==true) {
		var varible=($('#customerHelper').val()=="RCOEM")?'':'/Bank Challan';
		if(jArray.length>0){
			InstallmentIds=InstallmentIds.substring(0, InstallmentIds.length-1);
			$('#studentInstallmentList').html(`<br><b><div class="badge badge-success"><input type="checkbox" class="clsInstallmentId clsInstallment clsInstallmentAll" installmentid="${InstallmentIds} value="${invoiceAmount}" id="makeAllInstallmentPaymentHostel" onclick="checkBoxSelectionforHostelInstallment(${invoiceAmount},'all');">&nbsp;To make full payment with All Installment, select this checkbox</b>`);
		}
		var	boiler =`<br><br><b><input type="checkbox" id="chkAgreeHostelFeesTerms" onclick="proceedingtoHostelFeePaid(${invoiceAmount})">
				&nbsp;I accept the above ${juno.labelByCustomer('l.isInvoceToFeesLabel')} details</b> 
				<span> You have chosen to pay an amount <b>Rs.</b> 
				<span id="amtForHostelPayment" orgvalue="${invoiceAmount}">${invoiceAmount}</span>
				from your Credit / Debit card ${varible} of Specified bank account against ${juno.labelByCustomer('l.StudentReceivable')}.</span><br>
				<span style="font-weight:bold;color:red">* 
				If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>
				<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueHostel"></span>&nbsp;&nbsp;&nbsp;&nbsp;
				<span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueHostel2"></span></br>`;

		if($('#customerHelper').val()=="RCOEM")
			$('#divStudentHostelFeePaymentInformation').append('');
		else
			$('#divStudentHostelFeePaymentInformation').append(boiler);
		
		$('#chkb_Inst_0').trigger('click');
		setTimeout(function(){$('#chkb_Inst_0').attr("checked",true);},200);
	}
}
*/
function checkBoxSelectionforHostelInstallment(invoiceAmount, flag){
	$('#amtForHostelPayment').html(invoiceAmount);
	$('#chkAgreeHostelFeesTerms').attr("checked",false);
	if(flag!=undefined && flag=='all') {
		if($('#makeAllInstallmentPaymentHostel').is(":checked")) {
			$('.clsInstallmentforHostel').each(function(){
				$(this).attr("checked",true);
				$(this).attr("editable",true);
				$(this).attr("readonly",true);
				$(this).attr("disable",true);
				$(this).show();
			});
		}else {
			$('.clsInstallmentforHostel').each(function(){
				$(this).attr("checked",false);
				$(this).attr("editable",false);
				$(this).attr("readonly",false);
				$(this).attr("disable",false);
				$(this).hide();
			});
			
			$('#chkb_Inst_0').show();
			$('#chkb_Inst_0').trigger('click');
			setTimeout(function(){$('#chkb_Inst_0').attr("checked",true);},200);
		}
	}
}

/*function proceedingtoHostelFeePaid(paymentAmount) {
	alert("GGG");
	paymentAmount=$('#amtForHostelPayment').text();
	if($('#chkAgreeHostelFeesTerms').is(':checked')){
		jConfirm("Do you want to Proceed Hostel Online payment with amount "+paymentAmount+" ?","Confirm",function(r){
			if(r){
				var installmentIds = new Array();
			    $('.clsInstallmentforHostel:checked').each(function(){
			    	installmentIds.push($(this).attr("installmentId"));
			    });
			    if(eval(paymentAmount)>0 && paymentAmount!=undefined) {
			    	$.ajax({
			    		url : 'setHostelPableAmountInSessionbyStudent.json',
			    		dataType : 'json',
			    		type : 'POST',
			    		data:{
			    			installmentIds:installmentIds.toString(),
			    			PaymentAmmount:paymentAmount
			    		},
			    		async : false,
			    		junoSpinner:true,
			    		success : function(obj) {
			    			if(obj.msg=='success') {
			    				var bankIds=obj.bankIds;
			    				$('#paymentPluginsStudentFeeDueHostel').show();
			    				if($('#customerHelper').val()=="RCOEM"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt2({sPC:'HOSTF',iFBIDs:bankIds});
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt2({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()=="STJOHNS"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue10Pymt({
			    						sPC : 'HOSTF',
			    						iFBIDs:bankIds
			    					});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
			    					$('#paymentPluginsStudentFeeDueHostel').payUPymt({
			    						sPC : 'HOSTF',
			    						iFBIDs :bankIds,
			    						bR:false,
			    					});
			    				}else if($('#customerHelper').val()=="ICT_MUMBAI"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt({
			    						sPC : 'HOSTF',
			    						iFBIDs:bankIds,
			    					});
			    				}
			    				else if($('#customerHelper').val()=="CHANAKYA"){
			    					$('#paymentPluginsStudentFeeDueHostel').bdpymtV3({
			    						sPC : 'HOSTF'
			    					});
			    				}else if($('#customerHelper').val()=="INDIRA_PUNE"){
			    					$('#paymentPluginsStudentFeeDueHostel').junoPymt({
			    						sPC:'HOSTF' , 
			    						iFBIDs:bankIds,
			    						sSrc:'INS'
			    					});
			    				}
			    				else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue4Pymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
			    					$('#paymentPluginsStudentFeeDueHostel').techProcessPymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue7Pymt({
			    						sPC:'HOSTF',
			    						iFBIDs:bankIds
			    					});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="HPTELIBRARY"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue8Pymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
			    					$('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}

			    			}else {
			    				jAlert(obj.msg,"warning");
			    			}
			    		},
			    	});
			    }
			}
		});
	}
}*/

function getHostelStudentMiscellaneousByStudentId(src) {
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	var studentId =0;
	if($('#studentId').val()!=null){
		studentId = $('#studentId').val();
	}else{
		studentId = $('#studentId123').val();
	}
	$.ajax({
		url:'getHostelStudentMiscellaneousByStudentId.json',
		data:{StudentId:studentId},
		dataType:'json',
		junoSpinner:true,
		success:function(jArray){
			showHostelFine(jArray);
		}
	});
}

function showHostelFine(jArray) {	
	var totalAmountToPay = 0;
	if(jArray!=null && jArray.length > 0){
		boiler=`<table class="table table-condensed table-bordered tablePrint studentFineDetails">
		<head><tr>
		<th></th>
		<th>Sr No</th>
		<th>Description</th>
		<th>Generated Date</th>
		<th>Generated By</th>
		<th class="gems_currency_label">Miscellaneous Amount</th>
		<th class="gems_currency_label">Paid Amount</th>
		<th class="gems_currency_label">Payable Amount</th>
		<th>Receipt No</th>
		</tr></head><tbody>`;
		var cnt=0,totAmt=0,totP=0,totRem=0;
		for(var i in jArray){
			const { studentHostelFineId=0, financePolicyId=0, receivable=0, received=0,
			pending=0, studentId=0, description='', generatedBy='', generatedAt='',
			receiptNo=''}=jArray[i];
			totRem+=eval(pending);totP+=eval(received);totAmt+=eval(receivable);	
			var temp='';
			if(pending>0)
				temp=`<input type="checkbox" id="chkStudentHostelMisc" class="chkStudentHostelMiscAmtCls" studentHostelFineId="${studentHostelFineId}" value="${pending}" onclick="proceedtoHostelMisc()">`;
					
			boiler +=`<tr>
				<td>${temp}</td>
				<td class="gems_integer">${++cnt}</td>
				<td>${description}</td>
				<td>${generatedAt}</td>
				<td>${generatedBy}</td>
				<td class="gems_currency">${receivable}</td>
				<td class="gems_currency">${received}</td>
				<td class="gems_currency">${pending}</td>
				<td>${receiptNo}</td>
				</tr>`;		
		}
		totalAmountToPay=totRem;
		boiler +=`</tbody><tfoot><tr><th colspan="5" class="gems_currency_label">Total</th>
				<th class="gems_currency">${totAmt}</th>
				<th class="gems_currency">${totP}</th>
				<th class="gems_currency">${totRem}</th><th></th>
				</tr></tfoot>`; 
		$('#divStudentFeeDueInformationMiscellaneousHostel').html(boiler);
		
		if($('#customerHelper').val()!="BLM_MUNJAL"){
			var varible='';
			if($('#customerHelper').val()!="RCOEM"){
				varible ='/Bank Challan';
			}
			boiler =`
			<div id="miscHostelTotalDiv" style="display:none;"><b>
				<input type="checkbox" id="chkAgreeTermsMiscellaneousHostel" onclick="proceetoHostelMisc(${totalAmountToPay});">
					&nbsp;I accept the above ${juno.labelByCustomer('l.isInvoceToFeesLabel')} details</b><br> 
			<span> You have chosen to pay an amount <b>Rs.</b> <label id="amtMiscHostelForOnlinePayment" class="amtForOnlinePaymentMisc" miscTotalAmt="${totalAmountToPay}">${totalAmountToPay}</label> 
					from your Credit / Debit card ${varible} of Specified bank account against ${juno.labelByCustomer('l.StudentReceivable')}.</span><br>
			<span style="font-weight:bold;color:red">*If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>
			<br><div style="text-align:center" id="paymentPluginsDivForMS"></div>
			<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueForMS"></span>
			<br><div id="onlinePaymentSpanForMS" style="display:none;" >
			<span style="text-align:center;" id="onlinePaymentSpanForMS2"></span>
			<div></div>`;
			$('#divStudentFeeDueInformationMiscellaneousHostel').append(boiler);
		}
	} else {
		$('#divStudentFeeDueInformationMiscellaneousHostel').html(`<div class="alert alert-error"><strong>Sorry!! No Hostel Miscellaneous found !!!</strong></div>`);
	}
	var bankId = 2;
	$(document).ready( function() {
		$('#paymentPluginsStudentFeeDueMisc').bcpymt({sPC:'MISCF',bWFH:false,iFBIDs:bankId});
	});
}

function proceedtoHostelMisc(){
	if($('.chkStudentHostelMiscAmtCls').is(':checked')) {
		$('#miscHostelTotalDiv').show();
		var amt=0;
		var pendingAmt=$('#chkStudentHostelMisc').val();
		$('.chkStudentHostelMiscAmtCls:checked').each(function(){
			amt+=$(this).val()!=null && $(this).val()!=''?eval($(this).val()):0;
		});
		$('#amtMiscHostelForOnlinePayment').text(amt);
		$('#amtMiscHostelForOnlinePayment').attr('miscTotalAmt',amt);
	}else {
		$('#miscHostelTotalDiv').hide();
		$('#amtMiscHostelForOnlinePayment').val('0');
		$('#amtMiscHostelForOnlinePayment').attr('miscTotalAmt','0');
	}
}

function proceetoHostelMisc(totalAmountToPay){  
//	alert(totalAmountToPay);
	if($('#chkAgreeTermsMiscellaneousHostel').is(':checked')){
		var boiler = '<input type="radio" class="" name="paymentMode" id="" value="" onclick="$(\'#onlinePaymentSpanForMS\').show();$(\'#paymentPluginsStudentFeeDueForMS\').hide();" /><b> Online Payment &nbsp;&nbsp;&nbsp;</b>';
		$('#paymentPluginsDivForMS').html(boiler).show();
		var studentHostelFineIdArry=new Array();
		var studentHostelFineId=0;
		$('.chkStudentHostelMiscAmtCls:checked').each(function(){
			studentHostelFineId=$(this).attr('studentHostelFineId');
			studentHostelFineIdArry.push(studentHostelFineId);
		});
		$.ajax({
			url : 'fetchStudentHostelMiscellaneousFeeDetail.json',
			dataType : 'json',
			data:{studentHostelFineIdArry:studentHostelFineIdArry.toString()},
			async : false,
			beforeSend : function() {
				startCommonAjaxSpinner();
			},
			complete : function() {
				stopCommonAjaxSpinner();
			},
			success : function(jArray1) {
				if(jArray1.length>0 && jArray1[0]["error"]=='success'){
					
					if($('#customerHelper').val()=="MAHINDRA_UNIVERSITY"){
						$('#onlinePaymentSpanForMS2').junoPymt({sPC:'HMISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
						$('#onlinePaymentSpanForMS2').ccAvenue4Pymt({sPC:'HMISCF',iFBIDs:jArray1[0]["bankIds0"]});
					}
				}else {
					jAlert(jArray1[0]["error"]);
					//$('#chkAgreeTermsMiscellaneousHostel').trigger('click');
				}
			},
		});
	}else{
		$('#paymentPluginsDivForMS').hide();
		$('#onlinePaymentSpanForMS').hide();
		$('#paymentPluginsStudentFeeDueForMS').hide();
	}
}

var gstudGender='';
function showStudentHostelFeeDetails(jArrayMain){
	$('#divStudentHostelFeeInstallmentInformation').html('');
	$('#divStudentHostelFeeInformation').html('');
	$('#divStudentHostelFeeOnlineInformation').html('');
	$('#divStudentHostelFeeBankChallanInformation').html('');
	var date = new Date();
	var curYear = date.getFullYear();
	var nextYear = curYear+1;
	var FINANCE_POLICY_ID=0;
	var occupantId=0;
	var jArray=jArrayMain[0];var flag=false; var invoiceAmount=0.0;
	if(jArray!=undefined){
		var boiler='';
		for(var i in jArray){
			const { RECEIVABLE=0, RECEIVED=0, InfraTypeName='', roomDetails='',feeStructureYear='', 
					FromDate,ToDate, Excess=0, FeeItemId=0, StudentFeeInvoiceId=0,
					feeStructureName='',Pending=0, concessionGivenAmount=0,GENDER='',}=jArray[i];
			tempId = `trFeeStructureId-${FeeItemId}-${StudentFeeInvoiceId}`;
			
			let studentPayableAmt = parseFloat(RECEIVABLE) - parseFloat(RECEIVED) - parseFloat(concessionGivenAmount);
			let excessAmt = 0.00;
			if(studentPayableAmt<0)
				excessAmt = eval(-studentPayableAmt);
			
			FINANCE_POLICY_ID = jArray[i].FINANCE_POLICY_ID;
			occupantId = jArray[i].OccupantId;
			var temp=RECEIVABLE==0?'alert alert-error':'';
			boiler+=`<tr id="${tempId}" class="${temp}">
				<td id="Feename">${feeStructureName}</td>
				<td id="Feename">${InfraTypeName}</td>
				<td id="Feename">${roomDetails}</td>`;
				if($('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
					boiler+=`<td id="Feename">${feeStructureYear}</td>`;
				}else{
					if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()!="CMR_UNIVERSITY" && $('#customerHelper').val()!="CMR_IT"))
						boiler+=`<td id="Feename">${FromDate} - ${ToDate}</td>`;
				}
				
				boiler+=`<td style="text-align:right;" class="studentReceivable gems_currency">${RECEIVABLE}</td>
				<td style="text-align:right;" class="studentPaid gems_currency">${RECEIVED}</td>
				<td style="text-align:right;" class="concessionAmount gems_currency">${concessionGivenAmount}</td>
				<td style="text-align:right;" class="studentPending gems_currency">${Pending}</td>
				<td style="text-align:right;" class="studentPayable gems_currency">${excessAmt}</td>`;
				//if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY")
				    boiler+=`<td><input type="button" value="Hostel Receipt" class="btn btn-mini btn-inverse  btnColorBlack " onclick="studentBillingInfoHostelreceipt(${StudentFeeInvoiceId});"</td>`;
			 boiler+=`</tr>`;
								
				invoiceAmount +=eval(Pending);
				gstudGender = GENDER;
		}
		
		var newBoiler='';
		var showStudentHostelInvoiceFeesDetails = $('#showStudentHostelInvoiceFeesDetails').val();
		if(showStudentHostelInvoiceFeesDetails=="true")
			newBoiler+='<a href="#" style="float:left;display:none;" class="btn btn-mini btn-inverse" onclick="refreshHostelFeestructureAllDetails('+occupantId+')"><i class="fa fa-refresh"></i>&nbsp; Refresh</a><br>';
		
		newBoiler+=`</br><div class="label label-info" style="padding:2px;text-align:center">Hostel Fee Structure Details</div></br>
		<table class="table table-bordered table-condensed"  style="margin-top:-14px"><thead>
		<tr><th>Fee Structure Name</th>
		<th>Infrastructure Name</th>
		<th>Room Details</th>`
		
		if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()!="CMR_UNIVERSITY" && $('#customerHelper').val()!="CMR_IT"))
			newBoiler+=`<th>Fee Structure Dates</th>`;
		
		newBoiler+=`<th class="gems_currency_label">Total Fees</th>
		<th class="gems_currency_label">Paid Amount</th>
		<th class="gems_currency_label">Concession Given</th>
		<th class="gems_currency_label">${juno.labelByCustomer('l.StudentReceivable')}</th>
		<th class="gems_currency_label">${juno.labelByCustomer('l.StudentPayable')}</th>`;
		
	 // if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
	     newBoiler+=`<th>Generate ${juno.labelByCustomer('l.isInvoceToFeesLabel')}</th>`;
      // }

	     newBoiler+= `</tr></thead>
			<tbody id="feeStructure">${boiler}</tbody>
		<tfoot><tr>`;
		
		if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()!="CMR_UNIVERSITY" && $('#customerHelper').val()!="CMR_IT"))
			newBoiler+=`<th colspan="4" class="gems_currency_label">Total</th>`;
		else
			newBoiler+=`<th colspan="3" class="gems_currency_label">Total</th>`;
		
		newBoiler+=`<th id="studentReceivable" style="text-align:right;" class="gems_currency"></th>
		<th id="studentPaid" style="text-align:right;" class="gems_currency"></th>
		<th id="concessionAmount" style="text-align:right;" class="gems_currency"></th>
		<th id="studentPending" style="text-align:right;" class="gems_currency"></td></th>
		<th id="studentPayable" style="text-align:right;" class="gems_currency">
		</th><th></th></tr></tfoot></table></br></br>`;
		$('#divStudentHostelFeeInformation').html(newBoiler);
		
		var studentReceivable=0;
		$('.studentReceivable').each(function() {
			studentReceivable+=eval($(this).html());
		});
		$('#studentReceivable').text(studentReceivable);
		var studentPaid=0;
		$('.studentPaid').each(function() {
			studentPaid+=eval($(this).html());
		});
		$('#studentPaid').text(studentPaid);
		var studentPending=0;
		$('.studentPending').each(function() {
			studentPending+=eval($(this).html());
		});
		$('#studentPending').text(studentPending);
		var studentPayable=0;
		$('.studentPayable').each(function() {
			studentPayable+=eval($(this).html());
		});
		$('#studentPayable').text(studentPayable);
		var concessionAmount=0;
		$('.concessionAmount').each(function() {
			concessionAmount+=eval($(this).html());
		});
		$('#concessionAmount').text(concessionAmount);
		
		flag=invoiceAmount>0?true:false;
		$('#divStudentHostelFeePaymentInformation').html('');
	} else {
		$('#divStudentHostelFeeInformation').html('<div class="alert alert-error"><strong>Sorry!! No Fee structure found</strong></div>');
	}
	

	var InstallmentIds='';
	var jArray=jArrayMain[3];
	if(jArray!=undefined){
		var boiler='';
		for(var i in jArray){
			const { InstallmentNo='', InstallmentAmount=0, InstallmentDate='', ChargesAmount=0, 
					ChargesType='',LateFee='', OnFees='', studentFeeInstallmentId=0,
					feeItemId=0, studentFeeInvoiceId=0,monthormonth=0,amountCharges=0}=jArray[i];
			tempId ='';// `trFeeStructureId-${FeeItemId}-${StudentFeeInvoiceId}`;
			var amt=eval(InstallmentAmount)+eval(amountCharges);
			InstallmentIds+= studentFeeInstallmentId +','
			var temp='';
			if(i==0)
				temp=`<input type="checkbox" id="chkb_Inst_0" installmentId="${studentFeeInstallmentId}" feeItemId="${feeItemId}" studentFeeInvoiceId="${studentFeeInvoiceId}" class="clsInstallmentforHostel clsInstallmentId" value="${amt}" amountCharges="${amountCharges}" onclick="checkBoxSelectionforHostelInstallment(${amt});">`;
			else
				temp=`<input type="checkbox" style="display:none" installmentId="${studentFeeInstallmentId}" feeItemId="${feeItemId}" studentFeeInvoiceId="${studentFeeInvoiceId}" class="clsInstallmentforHostel clsInstallmentId" value="${amt}" amountCharges="${amountCharges}" onclick="checkBoxSelectionforHostelInstallment(${amt});">`;

			boiler+=`<tr id="${tempId}">
				<td style="text-align:center">${temp}</td>
				<td class="gems_integer">${InstallmentNo}</td>
				<td class="InstallmentAmount gems_currency">${InstallmentAmount}</td>
				<td>${InstallmentDate}</td>
				<td>${ChargesType}</td>
				<td class="ChargesAmount gems_currency">${ChargesAmount}</td>
				<td class="gems_integer">${monthormonth}</td>
				<td class="gems_currency">${amountCharges}</td>
				<td class="amt gems_currency">${amt}</td>
				</tr>`;
		}
		
		$('#divStudentHostelFeeInstallmentInformation').html(`</br><div class="label label-info" style="padding:2px;text-align:center">Hostel Fee Installment Details</div></br>
		<table class="table table-bordered table-condensed"  style="margin-top:-14px"><thead>
		<tr><th></th><th>Installment No</th>
		<th class="gems_currency_label">Installment Amount</th>
		<th>Installment Date</th>
		<th>Charges Type</th>
		<th class="gems_currency_label">Charges Amount</th>
		<th>No of Late Days/Months</th>
		<th>Your Charges amount</th>
		<th>Payable amount</th>
		</tr></thead>
				<tbody id="feeStructure">${boiler}</tbody>
		<tfoot><tr><th colspan="2" class="gems_currency_label">Total</th> 
		<th id="InstallmentAmount" style="text-align:right;" class="gems_currency"></th>
		<th colspan="3"></th>
		<th id="ChargesAmount" style="text-align:right;" class="gems_currency"></th>
		<th></th>
		<th id="amtT" style="text-align:right;" class="gems_currency"></th>
		</tr></tfoot></table></br></br><div id="studentInstallmentList"></div>`);
		
		var InstallmentAmount=0;
		$('.InstallmentAmount').each(function() {
			InstallmentAmount+=eval($(this).html());
		});
		$('#InstallmentAmount').text(InstallmentAmount);
		var ChargesAmount=0;
		$('.ChargesAmount').each(function() {
			ChargesAmount+=eval($(this).html());
		});
		$('#ChargesAmount').text(ChargesAmount);
		var amtT=0;
		$('.amt').each(function() {
			amtT+=eval($(this).html());
		});
		$('#amtT').text(amtT);
	}
	
	if(flag==true) {
		var varible=($('#customerHelper').val()=="RCOEM")?'':'/Bank Challan';
		if(jArray.length>0){
			InstallmentIds=InstallmentIds.substring(0, InstallmentIds.length-1);
			$('#studentInstallmentList').html(`<br><b><div class="badge badge-success"><input type="checkbox" class="clsInstallmentId clsInstallment clsInstallmentAll" installmentid="${InstallmentIds} value="${invoiceAmount}" id="makeAllInstallmentPaymentHostel" onclick="checkBoxSelectionforHostelInstallment(${invoiceAmount},'all');">&nbsp;To make full payment with All Installment, select this checkbox</b>`);
		}
		
		var	boiler =`<br><br><b><input type="checkbox" id="chkAgreeHostelFeesTerms" onclick="proceedingtoHostelFeePaid(${invoiceAmount},${FINANCE_POLICY_ID})">
				&nbsp;I accept the above ${juno.labelByCustomer('l.isInvoceToFeesLabel')} details</b> 
				<span> You have chosen to pay an amount <b>Rs.</b> 
				<span id="amtForHostelPayment" orgvalue="${invoiceAmount}">${invoiceAmount}</span>
				from your Credit / Debit card ${varible} of Specified bank account against ${juno.labelByCustomer('l.StudentReceivable')}.</span><br>
				<span style="font-weight:bold;color:red">* 
				If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>
				<br><span style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueHostel"></span>&nbsp;&nbsp;&nbsp;&nbsp;
				<span  style="text-align:center;display:none;" id="paymentPluginsStudentFeeDueHostel2"></span><br>`;

		if($('#customerHelper').val()=="RCOEM")
			$('#divStudentHostelFeePaymentInformation').append('');
		else
			$('#divStudentHostelFeePaymentInformation').append(boiler);
		
		$('#chkb_Inst_0').trigger('click');
		setTimeout(function(){$('#chkb_Inst_0').attr("checked",true);},200);
	}
}

function checkBoxSelectionforHostelInstallment(invoiceAmount, flag){
	$('#amtForHostelPayment').html(invoiceAmount);
	$('#chkAgreeHostelFeesTerms').attr("checked",false);
	if(flag!=undefined && flag=='all') {
		if($('#makeAllInstallmentPaymentHostel').is(":checked")) {
			$('.clsInstallmentforHostel').each(function(){
				$(this).attr("checked",true);
				$(this).attr("editable",true);
				$(this).attr("readonly",true);
				$(this).attr("disable",true);
				$(this).show();
				var amountCharges=$(this).attr('amountCharges');
				invoiceAmount=invoiceAmount+eval(amountCharges);
				$('#amtForHostelPayment').html(invoiceAmount);
			});
		}else {
			$('.clsInstallmentforHostel').each(function(){
				$(this).attr("checked",false);
				$(this).attr("editable",false);
				$(this).attr("readonly",false);
				$(this).attr("disable",false);
				$(this).hide();
			});
			
			
			$('#chkb_Inst_0').show();
			$('#chkb_Inst_0').trigger('click');
			setTimeout(function(){$('#chkb_Inst_0').attr("checked",true);},200);
		}
	}
}

function proceedingtoHostelFeePaid(paymentAmount,FINANCE_POLICY_ID) {
	paymentAmount=$('#amtForHostelPayment').text();
	if($('#chkAgreeHostelFeesTerms').is(':checked')){
		jConfirm("Do you want to Proceed Hostel Online payment with amount "+paymentAmount+" ?","Confirm",function(r){
			if(r){
				var installmentIds = new Array();
			    $('.clsInstallmentforHostel:checked').each(function(){
			    	installmentIds.push($(this).attr("installmentId"));
			    });
			    if(eval(paymentAmount)>0 && paymentAmount!=undefined) {
			    	$.ajax({
			    		url : 'setHostelPableAmountInSessionbyStudent.json',
			    		dataType : 'json',
			    		type : 'POST',
			    		data:{
			    			installmentIds:installmentIds.toString(),
			    			PaymentAmmount:paymentAmount,
			    			financePolicyId:FINANCE_POLICY_ID
			    		},
			    		async : false,
			    		junoSpinner:true,
			    		success : function(obj) {
			    			if(obj.msg=='success') {
			    				var bankIds=obj.bankIds;
			    				$('#paymentPluginsStudentFeeDueHostel').show();
								$('#paymentPluginsStudentFeeDueHostel2').show();
			    				if($('#customerHelper').val()=="RCOEM"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt2({sPC:'HOSTF',iFBIDs:bankIds});
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt2({sPC:'HOSTF',iFBIDs:bankIds});

			    				}else if($('#customerHelper').val()=="STJOHNS"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue10Pymt({
			    						sPC : 'HOSTF',
			    						iFBIDs:bankIds
			    					});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="DES"){
			    					$('#paymentPluginsStudentFeeDueHostel').payUPymt({
			    						sPC : 'HOSTF',
			    						iFBIDs :bankIds,
			    						bR:false,
			    					});
			    				}else if($('#customerHelper').val()=="ICT_MUMBAI"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenuePymt({
			    						sPC : 'HOSTF',
			    						iFBIDs:bankIds,
			    					});
			    				}
			    				else if($('#customerHelper').val()=="CHANAKYA"){
			    					$('#paymentPluginsStudentFeeDueHostel').bdpymtV3({
			    						sPC : 'HOSTF'
			    					});
			    				}else if($('#customerHelper').val()=="INDIRA_PUNE"){
			    					$('#paymentPluginsStudentFeeDueHostel').junoPymt({
			    						sPC:'HOSTF' , 
			    						iFBIDs:bankIds,
			    						sSrc:'INS'
			    					});
			    				}
			    				else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MIT"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue4Pymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MATSUNIVERSITY"){
			    					$('#paymentPluginsStudentFeeDueHostel').techProcessPymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="XISS"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue7Pymt({
			    						sPC:'HOSTF',
			    						iFBIDs:bankIds
			    					});
									$('#paymentPluginsStudentFeeDueHostel2').bdpymtV4({
												sPC:'HOSTF' , 
												sSrc:'INS'
											});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="HPTELIBRARY"){
			    					$('#paymentPluginsStudentFeeDueHostel').ccAvenue8Pymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MGMU"){
			    					$('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="GC_UNIVERSITY"){
			    					$('#paymentPluginsStudentFeeDueHostel').bdpymtV6({sPC:'HOSTF',iFBIDs:bankIds});
			    				}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="KURUKSHETRA_UNIVERSITY"){
									if(gstudGender=="Male")	
										$('#paymentPluginsStudentFeeDueHostel').sbiEPayPymt({sPC:'HOSTF',sSrc:'HOSBOYS',iFBIDs:bankIds});
									else if(gstudGender=="Female")	
										$('#paymentPluginsStudentFeeDueHostel').sbiEPayPymt({sPC:'HOSTF',sSrc:'HOSGIRLS',iFBIDs:bankIds});
								}
								else if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MANDSAUR"){
			    					$('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
								}else  if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="MAHINDRA_UNIVERSITY"){
                          			  $('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
                        		}else  if($('#customerHelper').val()=="CMR_UNIVERSITY" || $('#customerHelper').val()=="CMR_IT"){
                          			  $('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
                        		}else if($('#customerHelper').val()!=undefined && ($('#customerHelper').val()=="RAMAIAH_UNIVERSITY" || $('#customerHelper').val()=="HPNLU")){
									$('#paymentPluginsStudentFeeDueHostel').junoPymt({sPC:'HOSTF',iFBIDs:bankIds});
								}

			    			}else {
			    				jAlert(obj.msg,"warning");
			    			}
			    		},
			    	});
			    }
			}
		});
	}
}


//Hostel Reciept 

function studentBillingInfoHostelreceipt(feeInvoiceId) {

	$.ajax({
		url:'getStudentBillingInformationForHostel.json',
		data:'feeInvoiceId='+feeInvoiceId,
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray != null){
				var length = jArray.length;
				var paidAmount = 0.0;
				if (jArray.length > 0) {
					var studentBillingDetails = '<div class="accordion" id="divStudentBillingDetailAccordian" style="width:100%">';
					for ( var i = 0; i < length; i++) {
						paidAmount += parseFloat(jArray[i].amount);
						var desc = jArray[i].desc;
						studentBillingDetails += '<div class="accordion-group">'+
						'<div class="accordion-heading">'+
						'<a class="accordion-toggle" data-toggle="collapse" data-parent="#divStudentBillingDetailAccordian" href="#studentBilling'+jArray[i].studentInvoiceId+''+i+'" style = "color:#000000">'+(i+1)+
						'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bill No.:&nbsp;&nbsp;'+jArray[i].billNo+'&nbsp;&nbsp;&nbsp;Received on:'+jArray[i].timestamp+ '&nbsp;&nbsp;&nbsp; Amount(in Rs.): '+
						formatAmount(jArray[i].amount)+'<span class="pull-right"><b style="color:red;font-size:12px;" >Click Here To View Receipt</b></span></a></div>'+
						'<div id="studentBilling'+jArray[i].studentInvoiceId+''+i+'" class="accordion-body collapse" style="background-color: #F7F7F7;">'+
						'<table class = "table table-condensed">'+
						'<tr><th colspan="6" style="text-align:center">RECEIPT';
						/*if ((jArray[i].billDate).toString() == (jArray[i].currentDate).toString() || jArray[i].EditDeleteFlag) {
							studentBillingDetails += '<span style="float:right">';
							//studentBillingDetails += '<input type="button" value="Reverse Entry" class="btn btn-inverse btn-mini" onclick="reversePaymentDetail(\''+ jArray[i].studentBillId + '\')">&nbsp;&nbsp;';
							if ($('#hdnUserRole').val() == "financeadmin" && jArray[i]["paymentDetails"][0] != null && jArray[i]["paymentDetails"][0] != undefined
									&& jArray[i]["paymentDetails"][0]["modeOfPayment"] != 'BankChallan')
								studentBillingDetails += '<input type="button" value="Edit" class="btn btn-inverse btn-mini" onclick="editPaymentDetail(\''+jArray[i].studentBillId + '\')">&nbsp;&nbsp;';
							studentBillingDetails += '<a onclick="deleteStudentBillDetail(\''+ jArray[i].studentBillId+ '\')" class="" href="javascript:void(0)" title="Delete Receipt"><i class="icon-trash"></i></a></span>';
						}*/
						studentBillingDetails += '</th></tr>' +
						'<tr><td><label>Bill No:</label>' + '</td>' + '<td id="tdBillNo"'+i+'>'+jArray[i].billNo+'</td>'+
						'<td><label>Amount(in  <span class="WebRupee">Rs.</span>)</label></td>'+
						'<td id="tdAmount'+i+'">'+formatRupee(parseFloat(Math.round(jArray[i].amount).toFixed(2)))+'</td>'+
						'<td><label>Barcode</label></td>'+
						'<td id="tdBarCode'+i+'"><span style = "float:right" id="tdFeeInvoiceBillBarcodeNo'+i+'"></span></td></tr>'+
						'<tr><td colspan="6">';
						if (desc != undefined)
							studentBillingDetails += '<div style="display:block"><strong>Desc/Remark</strong>&nbsp;&nbsp;&nbsp;'+jArray[i].desc+'</div>';

						studentBillingDetails += '<table class="table table-condensed table-bordered" id="showPaymentDetailTLB'+jArray[i].studentBillId+'">'+
						'<tr><th colspan="6" style="text-align:left">Cash/DD/Cheque Details</th></tr>'+
						'<tr><td style="text-align:center">Amount</td>'+
						'<td style="text-align:center">Payment Mode</td>'+
						'<td style="text-align:center">Chq/DD/Challan No.</td>'+
						'<td style="text-align:center">Bank Name</td>'+
						'<td style="text-align:center">Branch</td>'+
						'<td style="text-align:center"></td></tr>';

						var paymentDetails = jArray[i].paymentDetails;
						for ( var j = 0; j < paymentDetails.length; j++) {
							var studentBillChequeDetailId = paymentDetails[j].studentBillChequeDetailId;
							var paymentMode = "";
							if (paymentDetails[j].modeOfPayment == 'Cheque')
								paymentMode = "Challan";
							else
								paymentMode = paymentDetails[j].modeOfPayment;
							var bankName = paymentDetails[j].modeOfPayment.toString().toLowerCase() != "cash" ? paymentDetails[j].bankName: "N/A";
							var bankBranch = paymentDetails[j].modeOfPayment.toString().toLowerCase() != "cash" ? paymentDetails[j].bankBranch: "N/A";
							var amt = parseFloat(paymentDetails[j].amount).toFixed(2);
							var chequeDDNo = paymentDetails[j].chequeDDNo;
							var chequeDDDate = paymentDetails[j].chequeDDDate;

							if (paymentDetails[j].chequeBouns == "ChequeBounced")
								studentBillingDetails += '<tr class="alert alert-error">';
							else
								studentBillingDetails += '<tr>';

							studentBillingDetails += '<td id="tdBillPaymentMode'+j+'" style="text-align:right"><strong>'+formatAmount(amt)+'</strong></td>'+
							'<td id="tdBillPaymentMode'+j+'" style="text-align:left">'+paymentMode+'</td>'+
							'<td id="tdchequeD'+j+'" class="ChequeDDDate1" style="text-align:center">'+chequeDDNo+'('+chequeDDDate+')</td>'+
							'<td id="tdBankName'+j+'" style="text-align:center">'+bankName+'</td>'+
							'<td id="tdbankBranch'+j+'" style="text-align:center">'+bankBranch+'</td>'+
							'<td>';
						
							studentBillingDetails += '</td></tr>';
						}
						studentBillingDetails += '</table>'+
						'</td></tr>';

						var billPayableReceivable = parseFloat(jArray[i].studentFeeRecievable);
						if (billPayableReceivable >= 0) {
							studentBillingDetails += '<tr><td colspan="6" align="center"><span style="font-size:12px;font-weight: bold;text-align:center">Student Fees Receivable '
								+ formatRupee(parseFloat(billPayableReceivable.toFixed(2))) + '</span>';
						} else {
							billPayableReceivable = -(billPayableReceivable);
							studentBillingDetails += '<tr><td colspan="6" align="center"><span style="font-size:12px;font-weight: bold;text-align:center">Student Fees Payable '
								+ formatRupee(parseFloat(billPayableReceivable.toFixed(2))) + '</span>';
						}

						studentBillingDetails += '</td></tr></table>'+
						'<div id = "feeBillPrintPreviewBtn">'+
						'<table class="table table-bordered"><tr><th>Print Receipt</th>';
						if($('#customerHelper').val()=="IMT_GAZIABAD"){
							studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printAdmissionReceiptStudent('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Hard Copy)</div></td></tr></table>';
						}else if($('#customerHelper').val()=="BLM_MUNJAL"){
							studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceiptHorizontal('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Horizontal)</div></td></tr></table></div>';
						}else if($('#customerHelper').val()=="HPNLU"){
							studentBillingDetails +='<td colspan="2"><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceiptHorizontal('+jArray[i].studentBillId+')">Institute Admission Fees Receipt Print(Hard Copy)</div></td></tr></table>';
						}else{
							if(jArray[i].studSideBillPathHorizantal=="")
								studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="printPaymentWiseStudentReceiptHorizontalHostel('+jArray[i].studentBillId+')"> Hostel Fees Receipt Print</div></td></tr></table></div>';
							else
								studentBillingDetails +='<td><div class="btn btn-mini btn-inverse" onclick="window.open(\''+jArray[i].studSideBillPathHorizantal+'\')"> Hostel Fees Receipt Print</div></td></tr></table></div>';
						}
						studentBillingDetails +='</div></div>';
					}
					studentBillingDetails += '</div>';
				} else {
					studentBillingDetails = '<div id="divReceiptHeader" style = "align:center;width:94%;margin-left: 3%;margin-right: 3%;background-color:#f7f7f7;color:#1d5987;margin-top:4px;font-weight:bold;font-size:10px;height:20px;">No Receipt history found!</div>'
						+ '<div id = "divStudentBillingInformationArea" style = "align:center;width: 94%;margin-left: 3%;margin-right: 3%;"></div>';
				}
				$('#commonDialog').modal('show').css({
					width:'870px',
					'margin-left': function () {
						return -($(this).width() / 2);
					}
				});
				$('#commonDialogBody').html(studentBillingDetails);

			}else{

			}
		}
	});
}

function printPaymentWiseStudentReceiptHorizontalHostel(studentBillId){
	var invoiceType = 'OPEN';
	var hasOfficeCopy = 'FALSE';
	var hasStudentCopy = 'TRUE';
	var printLogo = 'TRUE';
	var printType = '';
	window.location.replace('printPaymentWiseStudentReceiptPDFHorizontal.json?studentBillId='+studentBillId+'&hasStudentCopy='+hasStudentCopy+'&hasOfficeCopy='+hasOfficeCopy+'&invoiceType='+invoiceType+'&printLogo='+printLogo+'&printType='+printType);
}


function getIncomeReceiptByFinancePolicyIdStudentSide(incomeExpenseReceiptId, financePolicyId)
{
	$.ajax({
		url:'GetIncomeReceiptDetailForIncomeReceipt.json',
		dataType:'json',
		data:{
			receipt:incomeExpenseReceiptId,
			financePolicyId:financePolicyId
		},
		type:'POST',
		async:false,
		beforeSend:function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(replay)
		{
			 generatePaymentVoucher(replay.incomeReceipt,replay.receiptNo,replay.fromType,replay.rollNo,replay.deptName,replay.resCreatedBy,replay.receiptDate,replay.receivedFrom,replay.receivedForDetail,replay.paymentDetail,replay.bankDetail,replay.instituteName,replay.remark,replay.footer)

			//generatePaymentVoucher(replay.incomeReceipt,replay.receiptNo,replay.fromType,replay.rollNo,replay.deptName,replay.resCreatedBy,replay.receiptDate,replay.receivedFrom,replay.receivedForDetail,replay.paymentDetail,replay.bankDetail,instituteName,replay.remark,replay.footer,replay.documentName,replay.templateName
				//	,replay.instituteName,replay.instituteLogo,replay.instituteAddress,replay.financeCode);

		},
		error:function(){
			jAlert("Something went wrong, Please try after some time","Error");
		}
	});
}

function viewOnlineBankChallanTransactionDetails(studentId){
	var hdAuth = $('#hdAuth').val();
	var url = 'fetchOnlineBankChallanTransactionDetailsByStudent.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_fetchOnlineBankChallanTransactionDetailsByStudent.json';
	}
	$.ajax({
		url:url, 
		dataType:'json',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			
			var OnlineTranasationList = jArray[0];
			var BankTranasationList = jArray[1];
			// Online Payment Details 
			var boiler1='<div class="label label-info" style="text-align:center">Online Transactions Details</div><br><table class="table table-bordered table-condensed"  style="margin-top:-14px"><th>Transaction Number</th><th>Transaction Category</th><th>Transaction Amount</th><th>Transaction Date</th>';
			if(OnlineTranasationList.length>0){
				for(var i = 0 ; i < OnlineTranasationList.length ; i++){	
					boiler1+='<tr><td>'+OnlineTranasationList[i].TransactionNumber+'</td>';
					boiler1+='<td>'+OnlineTranasationList[i].TransactionCategory+'</td>';
					boiler1+='<td class="gems_currency">'+OnlineTranasationList[i].TransactionAmount+'</td>';
					boiler1+='<td>'+OnlineTranasationList[i].TransactionDate+'</td></tr>';
				}
			}else{
				boiler1+='<tr><td colspan="4">Data Not Found !!!</td></tr>';
			}
			boiler1+='</table>';

			// Online Bank Challan Details 
			boiler1+='<div class="label label-info" style="text-align:center">Bank Challan Details</div><br><table class="table table-bordered table-condensed"  style="margin-top:-14px"><th>Transaction Number</th><th>Transaction Category</th><th>Transaction Amount</th><th>Transaction Date</th>';
			if(BankTranasationList.length>0){
				for(var i = 0 ; i < BankTranasationList.length ; i++){	
					boiler1+='<tr><td>'+BankTranasationList[i].TransactionNumber+'</td>';
					boiler1+='<td>'+BankTranasationList[i].TransactionCategory+'</td>';
					boiler1+='<td class="gems_currency">'+BankTranasationList[i].TransactionAmount+'</td>';
					boiler1+='<td>'+BankTranasationList[i].TransactionDate+'</td></tr>';
				}
			}else{
				boiler1+='<tr><td colspan="4">Data Not Found !!!</td></tr>';
			}
			boiler1+='</table>';
			
			juno.modal({
				id:'divStudentInformationbankChallanFeeId',
				header:'Online / Bank Challan Transaction Details ',
				body:boiler1,
				width: '850px',
				height:'300px'
			});
		},
	});	
}

function refreshInstallmentDetails(studentId){
	
	$.ajax({
		url:'refreshInstallmentDetailsByStudent.json', 
		data:{studentId:studentId},
		type:'POST',
		dataType:'text',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray=="Success")
				jAlert("Installment Refresh Successfully");
			else
				jAlert("Installment Refresh Faild.");	
			showStudentOverallFeeDueReportForInvoiceByStudentBatchId(studentId);
		},
	});	
}

function refreshStudentSideAcademic(studentId,type){
	
	$.ajax({
		url:'refreshAcademicMiscellaneousDetailsByStudent.json', 
		data:{studentId:studentId},
		type:'POST',
		dataType:'text',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray=="Success")
				jAlert("Academic "+type+" Refresh Successfully");
			else
				jAlert("Academic "+type+" Refresh Faild.");	
			showStudentOverallFeeDueReportForInvoiceByStudentBatchId(studentId);
		},
	});	
}

function refreshFeestructureAllDetails(studentId){
	var hdAuth = $('#hdAuth').val();
	var url = 'refreshAcademicFeesDetailsByStudent.json?studentId='+studentId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_refreshAcademicFeesDetailsByStudent.json';
	}
	$.ajax({
		url:url, 
		type:'POST',
		dataType:'text',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray=="Success")
				jAlert("Academic Fees Refresh Successfully");
			else
				jAlert("Academic Fees Refresh Faild.");	
			showStudentOverallFeeDueReportForInvoiceByStudentBatchId(studentId);
		},
	});	
}

function SaveOflinePaymentDetailsNew(){
	
	var payDetArr = new Array();
	var dataString = "";
	var misDataString ="";
	var totalAmount =0;
	var ExcessFee=$('#txtPayExceedFees').val()!=null||$('#txtPayExceedFees').val()!=''?$('#txtPayExceedFees').val():0;
	if($('#ckbPayExceedFees').is(":checked")){
		if(ExcessFee==0 ||ExcessFee==''){
			jAlert("Please enter Excess Fee Amount ");
			return;
		}
	}
	$('.claAmts:checked').each(function(){
		
		var studentExceptionInvoiceId = $(this).val();
		var amount =$('#txtUnitPriceid_'+studentExceptionInvoiceId).val();
		var description = $('#desc_'+studentExceptionInvoiceId).html();
		var type = $(this).attr('types');
		totalAmount+=eval(amount);
		
		if(type=="Academic")
			dataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
		else
			misDataString += studentExceptionInvoiceId+"@"+amount+"@"+description+"~";
	});
	totalAmount=eval(totalAmount)+eval(ExcessFee);
	if(misDataString.length>1)
		misDataString=misDataString.substring(0, misDataString.length-1);
	
	if(dataString.length>1)
		dataString=dataString.substring(0, dataString.length-1);
	
	
		var type=$('#neftregs option:selected').val();
		if(type==''){
			jAlert("Please select NEFT/RTGS/IMPS");
			return;
		}
		if(type!="UPI"){
			var bankName=$('#bankName').val();
			if(bankName==""){
				jAlert("Please Enter Bank Name");
				return;
			}
			var branchName=$('#branchName').val();
			if(branchName==""){
				jAlert("Please Enter Branch Name");
				return;
			}
			var ifsccode=$('#ifsccode').val();
			if(ifsccode==""){
				jAlert("Please Enter IFSC Code");
				return;
			}
		}
		var utrcode=$('#utrcode').val();
		if(utrcode==""){
			jAlert("Please Enter UTR Code");
			return;
		}
		var paymentDate=$('#paymentDate').val();
		if(paymentDate==""){
			jAlert("Please Select Payment Date");
			return;
		}
		
		$.ajax({      
			url:'SaveOfflinePaymentDetailsNEW.json',
			data:{
					type:type,
					branchName:branchName,
					ifsccode:ifsccode,
					utrcode:utrcode,
					paymentDate:paymentDate,
					bankName:bankName,
					totalAmount:totalAmount,
					dataString:dataString.toString(),
					misDataString:misDataString.toString(),
					ExcessFee:ExcessFee
				},
			dataType:'text',
			async:false,
			beforeSend: function() {
				startCommonAjaxSpinner();
			},
			complete: function() {
				stopCommonAjaxSpinner();
			},
			success:function(onlineTransactionPaymentSplitDetailsIds){	
				if(onlineTransactionPaymentSplitDetailsIds=='UTR Code already exists'){
					jAlert(onlineTransactionPaymentSplitDetailsIds);
					return false;
				}
				if(onlineTransactionPaymentSplitDetailsIds=='Failed'){
					jAlert("something went wrong");
					return false;
				}
				$('#onlinePaymentSpan').show();
				/*if($('#customerHelper').val()!=undefined && $('#customerHelper').val()=="BLM_MUNJAL"){
					//$('#onlinePaymentSpan').ccAvenue4Pymt({sPC:'TRNSPT',iFBIDs:jArray["bankIds0"]});
				}*/
				
				  jConfirm("Record saved successfully...!!. \nDo you want to Put for Finance Approval? ","Confirm",function(r)
						  {
					  if(r ==true)
					  {
						  putForFinanceOfflineStudentPaymentEntry(onlineTransactionPaymentSplitDetailsIds);
					  }else{
						  getStudentPaymentDetails1();
					  }
				 });
				
				
			},
			error:function(){
				jAlert("No Records","Error");
			}
		});
	}

function getStudentMessFeeDetails(src){
	
	if(src!=undefined){
		if($(src).hasClass('collapsed')){
			return;
		}
	}
	
	$.ajax({
		url:'getStudentMessInformationForStudent.json',
		data:{hostelPlanId:0},
		dataType:'json',
		async:false,
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){

			var boiler = '';
			boiler += '<div style="margin-top:10px;margin-bottom:5px;text-align:left;" class="alert alert-success">Month-wise Mess Charges</div>'+
			'<table class="table table-bordered  table-condensed monthWiseMessChargesTblCLs">'+
			'<tr><th></th><th>Hostel Plan Name</th>'+//<input type="checkbox" class="chkAllMessChargesCls" onclick="selAllMessId()">
			'<th>Hostel Allocated</th><th>Mess Name</th><th>Mess Allocation Start Date</th><th>Mess Allocation End Date</th><th>Month</th>'+
			'<th>Present Days</th><th>Absent Days</th><th>Total Attendance Days</th>'+
			'<th>Rebate Days</th><th>Actual Days for Calculation</th><th class="gems_currency_label">Actual Days Charges</th><th class="gems_currency_label">Servant Charges</th>'+
			'<th class="gems_currency_label">Guest Charges</th><th class="gems_currency_label">Late Fee</th><th class="gems_currency_label">Miscellaneous Charges</th>'+
			'<th class="gems_currency_label">Total Charges</th><th>Paid Amount</th><th>Receipt No</th><th>Payment Mode</th></tr>';
				
			for(var i=0;i<jArray.length;i++){
				boiler+='<tr>';
				
				if(jArray[i]["totalAmount"]>0 && jArray[i]["paymentBalance"]==""){
					boiler+='<td><input type="checkbox" class="chksingleMessChargesCls" id="chkSingleMess_'+jArray[i]["occupantMessDetailId"]+'" '+
					' value="'+jArray[i]["monthlyStudMessChargesAppliedId"]+'" onclick="fetchMessPaymentDetails('+jArray[i]["occupantMessDetailId"]+',this,\''+jArray[i]["studentHostelFineIds"]+'\')" AMOUNT="'+jArray[i]["totalAmount"]+'" occupantMessDetailId='+jArray[i]["occupantMessDetailId"]+'></td>';
				}else{
					boiler+='<td></td>';
				}
				
				boiler+='<td>'+jArray[i]["hostelPlanName"]+'</td>'+
				'<td>'+jArray[i]["hostelName"]+'</td>'+
				'<td>'+jArray[i]["messName"]+'</td>'+
				'<td>'+jArray[i]["StartDate"]+'</td>'+
				'<td>'+jArray[i]["AllocationEndDate"]+'</td>'+
				'<td>'+jArray[i]["MonthNme"]+'</td>'+
				'<td class="gems_integer">'+jArray[i]["PresentDays"]+'</td>'+
				'<td class="gems_integer">'+jArray[i]["AbsentDays"]+'</td>'+
				'<td class="gems_integer">'+jArray[i]["TotalAttendanceDays"]+'</td>'+
				'<td class="gems_integer">'+jArray[i]["RebateDays"]+'</td>'+
				'<td class="gems_integer">'+jArray[i]["ActualCalculationDays"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["AMOUNT"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["servantCharges"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["guestCharges"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["lateFeeAmount"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["miscCharges"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["totalAmount"]+'</td>'+
				'<td class="gems_currency">'+jArray[i]["paidAmount"]+'</td>'+
				'<td>'+jArray[i]["paymentBalance"]+'</td>'+
				'<td>'+jArray[i]["paymentMode"]+'</td>'+
				'</tr>';
			}
			
			boiler+='</table>';	
				
			boiler+='<div style="margin-top:10px;margin-bottom:5px;text-align:left;" class="alert alert">Payment Details</div>'+
			'<div id="payemntDetdivId"></div>';
							
			$('#studentMessFeeDetails').html(boiler);
		},
		error:function(){
			jAlert("Error...!");
		}
	});
	
}

function fetchMessPaymentDetails(occupantMessDetailId,ele,studentHostelFineIds){
	
	var hostelPlanId = $('#cmbHostelPlanId').val();
	if(hostelPlanId==0){
		$('#payemntDetdivId').html('');
		$('#payemntOnlineBtnDivId').html('');
		jAlert("Please select Hostel Plan");
		return false;	
	}
	
	var invoiceAmount = $(ele).attr('AMOUNT');
	var monthlyStudMessChargesAppliedId = $(ele).val();
	
	if($('#chkSingleMess_'+occupantMessDetailId).is(':checked') && $('#chkSingleMess_'+occupantMessDetailId).is(':visible')){	
			
		var	boiler =`<br><br><b><input type="checkbox" id="chkAgreeHostelFeesTerms" onclick="proceedingtoMessFeePaid(${invoiceAmount},${monthlyStudMessChargesAppliedId},'${studentHostelFineIds}')">
				&nbsp;I accept the above Invoice details</b> 
				<span> You have chosen to pay an amount <b>Rs.</b> 
				<span id="amtForMessPayment" orgvalue="${invoiceAmount}">${invoiceAmount}</span>
				from your Credit / Debit card of Specified bank account against student receivable.</span><br>
				<span style="font-weight:bold;color:red">* 
				If you are unable to view your receipt after successfull payment, report to your accounts department</span><br>
				<br><div style="text-align:center;display:none;" id="payemntOnlineBtnDivId"></div><br>`;
		$('#payemntDetdivId').html(boiler);		
	}else{
		$('#payemntDetdivId').html('');
		$('#payemntOnlineBtnDivId').html('');
		jAlert("Please select atleast one record");
		return false;
	}		
}

function proceedingtoMessFeePaid(invoiceAmount,monthlyStudMessChargesAppliedId,studentHostelFineIds){
	
	if($('#chkAgreeHostelFeesTerms').is(':checked'))
		$('#payemntOnlineBtnDivId').show();
	else
		$('#payemntOnlineBtnDivId').hide();
			
	var boiler = '<div paymentDetailsTblCls" style="text-align:center">'+
		'<input type="radio" id="onlineApplicationPay" name="rdType"  value="onlineApplicationPay" onclick="fetchAdmissionFeeInfo(\'online\','+invoiceAmount+','+monthlyStudMessChargesAppliedId+',\''+studentHostelFineIds+'\')" />&nbsp;&nbsp;&nbsp;&nbsp;Online'+
		//'&nbsp;&nbsp;<input type="radio" id="cashApplicationPay" name="rdType" value="cashApplicationPay" onclick="fetchAdmissionFeeInfo((\''+jArray[0]["hostelPolicyId"]+'\',\''+jArray[0]["hostelPlanId"]+'\',\'BankChallan\'))"/>Bank Challan'+
		//'<div class="span6" id="paymentOnlinePluginsApplicationDiv"><span id="paymentBankPlugins"></span></div>'+
		'<br><br><div style="text-align:center" id="paymentPluginsApplicationDiv"><span id="paymentPlugins"></span></div>';
	$('#payemntOnlineBtnDivId').html(boiler);
}

function fetchAdmissionFeeInfo(paymentMode,invoiceAmount,monthlyStudMessChargesAppliedId,studentHostelFineIds) {
	
	var hostelPolicyId= 0;
	var instituteId= $('#txtInstituteId').val();
	
	$.ajax({
		url: 'fetchMiscStudentPaymentDetailForMess.json',
		data: { invoiceAmount: invoiceAmount, hostelPolicyId: hostelPolicyId,monthlyStudMessChargesAppliedId:monthlyStudMessChargesAppliedId,studentHostelFineIdArry:studentHostelFineIds.toString() },
		dataType: 'json',
		async: false,
		beforeSend: function() {
			$('div.preview').addClass('loading');
			$('div.preview').show();
		},
		complete: function() {
			$('div.preview').removeClass('loading');
			$('div.preview').hide();
		},
		success: function(obj) {
			//obj[0]["bankIds0"]
			if (obj.length > 0 && obj[0]["error"] == 'success') {

				if ($('#customerHelper').val() != undefined && $('#customerHelper').val() == "KURUKSHETRA_UNIVERSITY") {
					if (instituteId == '1') {
						$('#paymentPlugins').sbiEPayPymt({ sPC: 'MISCF',iFBIDs: obj[0]["bankIds0"] });
					}
					if (instituteId == '2') {
						$('#paymentPlugins').sbiEPayPymt({ sPC: 'MISCF',iFBIDs: obj[0]["bankIds0"] });
					}
					if (instituteId == '3') {
						$('#paymentPlugins').sbiEPayPymt({ sPC: 'MISCF',iFBIDs: obj[0]["bankIds0"] });
					}
				}
			} else {
				jAlert(obj[0]["error"]);
			}
			
			
		},
		error: function() {
			jAlert("fetchMessAdmissionFeeDetail.htm ", "Error");
		}
	});
}

function refreshHostelFeestructureAllDetails(occupantId){
	var studentId = $('#studentId').val();
	var hdAuth = $('#hdAuth').val();
	var url = 'refreshHostelFeesDetailsByStudent.json?studentId='+studentId+'&occupantId='+occupantId;
	if(hdAuth == "student" || hdAuth == "Student"){
		url = 'stu_refreshHostelFeesDetailsByStudent.json?occupantId='+occupantId;
	}
	$.ajax({
		url:url, 
		type:'POST',
		dataType:'text',
		beforeSend: function() {
			startCommonAjaxSpinner();
		},
		complete: function() {
			stopCommonAjaxSpinner();
		},
		success:function(jArray){
			if(jArray=="Success")
				jAlert("Hostel Fees Refresh Successfully");
			else
				jAlert("Hostel Fees Refresh Faild.");	
			getStudentHostelFeeDueReportTotalFeeStructureWiseByStudentBatchId(studentId);
		},
	});	
}